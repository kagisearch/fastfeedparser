<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    
    <title>Art Chaidarun</title>
    <link>https://chaidarun.com</link>
    <atom:link href="https://chaidarun.com/feed.xml" rel="self" type="application/rss+xml" />
    <description></description>
    <language>en-us</language>
    <pubDate>Wed, 26 Nov 2025 03:07:28 GMT</pubDate>
    <lastBuildDate>Wed, 26 Nov 2025 03:07:28 GMT</lastBuildDate>
    
      
      <item>
        <title>How to Officiate a Wedding in New York City</title>
        <link>https://chaidarun.com/officiate-wedding-nyc</link>
        <pubDate>Tue, 23 Sep 2025 00:00:00 GMT</pubDate>
        <guid isPermaLink="true">https://chaidarun.com/officiate-wedding-nyc</guid>
        
        <description><![CDATA[<p>Last week I emceed my friends’ wedding as a <a href="https://www.cityclerk.nyc.gov/content/one-day-marriage-officiant-license">one-day marriage officiant</a>. Here’s a condensed, plain-English outline of exactly what needs to happen for that.</p>

<ol>
  <li><strong>The couple gets a marriage license.</strong> They go <a href="https://projectcupid.cityofnewyork.us/app/cupidceremony#/display/5f21c6447d42630218ccbccb">here</a> and choose “Marriage License”. Either in-person or virtual will work. The virtual flow still requires an in-person appointment anyway. The license will be valid for only 60 days, so the appointment should be scheduled to occur &lt;60 days before the wedding. The next available appointment slot may be a month or more from today, so plan accordingly.</li>
  <li><strong>The officiant gets an officiant license.</strong> They print and complete the <a href="https://www.cityclerk.nyc.gov/assets/cityclerk/downloads/pdf/Application_FINAL_4-11_ONEDAYMARRIAGEOFFICIANTLICENSE.pdf">officiant application</a>, which requires the marriage license number from the previous step<sup id="fnref:wedding"><a href="https://chaidarun.com/officiate-wedding-nyc#fn:wedding" class="footnote" rel="footnote" role="doc-noteref">1</a></sup>. The officiant goes <a href="https://projectcupid.cityofnewyork.us/app/cupidceremony#/display/5f21c6447d42630218ccbccb">here</a> and chooses “Marriage Officiant” to schedule an appointment. They just need to be 18 years old—no exams or fake churches.</li>
  <li><strong>At the wedding, everyone signs the officiant license.</strong> That’s two spouses, the witness(es), and the officiant. The license has space for two witnesses, but only one is legally required. Any adult guest can be a witness.</li>
  <li><strong>The officiant exchanges both licenses for a marriage certificate.</strong> They go <a href="https://projectcupid.cityofnewyork.us/app/cupidceremony#/display/5f21c6447d42630218ccbccb">here</a> and schedule a “Record Room” appointment<sup id="fnref:record"><a href="https://chaidarun.com/officiate-wedding-nyc#fn:record" class="footnote" rel="footnote" role="doc-noteref">2</a></sup> at the same physical office as in step 1. This must take place within 5 days of the wedding.</li>
</ol>

<p>These instructions assume that you don’t mind talking to city employees face-to-face. Alternatively you can fill out the paper forms and money orders by yourself, send them back and forth via snail mail, and cross your fingers.</p>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:wedding">
      <p>If the couple just wants a city hall marriage without any kind of wedding ceremony, this is the wrong guide. Stop reading and try the “Marriage Ceremony” option <a href="https://projectcupid.cityofnewyork.us/app/cupidceremony#/display/5f21c6447d42630218ccbccb">here</a>. Good luck! <a href="https://chaidarun.com/officiate-wedding-nyc#fnref:wedding" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:record">
      <p>Shout out to <a href="https://www.reddit.com/r/WedditNYC/comments/1l1xned/comment/mvplmz5/">Reddit</a>. This same-day method works but is totally undocumented by the city. <a href="https://chaidarun.com/officiate-wedding-nyc#fnref:record" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>
]]></description>
      </item>
      
    
      
    
      
      <item>
        <title>Simplest Fractions Per Percentage</title>
        <link>https://chaidarun.com/simplest-fractions-per-percentage</link>
        <pubDate>Sun, 05 Jan 2025 00:00:00 GMT</pubDate>
        <guid isPermaLink="true">https://chaidarun.com/simplest-fractions-per-percentage</guid>
        
        <description><![CDATA[<p>When you see a statistic such as “75% of reviewers liked this movie”, you can’t help but wonder whether there were only four reviewers.</p>

<p>What about other, less obvious percentages? Here are the smallest possible denominators that correspond to each integer percentage value:</p>

<table>
  <thead>
    <tr>
      <th>Percentage</th>
      <th>Simplest fraction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0%</td>
      <td>0 out of 1</td>
    </tr>
    <tr>
      <td>1%</td>
      <td>1 out of 51</td>
    </tr>
    <tr>
      <td>2%</td>
      <td>1 out of 34</td>
    </tr>
    <tr>
      <td>3%</td>
      <td>1 out of 26</td>
    </tr>
    <tr>
      <td>4%</td>
      <td>1 out of 21</td>
    </tr>
    <tr>
      <td>5%</td>
      <td>1 out of 17</td>
    </tr>
    <tr>
      <td>6%</td>
      <td>1 out of 15</td>
    </tr>
    <tr>
      <td>7%</td>
      <td>1 out of 13</td>
    </tr>
    <tr>
      <td>8%</td>
      <td>1 out of 12</td>
    </tr>
    <tr>
      <td>9%</td>
      <td>1 out of 11</td>
    </tr>
    <tr>
      <td>10%</td>
      <td>1 out of 10</td>
    </tr>
    <tr>
      <td>11%</td>
      <td>1 out of 9</td>
    </tr>
    <tr>
      <td>12%</td>
      <td>1 out of 8</td>
    </tr>
    <tr>
      <td>13%</td>
      <td>1 out of 8</td>
    </tr>
    <tr>
      <td>14%</td>
      <td>1 out of 7</td>
    </tr>
    <tr>
      <td>15%</td>
      <td>2 out of 13</td>
    </tr>
    <tr>
      <td>16%</td>
      <td>1 out of 6</td>
    </tr>
    <tr>
      <td>17%</td>
      <td>1 out of 6</td>
    </tr>
    <tr>
      <td>18%</td>
      <td>2 out of 11</td>
    </tr>
    <tr>
      <td>19%</td>
      <td>3 out of 16</td>
    </tr>
    <tr>
      <td>20%</td>
      <td>1 out of 5</td>
    </tr>
    <tr>
      <td>21%</td>
      <td>3 out of 14</td>
    </tr>
    <tr>
      <td>22%</td>
      <td>2 out of 9</td>
    </tr>
    <tr>
      <td>23%</td>
      <td>3 out of 13</td>
    </tr>
    <tr>
      <td>24%</td>
      <td>4 out of 17</td>
    </tr>
    <tr>
      <td>25%</td>
      <td>1 out of 4</td>
    </tr>
    <tr>
      <td>26%</td>
      <td>4 out of 15</td>
    </tr>
    <tr>
      <td>27%</td>
      <td>3 out of 11</td>
    </tr>
    <tr>
      <td>28%</td>
      <td>2 out of 7</td>
    </tr>
    <tr>
      <td>29%</td>
      <td>2 out of 7</td>
    </tr>
    <tr>
      <td>30%</td>
      <td>3 out of 10</td>
    </tr>
    <tr>
      <td>31%</td>
      <td>4 out of 13</td>
    </tr>
    <tr>
      <td>32%</td>
      <td>6 out of 19</td>
    </tr>
    <tr>
      <td>33%</td>
      <td>1 out of 3</td>
    </tr>
    <tr>
      <td>34%</td>
      <td>8 out of 23</td>
    </tr>
    <tr>
      <td>35%</td>
      <td>5 out of 14</td>
    </tr>
    <tr>
      <td>36%</td>
      <td>4 out of 11</td>
    </tr>
    <tr>
      <td>37%</td>
      <td>3 out of 8</td>
    </tr>
    <tr>
      <td>38%</td>
      <td>3 out of 8</td>
    </tr>
    <tr>
      <td>39%</td>
      <td>7 out of 18</td>
    </tr>
    <tr>
      <td>40%</td>
      <td>2 out of 5</td>
    </tr>
    <tr>
      <td>41%</td>
      <td>5 out of 12</td>
    </tr>
    <tr>
      <td>42%</td>
      <td>3 out of 7</td>
    </tr>
    <tr>
      <td>43%</td>
      <td>3 out of 7</td>
    </tr>
    <tr>
      <td>44%</td>
      <td>4 out of 9</td>
    </tr>
    <tr>
      <td>45%</td>
      <td>5 out of 11</td>
    </tr>
    <tr>
      <td>46%</td>
      <td>6 out of 13</td>
    </tr>
    <tr>
      <td>47%</td>
      <td>7 out of 15</td>
    </tr>
    <tr>
      <td>48%</td>
      <td>10 out of 21</td>
    </tr>
    <tr>
      <td>49%</td>
      <td>17 out of 35</td>
    </tr>
    <tr>
      <td>50%</td>
      <td>1 out of 2</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>Percentage</th>
      <th>Simplest fraction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>51%</td>
      <td>14 out of 27</td>
    </tr>
    <tr>
      <td>52%</td>
      <td>9 out of 17</td>
    </tr>
    <tr>
      <td>53%</td>
      <td>7 out of 13</td>
    </tr>
    <tr>
      <td>54%</td>
      <td>6 out of 11</td>
    </tr>
    <tr>
      <td>55%</td>
      <td>5 out of 9</td>
    </tr>
    <tr>
      <td>56%</td>
      <td>5 out of 9</td>
    </tr>
    <tr>
      <td>57%</td>
      <td>4 out of 7</td>
    </tr>
    <tr>
      <td>58%</td>
      <td>7 out of 12</td>
    </tr>
    <tr>
      <td>59%</td>
      <td>10 out of 17</td>
    </tr>
    <tr>
      <td>60%</td>
      <td>3 out of 5</td>
    </tr>
    <tr>
      <td>61%</td>
      <td>8 out of 13</td>
    </tr>
    <tr>
      <td>62%</td>
      <td>5 out of 8</td>
    </tr>
    <tr>
      <td>63%</td>
      <td>5 out of 8</td>
    </tr>
    <tr>
      <td>64%</td>
      <td>7 out of 11</td>
    </tr>
    <tr>
      <td>65%</td>
      <td>11 out of 17</td>
    </tr>
    <tr>
      <td>66%</td>
      <td>2 out of 3</td>
    </tr>
    <tr>
      <td>67%</td>
      <td>2 out of 3</td>
    </tr>
    <tr>
      <td>68%</td>
      <td>11 out of 16</td>
    </tr>
    <tr>
      <td>69%</td>
      <td>9 out of 13</td>
    </tr>
    <tr>
      <td>70%</td>
      <td>7 out of 10</td>
    </tr>
    <tr>
      <td>71%</td>
      <td>5 out of 7</td>
    </tr>
    <tr>
      <td>72%</td>
      <td>8 out of 11</td>
    </tr>
    <tr>
      <td>73%</td>
      <td>8 out of 11</td>
    </tr>
    <tr>
      <td>74%</td>
      <td>14 out of 19</td>
    </tr>
    <tr>
      <td>75%</td>
      <td>3 out of 4</td>
    </tr>
    <tr>
      <td>76%</td>
      <td>10 out of 13</td>
    </tr>
    <tr>
      <td>77%</td>
      <td>7 out of 9</td>
    </tr>
    <tr>
      <td>78%</td>
      <td>7 out of 9</td>
    </tr>
    <tr>
      <td>79%</td>
      <td>11 out of 14</td>
    </tr>
    <tr>
      <td>80%</td>
      <td>4 out of 5</td>
    </tr>
    <tr>
      <td>81%</td>
      <td>9 out of 11</td>
    </tr>
    <tr>
      <td>82%</td>
      <td>9 out of 11</td>
    </tr>
    <tr>
      <td>83%</td>
      <td>5 out of 6</td>
    </tr>
    <tr>
      <td>84%</td>
      <td>11 out of 13</td>
    </tr>
    <tr>
      <td>85%</td>
      <td>6 out of 7</td>
    </tr>
    <tr>
      <td>86%</td>
      <td>6 out of 7</td>
    </tr>
    <tr>
      <td>87%</td>
      <td>7 out of 8</td>
    </tr>
    <tr>
      <td>88%</td>
      <td>7 out of 8</td>
    </tr>
    <tr>
      <td>89%</td>
      <td>8 out of 9</td>
    </tr>
    <tr>
      <td>90%</td>
      <td>9 out of 10</td>
    </tr>
    <tr>
      <td>91%</td>
      <td>10 out of 11</td>
    </tr>
    <tr>
      <td>92%</td>
      <td>11 out of 12</td>
    </tr>
    <tr>
      <td>93%</td>
      <td>13 out of 14</td>
    </tr>
    <tr>
      <td>94%</td>
      <td>15 out of 16</td>
    </tr>
    <tr>
      <td>95%</td>
      <td>18 out of 19</td>
    </tr>
    <tr>
      <td>96%</td>
      <td>22 out of 23</td>
    </tr>
    <tr>
      <td>97%</td>
      <td>28 out of 29</td>
    </tr>
    <tr>
      <td>98%</td>
      <td>39 out of 40</td>
    </tr>
    <tr>
      <td>99%</td>
      <td>66 out of 67</td>
    </tr>
    <tr>
      <td>100%</td>
      <td>1 out of 1</td>
    </tr>
  </tbody>
</table>

<h2 id="calculator-for-arbitrary-decimal-inputs">Calculator for arbitrary decimal inputs</h2>

<p>What if you have a decimal like 0.3105 instead of an integer percentage? How do you determine that its denominator must be at least 161? Try this calculator!</p>

<form onsubmit="return false">
	<input placeholder="0.4876" style="margin-right:5px;width:100px" type="text" />
	<input style="margin-right:10px" type="submit" value="Submit" />
	<span id="calc-result"></span>
</form>
<script>
	(() => {
		const floatEquals = (a, b) => Math.abs(a - b) < 1e-9;
		$("main input[type=submit]").addEventListener("click", () => {
			const rawInput = $("main input[type=text]").value;
			let input;
			try {
				input = parseFloat(rawInput);
				if (isNaN(input) || input < 0) {
					throw new Error();
				}
			} catch (e) {
				window.alert("Invalid input!")
				return;
			}
			const decimalPlaces = rawInput.split(".")[1]?.length ?? 0;
			for (let d = 1; true; ++d) {
				const unrounded = input * d;
				for (const n of [Math.floor(unrounded), Math.ceil(unrounded)]) {
					const quotient = n / d;
					const rounded = parseFloat(quotient.toFixed(decimalPlaces));
					const truncated = (() => {
						const str = `${quotient}`;
						const prefix = str.split(".")[0];
						const suffix = str.split(".")[1]?.slice(0, decimalPlaces) ?? 0;
						return parseFloat(`${prefix}.${suffix}`);
					})();
					if (floatEquals(rounded, input) || floatEquals(truncated, input)) {
						$("main #calc-result").textContent = `≈ ${n} / ${d}`
						return;
					}
				}
			}
		});
	})();
</script>

<p>It even works for inputs greater than 1, for example 3.14 → 22 / 7.</p>

<h2 id="methodology">Methodology</h2>

<p>I’m defining simplicity as having a small denominator. A percentage value of 50% might be describing “37 out of 74”, but a simpler explanation is “1 out of 2”.</p>

<p>Percentages are usually written as integer values, but in practice, you the reader have no idea whether the author rounded the percentage (66.66% → 67%) or simply truncated it (66.66% → 66%). I’m therefore taking <em>both</em> approaches into account and saying that the simplest possible ratio describable as 66% is “2 out of 3” rather than “19 out of 29”.</p>

<p>I created this page because I failed to find these answers via Google search. So for SEO purposes: you might also call these values the simplest possible fractions per percentage, the simplest ratios for each percentage, the smallest possible denominators for each percentage value, the smallest possible sample sizes for each percentage, or the smallest possible population sizes for each percentage.</p>

<p>Here’s the quick and dirty JavaScript one-liner that I used to generate the data:</p>

<!-- prettier-ignore -->
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span><span class="p">(</span><span class="nx">p</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">p</span><span class="o">&lt;</span><span class="mi">101</span><span class="p">;</span><span class="o">++</span><span class="nx">p</span><span class="p">){</span><span class="nl">l</span><span class="p">:</span><span class="k">for</span><span class="p">(</span><span class="nx">d</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="kc">true</span><span class="p">;</span><span class="o">++</span><span class="nx">d</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="nx">n</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">n</span><span class="o">&lt;=</span><span class="nx">d</span><span class="p">;</span><span class="o">++</span><span class="nx">n</span><span class="p">){</span><span class="nx">f</span><span class="o">=</span><span class="mi">100</span><span class="o">*</span><span class="nx">n</span><span class="o">/</span><span class="nx">d</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nf">round</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span><span class="o">==</span><span class="nx">p</span><span class="o">||</span><span class="nb">Math</span><span class="p">.</span><span class="nf">floor</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span><span class="o">==</span><span class="nx">p</span><span class="p">){</span><span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="nx">p</span><span class="p">,</span><span class="nx">n</span><span class="p">,</span><span class="nx">d</span><span class="p">);</span><span class="k">break</span> <span class="nx">l</span><span class="p">}}}}</span>
</code></pre></div></div>
]]></description>
      </item>
      
    
      
      <item>
        <title>Where Should We Eat</title>
        <link>https://chaidarun.com/eat</link>
        <pubDate>Sun, 01 Dec 2024 00:00:00 GMT</pubDate>
        <guid isPermaLink="true">https://chaidarun.com/eat</guid>
        
        <description><![CDATA[<p>I’m <a href="https://chaidarun.com/eat#not-picky">not picky</a> and I promise that I’m always equally down for any of the options below. Please just pick your favorite, choose randomly, or suggest another restaurant!</p>

<h2 id="nyc">NYC</h2>

<p>I haven’t eaten out much in NYC yet. Hit me up and help me build this list!</p>

<h2 id="pittsburgh">Pittsburgh</h2>
<p><button>Choose random</button></p>
<ul>
  <li>98K Hamburger</li>
  <li>Bird on the Run</li>
  <li>Blue Sky</li>
  <li>Butterjoint</li>
  <li>Cafe 33</li>
  <li>Casbah</li>
  <li>Chipotle</li>
  <li>Choolaah</li>
  <li>Cilantro &amp; Ajo</li>
  <li>City Kitchen</li>
  <li>Condado</li>
  <li>Duo's Taqueria</li>
  <li>El Sabor</li>
  <li>Five Guys</li>
  <li>Fujiya</li>
  <li>Golden Gai</li>
  <li>Industry Public House</li>
  <li>Istanbloom</li>
  <li>Kahuna</li>
  <li>Kiin</li>
  <li>La Feria</li>
  <li>Mad Mex</li>
  <li>Masala House</li>
  <li>McDonald's</li>
  <li>Mercurio's</li>
  <li>Mola</li>
  <li>Noodlehead</li>
  <li>Park Bruges</li>
  <li>Pho and Roll</li>
  <li>Piada</li>
  <li>Point Brugge</li>
  <li>Roots</li>
  <li>Senyai</li>
  <li>Shake Shack</li>
  <li>Silk Elephant</li>
  <li>Smiling Banana Leaf</li>
  <li>Square Cafe</li>
  <li>Teppanyaki Kyoto</li>
  <li>Thai Table &amp; Kitchen</li>
  <li>Took Took 98</li>
  <li>Urban Tap</li>
  <li>Wendy's</li>
  <li>Yoshino</li>
</ul>

<h2 id="bangkok">Bangkok</h2>
<p><button>Choose random</button></p>
<ul>
  <li>KFC</li>
  <li>Kub Kao Kub Pla</li>
  <li>Maisen</li>
  <li>MK</li>
  <li>Mo-Mo-Paradise</li>
  <li>MOS Burger</li>
  <li>Pan Pan</li>
  <li>Sizzler</li>
  <li>Swensen's</li>
  <li>Thong Smith</li>
  <li>Literally any restaurant in any mall near BTS</li>
</ul>

<h2 id="not-picky">Not picky</h2>

<p>It takes around 24 hours of (accidental) fasting for me to start feeling hungry, I’ve historically been prone to eating the same meal every day for months on end, I once consumed nothing but Soylent for several weeks… you get the idea. I eat to live.</p>

<p>However I do enjoy eating out quite regularly for social purposes and I want to contribute my fair share toward the sometimes difficult decision of where to eat<sup id="fnref:beli"><a href="https://chaidarun.com/eat#fn:beli" class="footnote" rel="footnote" role="doc-noteref">1</a></sup>. This page’s “menu of menus” already accounts for practical considerations apart from the food itself, such as price and convenience, so please believe me when I say that I’m more than happy to leave the final choice up to you. Or even random chance!</p>

<!-- Some Duolingo company lore: I personally organized the office's daily dinner order for many years. Starting in 2014, I'd spend way too much time every evening trying to build consensus among the few employees who stuck around for dinner. By 2020, the system had evolved to reach its final form: a heavily automated voting spreadsheet used daily by dozens of employees ranging from interns to execs, a PagerDuty rotation of volunteers to submit and receive the online delivery orders, and a Slack bot for posting order status updates. -->

<script>
(() => {
  for (const $b of $$("main button")) {
    const city = $b.parentElement.previousElementSibling.textContent.trim();
    const $items = $b.parentElement.nextElementSibling.querySelectorAll("li");
    for (const $li of $items) {
      if ($li.textContent.length < 30) {
        $li.innerHTML = `<a href="https://www.google.com/maps/search/${encodeURIComponent(`${$li.textContent} ${city}`)}">${$li.innerHTML}</a>`;
      }
    }
    // https://stackoverflow.com/a/46545530
    const r = [...$items]
      .map($li => ({ restaurant: $li.textContent, key: Math.random() }))
      .sort((a, b) => a.key - b.key)
      .map(({ restaurant }) => restaurant)
    let i = 0;
    $b.addEventListener("click", () => window.alert(r[i++ % r.length]));
  }
})();
</script>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:beli">
      <p>Yes, <a href="https://beliapp.com/">Beli</a> is a thing and I do have an account that’s collecting dust. People have reasonably assumed that I’d be into it given how much <a href="https://chaidarun.com/ten-years-of-logging-my-life">personal tracking</a> I do already, but I find that Beli is way too much paperwork and granularity for a subject that I care relatively little about. <a href="https://chaidarun.com/eat#fnref:beli" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>
]]></description>
      </item>
      
    
      
      <item>
        <title>How to Disable Contactless Payment on a Credit Card</title>
        <link>https://chaidarun.com/disable-contactless-payment</link>
        <pubDate>Sat, 19 Oct 2024 00:00:00 GMT</pubDate>
        <guid isPermaLink="true">https://chaidarun.com/disable-contactless-payment</guid>
        
        <description><![CDATA[<p>An exercise in hyperoptimizing my daily life.</p>

<p><img src="https://chaidarun.com/img/contactless-chip.jpg" alt="" /></p>

<h2 id="whats-wrong-with-tap-to-pay">What’s wrong with tap to pay?</h2>

<p>Nothing, in general. It’s convenient and secure. But here’s my situation:</p>

<ul>
  <li>I want to pay for most things by tapping my phone, not my credit card. <a href="https://en.wikipedia.org/wiki/Apple_Pay">Apple Pay</a> / <a href="https://en.wikipedia.org/wiki/Google_Pay_(payment_method)">Google Pay</a> removes the need to carry all my physical credit cards everywhere.</li>
  <li>I want to carry exactly one physical credit card as a backup for vendors whom I can’t easily pay by tapping my phone, e.g. most sit-down restaurants in the US.</li>
  <li>I want to minimize my everyday carry by storing that backup card inside my phone case’s sleeve. I haven’t bothered using a standalone wallet in years.</li>
</ul>

<p>The problem with this setup is <a href="https://tfl.gov.uk/fares/how-to-pay-and-where-to-buy-tickets-and-oyster/pay-as-you-go/card-clash">card clash</a>. If I hold my phone up to a scanner, how does the scanner know whether to charge my phone’s Google Pay vs. the physical credit card?</p>

<p>Another major annoyance is that Android beeps whenever it detects an <a href="https://en.wikipedia.org/wiki/Near-field_communication">NFC</a> device in close proximity, and there’s no way to turn off that “feature” without turning off NFC itself. Housing my NFC-enabled credit card inside my phone case causes Android to beep every single time I unlock my phone.</p>

<h2 id="the-solution">The solution</h2>

<p>Shining my phone’s flashlight through my plastic credit card revealed a long metal wire, the NFC antenna, running along the card’s perimeter. Like Alexander cutting the Gordian knot, I pulled out some scissors and made a tasteful half-centimeter snip just below the magnetic stripe. Problem solved!</p>

<p>Now I can keep my backup credit card inside my phone case without having it interfere with Google Pay or cause undue beeping. Although the physical card’s contactless payment feature is toast, I’ve <a href="https://chaidarun.com/img/contactless-receipt.jpg">verified</a> that its chip and magnetic stripe both still work.</p>

<p>I don’t feel too bad about severing the antenna wire since I’ve already added the backup card itself to my digital Google Pay wallet, meaning that I can still use my phone to make contactless payments on that card’s behalf if I really need to for whatever reason.</p>

<p><img src="https://chaidarun.com/img/contactless-gordian-knot.jpg" alt="" /></p>

<h2 id="appendix-various-non-solutions">Appendix: various non-solutions</h2>

<p>Honestly, the main purpose of this whole post is to remind myself why I resorted to vasectomizing my own credit card. Here’s everything else I tried:</p>

<ul>
  <li>
    <p><strong>Removing the card from my phone case every time I pay for something.</strong> This obvious solution to the card clash problem wastes a few seconds, puts extra wear and tear on both the card and my phone case, introduces some risk of dropping the card and/or my phone, doesn’t get rid of Android’s unlock beeps, and is just plain annoying to do multiple times a day.</p>
  </li>
  <li>
    <p><strong>Requesting a contactless-less card.</strong> I called my credit cards’ issuers, carefully explained my use case, and asked whether they could send me a replacement card that totally lacks the contactless payment feature (as opposed to disabling it remotely on their end). None of the issuers said they could do so.</p>
  </li>
  <li>
    <p><strong>Erasing data.</strong> Apps like <a href="https://play.google.com/store/apps/details?id=com.wakdev.wdnfc">NFC Tools</a> allow you to modify data on certain NFC devices, but unsurprisingly my credit cards are read-only.</p>
  </li>
  <li>
    <p><strong>Lots of aluminum foil.</strong> I hoped that an insulating layer of aluminum foil sandwiched between my phone and the card would allow me to choose a payment method by simply holding my phone in different orientations: scanning the back side of my phone would use the physical card’s contactless payment feature, while scanning the front side of my phone would use Google Pay. Unfortunately, my phone’s NFC reader is located in the middle of its back side and doesn’t work from the front.<br /><br /><img src="https://chaidarun.com/img/contactless-foil.jpg" alt="" /></p>
  </li>
  <li>
    <p><strong>Less aluminum foil.</strong> Since Google Pay works only on my phone’s back side, covering the entire back with foil isn’t an option. But what if I were to tape some foil directly onto the credit card instead, using only enough foil to block the card’s contactless receiver? Maybe my phone could still get enough signal passing through the unshielded portions of the card for Google Pay to work, kind of like how QR codes still work even if you stick a random logo in the middle of them. Alas, this approach fails because the credit card’s antenna takes up so much space, practically covering the entire card. Foil foiled again.</p>
  </li>
  <li>
    <p><strong>Dishonorable mention: microwaving the credit card.</strong> I didn’t actually try this method. Someone on Reddit suggested it as a way to disable the chip, which is overkill for my use case anyway.</p>
  </li>
</ul>
]]></description>
      </item>
      
    
      
      <item>
        <title>The Camino de Santiago in a Million Easy Steps</title>
        <link>https://chaidarun.com/camino-de-santiago</link>
        <pubDate>Wed, 25 Sep 2024 00:00:00 GMT</pubDate>
        <guid isPermaLink="true">https://chaidarun.com/camino-de-santiago</guid>
        
        <description><![CDATA[<p>I just spent 34 days walking the <a href="https://en.wikipedia.org/wiki/Camino_de_Santiago">Camino de Santiago</a>, a medieval pilgrimage route that starts in France and runs 800 km across Spain to the tomb of St. James the Apostle in Santiago de Compostela. This UNESCO-recognized tradition began 1200 years ago and is now undertaken, at least in part, by around half a million people every year.</p>

<p><img src="https://chaidarun.com/img/camino-village.jpg" alt="" /></p>

<p>Jump to: <a href="https://chaidarun.com/camino-de-santiago#background">Background</a> · <a href="https://chaidarun.com/camino-de-santiago#tips">Tips</a> · <a href="https://chaidarun.com/camino-de-santiago#language">Language</a> · <a href="https://chaidarun.com/camino-de-santiago#observations">Observations</a> · <a href="https://chaidarun.com/camino-de-santiago#memories">Memories</a> · <a href="https://chaidarun.com/camino-de-santiago#trivia">Trivia</a> · <a href="https://chaidarun.com/camino-de-santiago#gallery">Gallery</a></p>

<h2 id="background">Background</h2>

<p><strong>Fitness:</strong> I’m in decent shape for a 30-year-old, although I normally avoid cardio whenever possible. I can count on one hand the number of hikes I had done in life before the Camino, each of which lasted well under an hour.</p>

<p><strong>Language:</strong> I studied Spanish for a couple years at an American high school and <a href="https://chaidarun.com/duolingo">completed</a> the Duolingo course in 2013 but never had much occasion to use Spanish in real life. A little knowledge went a long way while traveling through rural Spain, although I also met some pilgrims who seemed to get along fine speaking only English.</p>

<p><strong>Route:</strong> I took the <a href="https://en.wikipedia.org/wiki/French_Way">French Way</a> (<em>Camino francés</em>), the most popular and historically important one of the many established Camino routes. After giving serious thought to the more scenic <a href="https://en.wikipedia.org/wiki/Northern_Way">Northern Way</a> (<em>Camino del Norte</em>), I chose the French Way for its cultural significance—the world offers plenty of options beyond the Camino if you’re mainly interested in natural beauty.</p>

<p><strong>Religion:</strong> I’m quite familiar with Catholicism but not religious myself. According to the Pilgrim’s Reception Office, <a href="https://oficinadelperegrino.com/en/statistics-2/">over half</a> of all pilgrims make the trip for non-religious reasons.</p>

<p><strong>Motivation:</strong> I had some free time and wanted to really disconnect from my regular life—especially work, tech, and American society<sup id="fnref:usap"><a href="https://chaidarun.com/camino-de-santiago#fn:usap" class="footnote" rel="footnote" role="doc-noteref">1</a></sup>. A week before my sabbatical was scheduled to begin, I happened across <a href="https://www.reddit.com/r/Dublin/comments/13k0wje/comment/jki0a2n/">this fateful Reddit comment</a> that informed me of the Camino’s existence. My month in Spain ended up being the longest time I’ve spent away from a computer keyboard since I was 2 years old!</p>

<p><img src="https://chaidarun.com/img/camino-peak.jpg" alt="" /></p>

<h2 id="tips">Tips</h2>

<p>The standard instructions for how to do the Camino are to just follow the painted yellow arrows and <a href="https://caminoways.com/camino-pilgrim-passport-certificates">collect stamps</a>, but there’s a lot more worth knowing before you begin.</p>

<p><strong>Plan travel to your start point.</strong> The French border town of Saint-Jean-Pied-de-Port serves as the classic starting point since historically most foreign pilgrims entered Spain through it. I flew into Biarritz Airport, took a bus to Bayonne, and finally took a train to St. Jean. It’s all clearly laid out in Google Maps.</p>

<p><strong>Prepare your money.</strong> Use a credit card with no international fees wherever possible, and select “pay in EUR” (as opposed to USD) for better exchange rates. Waiters will <em>always</em> bring you a handheld card reader instead of taking your card—that’s an American thing. For cash, I used a <a href="https://thriftytraveler.com/reviews/credit-card/atm-fees-charles-schwab-debit-card/">Schwab debit card</a> to avoid all ATM fees<sup id="fnref:schwab"><a href="https://chaidarun.com/camino-de-santiago#fn:schwab" class="footnote" rel="footnote" role="doc-noteref">2</a></sup>. Tipping isn’t expected, but it’s common to round up to the nearest euro when paying in cash. Waiters will generally leave you alone, so you’ll need to flag them down once you’re done eating.</p>

<p><strong>Beat the heat.</strong> I’m a person who runs hot and hates feeling sweaty, so August was an unfortunate choice of starting month. I made up for it by going all out on sun protection: I wore hiking pants and long-sleeved sun hoodies every day, I chose a lightweight <a href="https://www.outdoorgearlab.com/reviews/camping-and-hiking/daypack/osprey-talon-22">backpack</a> with good ventilation, I attached a <a href="https://www.gossamergear.com/products/liteflex-hiking-chrome-umbrella">UV hiking umbrella</a> to it, and I timed each day’s walk to end before the outdoor temperature reached 20 °C—even if that meant strapping on a headlamp and starting at 5am<sup id="fnref:franco"><a href="https://chaidarun.com/camino-de-santiago#fn:franco" class="footnote" rel="footnote" role="doc-noteref">3</a></sup>, hours before sunrise.</p>

<p><strong>Know mass etiquette.</strong> Non-Catholics and even non-Christians are still welcome to attend church services. The pilgrim mass in Santiago is especially popular. Just bring €10 or so for donation, don’t go in shirtless or barefooted, follow what everyone else is doing, and most importantly: <em>do not</em> accept communion (bread and wine) from the priest. You can either stay seated or cross your arms in an X over your chest to receive a blessing from the priest instead<sup id="fnref:communion"><a href="https://chaidarun.com/camino-de-santiago#fn:communion" class="footnote" rel="footnote" role="doc-noteref">4</a></sup>.</p>

<p><img src="https://chaidarun.com/img/camino-dawn.jpg" alt="" /></p>

<p>Mobile apps I used:</p>

<ul>
  <li><a href="https://play.google.com/store/apps/details?id=com.editorialbuencamino.buencamino">Buen Camino</a> for navigation. This was the Camino app that I most often saw other pilgrims using too. It shows your current GPS location on a satellite map of the route and also provides extremely helpful advice regarding alternate paths and challenging sections.</li>
  <li><a href="https://play.google.com/store/apps/details?id=com.google.android.apps.maps">Google Maps</a> for looking up local businesses’ locations, prices, and reviews. Hours are pretty hit or miss, especially in rural villages.</li>
  <li><a href="https://play.google.com/store/search?q=translate">Google Translate</a> for quickly translating restaurant menus and communicating with pilgrims who spoke neither English nor Spanish.</li>
  <li><a href="https://play.google.com/store/apps/details?id=com.whatsapp">WhatsApp</a> and <a href="https://play.google.com/store/apps/details?id=com.booking">Booking.com</a> for reserving hostel beds. I’d typically write something simple like “Hola, quiero hacer una reserva para el 12 de agosto”.</li>
  <li><a href="https://www.gronze.com/">Gronze</a> for hostel prices and reviews.</li>
  <li><a href="https://play.google.com/store/apps/details?id=de.moemke.android.mycamino">Camino Pilgrim</a> for stage planning. Since I had already bought a return flight that afforded me 34 days of walking, I took Gronze’s 33 stages and added a new one to the mountainous stretch between Astorga and Sarria. Camino Pilgrim contains the locations and amenities of over 200 towns on the Camino, which allowed me to easily plan stages with convenient stopping points and roughly equal lengths.</li>
  <li><a href="https://play.google.com/store/apps/details?id=com.mobillium.airalo">Airalo</a> for mobile data. I paid $18 for a 10 GB eSIM that lasted 30 days. Hostels usually have free WiFi.</li>
  <li><a href="https://github.com/artnc/chronofile">Chronofile</a>, an app that I created myself, for <a href="https://chaidarun.com/ten-years-of-logging-my-life">tracking my daily activities</a>. I slept for 7.93 hours and walked for 5.67 hours each day on average.</li>
  <li><a href="https://play.google.com/store/apps/details?id=com.google.android.keep">Google Keep</a> for journaling. I found it helpful to write down the names of every pilgrim I met since I would so often run into them again sooner or later.</li>
</ul>

<p><img src="https://chaidarun.com/img/camino-sunflowers.jpg" alt="" /></p>

<h2 id="language">Language</h2>

<p><strong>Spain is less formal than Latin America.</strong> If you studied Spanish in the US, you’re probably aware that Spain has informal <em>vosotros</em> conjugations for second-person plural (i.e. “y’all” forms) while countries like Mexico always use formal <em>ustedes</em>. What surprised me more was that Spaniards rarely use formal second-person singular (<em>usted</em>) either, instead opting for informal <em>tú</em> even when addressing strangers and customers.</p>

<p><strong>The lisp is real.</strong> Most Spaniards pronounce the letters <em>c</em> (before <em>e</em> or <em>i</em>) and <em>z</em> as <em>th</em>. For example, <em>cerveza</em> (beer) becomes “thervetha”. Despite my years of studying Latin American Spanish, I’m now stuck saying <em>grathias</em> for better or worse.</p>

<p>Common words and phrases on the Camino:</p>

<ul>
  <li><em>vale</em> = “OK”. I must have heard this at least once per sentence on average.</li>
  <li><em>Buen camino</em> = “Have a good Camino”, similar to <em>bon voyage</em>.</li>
  <li><em>albergue</em> = “hostel”.</li>
  <li><em>hospitalero / hospitalera</em> = “hostel caretaker”, often volunteers.</li>
  <li><em>meseta</em> = the flat, dry plateau that covers central Spain from Burgos to Astorga.</li>
  <li><em>aseo</em> = “restroom”. This relatively formal word appears mostly on signage, while in spoken conversation people tend to say <em>baño</em> (bathroom).</li>
  <li><em>menú del día</em> = “menu of the day”. Most restaurants offer lunch as a set menu that includes bread, water or wine, an appetizer, a main dish, and dessert. That’s what <em>menú</em> normally refers to, so you’ll need to ask for <em>carta</em> if you want to see what Americans would typically call the menu.</li>
  <li><em>Buen provecho</em> = “Enjoy your meal”, similar to <em>bon appétit</em>.</li>
  <li><em>Dime</em> = “What can I get you?” Literally “tell me”.</li>
  <li><em>vaso de agua</em> = “glass of (tap) water”. All tap water in Spain is safe to drink and free at restaurants by law, but they’ll never give it to you unless you ask for it specifically.</li>
  <li><em>¿Coreano?</em> = “Are you Korean?” Most of the East Asians I met on the Camino were Korean, thanks to a famous Korean author’s 2006 memoir. Once I even saw a Korean-run hostel that served <em>ramyeon</em> for pilgrim dinner.</li>
</ul>

<p><img src="https://chaidarun.com/img/camino-leon.jpg" alt="" /></p>

<h2 id="observations">Observations</h2>

<p>Apart from obvious markers like language and currency, many subtler aspects of Spanish culture made it clear that I wasn’t in Pennsylvania anymore:</p>

<ul>
  <li>Restaurant beef is almost always veal, even in burgers. The most familiar beef that I ever encountered was during a post-Camino layover in Barcelona, where I had to try a Spanish McDonald’s exclusive: the McExtreme with gouda and pulled pork.</li>
  <li>After wheat, sunflowers are the most common crop along the Camino. Sunflowers with the misfortune of having grown near the trail would often have individual seeds plucked out by pilgrims to form smiley faces (which I found rather tasteless).</li>
  <li>Most hostels and hotels give you a single long, thin pillow that spans the width of the entire bed. It’s more or less impossible to stuff one of these anacondas into the flimsy disposable pillowcase that hostels provide; you need to grab one end of the tubular pillowcase and pull the pillow through it instead.</li>
  <li>Fanta contains real fruit juice and tastes so much better than in the US—and this is coming from someone who really doesn’t understand all the fuss over Mexican Coke. Fanta Naranja tastes like actual orange juice, not liquified candy. Fanta Limón opened my eyes to how good soda could be.</li>
  <li>The so-called <em>siesta</em> is real, although the more neutral term for small businesses’ midday break is <em>descanso</em> (rest). Many Spanish restaurants will open for only two hours at lunch and again at dinner. Show up ASAP to ensure that you get a table.</li>
  <li>The tap water in the <em>meseta</em> tastes like ass. No wonder restaurants won’t give it to you. Galicia and the Basque Country have much softer water.</li>
</ul>

<p><img src="https://chaidarun.com/img/camino-meseta.jpg" alt="" /></p>

<h2 id="memories">Memories</h2>

<p>I met the <a href="https://www.imdb.com/title/tt13959734/">mildly famous</a> painter <a href="https://www.arterealizzata.com/interviews/joan-bueno">Joan Bueno</a> by chance in a tiny village of 115 people. As soon as I sat down for lunch at the table next to his, he silently started sketching me unprompted. Once he finished I wondered whether he’d try to sell me the drawing, but no—he simply told me to take a photo and then flipped through the notebook, revealing dozens more sketches of people and places from his daily life.</p>

<p>I asked him if he was a pilgrim. He said that he was just visiting town for his art exhibition tomorrow but that he had walked 26 times before! After two low-tech weeks of speaking mostly Spanish, it felt surreal to find this 91-year-old Barcelonan in the middle of nowhere who vigorously spoke perfect English and recited his social media URLs from memory.</p>

<p><img src="https://chaidarun.com/img/camino-joan.jpg" alt="" /></p>

<p>I met a pair of Mexican-American pilgrims at dinner that evening. We commiserated over our depraved methods for eating supermarket yogurt without having packed any spoons. A few days later, in an even smaller village of 66 people, I ran into them again and they invited me to try their hostel’s guitar. They warned me that it was out of tune, but of course that’s easy to fix—unlike the <a href="https://chaidarun.com/img/camino-piano.webm">extremely untuned piano</a> I had found earlier.</p>

<p>Unfortunately the problem was much more serious: two of the poor guitar’s six tuning knobs were completely missing! A nearby <em>hospitalera</em> noticed my plight and handed me some (also broken) pliers, saying that that’s how they’ve been managing to tune it.</p>

<p>Hours later as the other pilgrims filed off to bed, I thanked the <em>hospitalera</em> for waiting so long in the room with us. She replied that she wasn’t waiting for us and had just enjoyed hearing me play, saying that it reminded her of someone she knew many years ago.</p>

<p>When I asked her which song she had liked best, she answered that <a href="https://www.youtube.com/watch?v=R-5weyHVC2U"><em>Recuerdos de la Alhambra</em></a> gave her chills. Finally, I thought, I found a Spaniard in Spain who could be moved by the nostalgia of this Spanish guitar piece, arguably the most famous one in the classical repertoire, a piece I had practiced hundreds of times before… but it turned out that she had actually recognized it from the 2018 <a href="https://en.wikipedia.org/wiki/Memories_of_the_Alhambra">Korean drama</a> of the same name.</p>

<p><img src="https://chaidarun.com/img/camino-guitar.jpeg" alt="" /></p>

<p>My stay in the charming town of Los Arcos gradually devolved into a comedy of errors. At noon I checked into the municipal hostel, which at €8 was among the cheapest on the Camino. Upon seeing their one small room crammed with 28 bunks and at least as many flies, I decided to cut my losses and sleep elsewhere. (A week later, another pilgrim told me she wished she had done the same.)</p>

<p>The new place’s receptionist helpfully showed me to their rooftop laundry area. But when I came back later to collect my clothes, the rooftop door was locked?! I thought better of going into town wearing only swim trunks and also of trying to rake the door’s lock, so I texted the receptionist and ended up waiting several hours for him to return.</p>

<p>By the time I escaped the building, a huge festival was already in full swing. Apparently today was the feast day of the town’s patron saint. All supermarkets and restaurants had closed for the holiday, so I and some other pilgrims wandered the reveler-flooded streets looking for vending machines. I found one and quickly bought a pack of four cheese sandwiches, failing to notice that what I had really bought was… four massive hunks of cheese. I lived off 1600 calories of cheese that day.</p>

<p><img src="https://chaidarun.com/img/camino-festival.jpg" alt="" /></p>

<p>Wanting to pack light, I brought rubber Teva sandals to Spain as my only pair of footwear. This caused much confusion among <em>hospitaleros</em> who tried to show me where I could store my nonexistent hiking boots. One group of Taiwanese pilgrims was particularly horrified to learn that I had been hiking through forests and over the Pyrenees mountains in sandals. When I passed them on the trail a couple days later, they were all wearing sandals. I never got a single blister.</p>

<p><img src="https://chaidarun.com/img/camino-pyrenees.jpg" alt="" /></p>

<p>On day 34 of my Camino, I started walking the final stage to Santiago at 5am in pitch black darkness. I had read about the Pilgrim’s Reception Office receiving more than a thousand pilgrims in a single day, so I wanted to arrive as soon as the office opened at 9am. Finishing my Camino so early in the morning did, however, leave me with several hours to kill before hostel check-in at 1:30pm. I headed over to the hostel anyway to loiter in its lobby, where I found that they had a <a href="https://chaidarun.com/guitalele">guitalele</a>!</p>

<p>This specimen was in amazingly good condition, much better than the guitar I had played weeks ago. I felt right at home on my <a href="https://chaidarun.com/ten-years-of-logging-my-life#observations">main instrument</a> and proceeded to spend the next few hours running through every song I knew, sometimes accompanied by other pilgrims’ singing. Not long after I finally put down the guitalele, an American pilgrim showed up, collected his belongings, and left with them… including the guitalele. I was shocked that the guitalele wasn’t the hostel’s, and everyone else in the room was shocked that it wasn’t mine!</p>

<p><img src="https://chaidarun.com/img/camino-guitalele.jpg" alt="" /></p>

<p>Vibes along the Camino were overwhelmingly positive, but I did encounter two notable forms of antagonism.</p>

<p>One was Camino snobbery: the patently absurd phrase “Jesus didn’t start in Sarria” spray-painted on so many walls<sup id="fnref:jesus"><a href="https://chaidarun.com/camino-de-santiago#fn:jesus" class="footnote" rel="footnote" role="doc-noteref">5</a></sup>, the 71-year-old Brit who crowed about walking double-length stages last year while calling <a href="https://en.wikipedia.org/wiki/Fisterra">Fisterra</a> an idiotic scam and people who shuttled their luggage cheaters, and the Czech bro who argued at length with a patient <em>hospitalera</em> about the ridiculousness of seeing an Asian pilgrim walk in the sun with an umbrella and hardly any exposed skin. Clearly he didn’t realize that the pilgrim in question had a photosensitive skin condition and was now sitting right next to him!</p>

<p>The other occasional unpleasantness was anti-Camino graffiti, e.g. “FUCK MASS TOURISM FUCK THE CAMINO” painted in huge letters across the sidewalk on the final bridge into Santiago. I’m not above calling myself a tourist, I think it’s silly to obsess over what makes a pilgrim or tourist or “traveler”, and I’m annoyed by entitlement and inconsiderateness like anyone else. But surely these urban activists must realize that dozens of towns along the Camino, including Santiago itself, exist <em>because</em> of the Camino? It and its commercialization were there first by a long shot.</p>

<p>All that said, you can’t let a handful of people reflect badly on or ruin the experience of millions. I remember the young local boy who haltingly wished me “Good walk” (a very literal English translation of <em>buen camino</em>), the <em>hospitalera</em> who invited me to home-cooked dinner with her daughter and mother since I was her only guest that day, all the highway drivers who waved and cheered as they flew by, the middle-aged Irish pilgrim who told me how his children in Vietnam were his entire world and that I looked just like one of them, and the former <em>hospitalera</em> who seemed to think I was lost and turned around to walk with me until we reached the edge of town.</p>

<p><img src="https://chaidarun.com/img/camino-molinaseca.jpg" alt="" /></p>

<h2 id="trivia">Trivia</h2>

<p>I now give the people what they’re really here for.</p>

<ul>
  <li>
    <p>During the American Revolutionary War, the Continental Congress sent future president John Adams to ask France for financial aid. When his ship started leaking, he and his sons (including future president John Quincy Adams) narrowly avoided death by getting off early at Fisterra, the westernmost point of Spain. They then traveled the entire Camino <a href="https://allthingsliberty.com/2016/11/remarkable-spanish-pilgrimage-john-adams/"><em>backwards</em></a> all the way to Paris!</p>
  </li>
  <li>
    <p>The Milky Way points in the direction of Santiago, and ancient pilgrims used it for navigation. In Spanish, the Milky Way is accordingly known as <em>El Camino de Santiago</em>.</p>
  </li>
  <li>
    <p>Traditionally, a Camino pilgrim would walk from their own house to Santiago and then back home again. The Camino de Santiago is thus a network of many alternate routes: the classic <a href="https://en.wikipedia.org/wiki/French_Way">French Way</a> starting in France, the <a href="https://en.wikipedia.org/wiki/Portuguese_Way">Portuguese Way</a> starting in Lisbon, the <a href="https://en.wikipedia.org/wiki/English_Way">English Way</a> starting on Spain’s northern coast, and so on. But even Camino veterans may be surprised to learn of the <a href="https://www.elcaminoconcorreos.com/en/blog/day-16-the-pingigrinos-of-the-antarctic-way-arrive-in-compostela">Antarctic Way</a>, which begins at a Spanish research base in Antarctica, crosses the Atlantic Ocean by boat, and finally joins the Portuguese Way at Pontevedra for a grand total of 14 megameters.</p>
  </li>
</ul>

<h2 id="gallery">Gallery</h2>

<table>
  <tbody>
    <tr>
      <td><img src="https://chaidarun.com/img/camino-sheep.jpg" alt="" /></td>
      <td><img src="https://chaidarun.com/img/camino-donkey.jpg" alt="" /></td>
      <td><img src="https://chaidarun.com/img/camino-credential.jpg" alt="" /></td>
      <td><img src="https://chaidarun.com/img/camino-highway.jpg" alt="" /></td>
    </tr>
    <tr>
      <td><img src="https://chaidarun.com/img/camino-moon.jpg" alt="" /></td>
      <td><img src="https://chaidarun.com/img/camino-fields.jpg" alt="" /></td>
      <td><img src="https://chaidarun.com/img/camino-forest.jpg" alt="" /></td>
      <td><img src="https://chaidarun.com/img/camino-factory.jpg" alt="" /></td>
    </tr>
    <tr>
      <td><img src="https://chaidarun.com/img/camino-sunrise.jpg" alt="" /></td>
      <td><img src="https://chaidarun.com/img/camino-bunk.jpg" alt="" /></td>
      <td><img src="https://chaidarun.com/img/camino-wheat.jpg" alt="" /></td>
      <td><img src="https://chaidarun.com/img/camino-bridge.jpg" alt="" /></td>
    </tr>
    <tr>
      <td><img src="https://chaidarun.com/img/camino-sky.jpg" alt="" /></td>
      <td><img src="https://chaidarun.com/img/camino-stars.jpg" alt="" /></td>
      <td><img src="https://chaidarun.com/img/camino-sign.jpg" alt="" /></td>
      <td><img src="https://chaidarun.com/img/camino-cathedral.jpg" alt="" /></td>
    </tr>
  </tbody>
</table>

<h2 id="further-reading">Further reading</h2>

<ul>
  <li><a href="https://nadinewalks.com/">Nadine Walks</a> and <a href="https://stingynomads.com/">Stingy Nomads</a> and <a href="https://www.lensofjen.org/the-camino-de-santiago/">The Lens of Jen</a>, Camino blogs</li>
  <li><a href="https://www.youtube.com/@DaysWeSpend">Days We Spend</a>, a Camino YouTube channel</li>
  <li><a href="https://www.reddit.com/r/CaminoDeSantiago/">r/CaminoDeSantiago</a> on Reddit</li>
  <li><a href="https://americanpilgrims.org/request-a-credential/">Request a Credential</a> from American Pilgrims on the Camino</li>
  <li><a href="https://caminoweather.com/">CaminoWeather</a> forecasts</li>
  <li><a href="https://thetrek.co/hey-thru-hiker-like-it-or-not-the-camino-has-a-few-things-to-teach-you/">Hey, Thru-Hiker: Like It or Not, the Camino Has a Few Things To Teach You</a></li>
</ul>
<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:usap">
      <p>My plan A was to work a summer job in Antarctica and for the past few years I’ve been applying to dozens of positions as soon as they open, but it’s getting harder and harder to land a gig there nowadays. Do let me know if you have any USAP connections! <a href="https://chaidarun.com/camino-de-santiago#fnref:usap" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:schwab">
      <p>It takes some paying attention, but you can also <a href="https://www.mymoneyblog.com/schwab-starter-kit-promo.html">get $101</a> in cash for free when signing up. <a href="https://chaidarun.com/camino-de-santiago#fnref:schwab" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:franco">
      <p>…which is effectively 4am. Spain lies directly south of the UK but has been in the wrong time zone since World War II, when Francisco Franco changed the country’s time zone to match Nazi Germany’s. So when you hear about Spaniards eating dinner at 10pm, remember that it’s really more like 9pm by the sun. <a href="https://chaidarun.com/camino-de-santiago#fnref:franco" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:communion">
      <p>Source: I attended hundreds of masses across several countries as a Catholic school kid and never once took communion. <a href="https://chaidarun.com/camino-de-santiago#fnref:communion" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:jesus">
      <p>Pilgrims who walk at least 100 km may receive the <em>compostela</em>, a completion certificate awarded since medieval times. The vast majority of modern pilgrims therefore start their trip in Sarria, a town on the French Way located just over 100 km from Santiago. While it’s true that Jesus didn’t start in Sarria, he didn’t start in St. Jean or Jerusalem or anywhere else either… <a href="https://chaidarun.com/camino-de-santiago#fnref:jesus" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>
]]></description>
      </item>
      
    
      
      <item>
        <title>How to Play Guitar by Ear</title>
        <link>https://chaidarun.com/how-to-play-guitar-by-ear</link>
        <pubDate>Thu, 28 Dec 2023 00:00:00 GMT</pubDate>
        <guid isPermaLink="true">https://chaidarun.com/how-to-play-guitar-by-ear</guid>
        
        <description><![CDATA[<p>While noodling around on guitar as the year wraps up, I thought of the song <a href="https://www.youtube.com/watch?v=Aop6YF1Xqqg"><em>Auld Lang Syne</em></a> and—to my pleasant surprise—banged out a fully formed fingerstyle arrangement in one go.</p>

<p>It wasn’t always so simple! I’ve never been interested in music theory for its own sake, I’m <em>far</em> from naturally gifted, and I completely relied on sheet music for many years… until eventually I got tired of hunting down and memorizing the tabs for every single song I wanted to play.</p>

<p>This post outlines some basic tips and tricks for producing attractive (if not exactly virtuosic) song arrangements by ear, as demonstrated in my <a href="https://chaidarun.com/musescore-tab">tab</a> of Journey’s <em>Don’t Stop Believin’</em> and my cover of Final Fantasy X’s main theme:</p>

<div class="youtube-wrap">
  <iframe src="//www.youtube.com/embed/SsBU2m9WSM4" allowfullscreen=""></iframe>
</div>

<p>Here we’ll apply these methods to a familiar pop tune, Leonard Cohen’s <a href="https://www.youtube.com/watch?v=YrLk4vdY28Q"><em>Hallelujah</em></a>. No prior music theory knowledge required!</p>

<h2 id="1-assume-c-major">1. Assume C major</h2>

<p>In piano terms, this essentially means ignoring the black keys, which typically correspond to sharps (♯) and flats (♭).</p>

<p>Most melodies can be played recognizably using only the white keys. This set of notes is also known as <em>C major</em> because a melody that uses only these notes will sound fully resolved to listeners if its final note is a C note<sup id="fnref:1"><a href="https://chaidarun.com/how-to-play-guitar-by-ear#fn:1" class="footnote" rel="footnote" role="doc-noteref">1</a></sup>. <em>Jingle Bells</em>, <em>Happy Birthday</em>, <em>Ode to Joy</em>, you name it—all of these melodies end on C when pecked out on a piano’s white keys.</p>

<p><img src="https://chaidarun.com/img/how-to-play-guitar-by-ear-middle-c.svg" alt="" /></p>

<p>This means that we can set a song in C major by choosing C as its final note. Why does that matter? It’s less obvious than on piano, but C major is also arguably the most straightforward scale to play on guitar. The first three frets contain all the notes of C major and its commonly associated chords, minimizing hand movement.</p>

<p><img src="https://chaidarun.com/img/how-to-play-guitar-by-ear-c-scale.png" alt="" /></p>

<p>Contrast this with the B major scale, which uses all of the piano’s black keys and four of the guitar’s frets.</p>

<p>Now that we know that C should be our song arrangement’s last note, how do we go about determining the rest of them?</p>

<h2 id="2-anchor-the-melody-on-c">2. Anchor the melody on C</h2>

<p>Most songs alternate between a verse melody and a chorus melody before ultimately ending with an instance of the chorus. <em>Hallelujah</em>’s chorus (and the song itself) ends on the last syllable of the word “hallelujah” repeated four times. If we want this last “-jah” note to be a C, we have two comfortably reachable choices within the guitar’s first three frets: the A string’s third fret and the B string’s first fret<sup id="fnref:2"><a href="https://chaidarun.com/how-to-play-guitar-by-ear#fn:2" class="footnote" rel="footnote" role="doc-noteref">2</a></sup>. We’ll choose the former (lower) option since Cohen sings the final “-jah” in a relatively low register, and we want to leave room for the rest of the song’s melody to go above it.</p>

<p><img src="https://chaidarun.com/img/how-to-play-guitar-by-ear-jah.png" alt="" /></p>

<p>Play this low C a few times and listen to it carefully. Sing “-jah” at that pitch. Then continue singing straight into the song’s second verse, “Your faith was strong, but you needed proof”. Now we can hear how those notes should sound too, but where do we find them on the guitar?</p>

<h2 id="3-estimate-interval-sizes-and-directions">3. Estimate interval sizes and directions</h2>

<p>Since we’ve set our arrangement in C major, a scale that we know to be playable within the guitar’s first three frets, it’s not too hard to find that lyric’s notes through trial and error with careful listening. If we play the A string’s third fret as “-jah”, then “Your” is at the D string’s second fret, “faith” is on the open G string, and so on.</p>

<p><img src="https://chaidarun.com/img/how-to-play-guitar-by-ear-your-faith.png" alt="" /></p>

<p>We can arrive there by guessing randomly, but that’s hardly efficient. The process becomes much faster if we hear that both “Your” and “faith” constitute small upward jumps in pitch from the preceding note. Hearing the direction and (roughly) the magnitude of such pitch changes is more important than identifying those interval sizes precisely. For example, The Killers’ <a href="https://www.youtube.com/watch?v=gGdGFtwCNBE"><em>Mr. Brightside</em></a> repeats the same note over and over throughout its entire verse, while the climactic “or twoooooo” lyric in a-ha’s <a href="https://www.youtube.com/watch?v=djV11Xbc914"><em>Take on Me</em></a> makes a huge upward jump.</p>

<p>Notice that songs tend to change lyrics across verses while keeping the verses’ notes mostly the same. The opening notes of <em>Hallelujah</em>’s second verse are the same as those of its first verse, “I heard there was a secret chord”. Now that we’ve got the notes down for “I heard”, we can continue using each note to figure out the next one until we finally reach the song’s final “-jah”, the low C that we chose as our arrangement’s tonal center.</p>

<p><img src="https://chaidarun.com/img/how-to-play-guitar-by-ear-ending.png" alt="" /></p>

<p>We’ve got a full melody line at this point, and if we were flatpicking on lead guitar then we might even call the job finished. But that’s boring—we also want to fill out our sound with chords and percussion!</p>

<h2 id="4-know-the-four-chords">4. Know the four chords</h2>

<p>A chord is a set of notes that sound good when played simultaneously. We can’t just pluck two guitar strings at random frets and expect a decent result. Both notes should be part of the same chord.</p>

<p>The <a href="https://en.wikipedia.org/wiki/I%E2%80%93V%E2%80%93vi%E2%80%93IV_progression">most commonly used chords</a> in the C major scale are C major (yes, it’s named the same thing), G major, A minor, and F major<sup id="fnref:3"><a href="https://chaidarun.com/how-to-play-guitar-by-ear#fn:3" class="footnote" rel="footnote" role="doc-noteref">3</a></sup>. Very unscientifically, we can play 80% of pop songs using only these four chords, and learning a few more (Em, Dm, D, E) will get us to 95%<sup id="fnref:4"><a href="https://chaidarun.com/how-to-play-guitar-by-ear#fn:4" class="footnote" rel="footnote" role="doc-noteref">4</a></sup>.</p>

<p><img src="https://chaidarun.com/img/how-to-play-guitar-by-ear-chords.png" alt="" /></p>

<p>So what do we do with these chords? When do we play them, and how do we know which one to use?</p>

<h2 id="5-keep-the-melody-on-top">5. Keep the melody on top</h2>

<p>Chord changes tend to happen on <em>downbeats</em>, evenly spaced points in time that usually coincide with emphasized syllables. Try singing <em>Hallelujah</em>’s first verse:</p>

<blockquote>
  <p>“I heard there was a secret chord that David played, and it pleased the Lord…”</p>
</blockquote>

<p>The loudest syllables are “heard”, “se-“, “Da-“, and “pleased”. These points in time represent possible candidates for chord changes.</p>

<p>Once we have an idea of where a chord change might be happening, we can simply guess a chord to play along with the melody and see whether it sounds right! Since humans perceive high notes more strongly than low notes and we need to keep the melody audible, we should pluck only the strings of each chord that lie below the melody note’s string<sup id="fnref:5"><a href="https://chaidarun.com/how-to-play-guitar-by-ear#fn:5" class="footnote" rel="footnote" role="doc-noteref">5</a></sup>.</p>

<p><img src="https://chaidarun.com/img/how-to-play-guitar-by-ear-i-heard.png" alt="" /></p>

<p>How could we guess that Cohen chose C-Am-C-Am as the chord progression here? Trial and error works fine, but some rules of thumb may also help…</p>

<h2 id="6-understand-each-chords-personality">6. Understand each chord’s personality</h2>

<p>Each of the four most common chords plays its own role in the song’s story:</p>

<ul>
  <li>
    <p>Songs in C major typically end on a C chord, similar to how the melody typically ends on a C note. If you let a C chord ring out, expect the applause to begin.</p>
  </li>
  <li>
    <p>The A minor chord does heavy lifting as the only sad-sounding chord of the four. Songs in C major rarely end on Am<sup id="fnref:6"><a href="https://chaidarun.com/how-to-play-guitar-by-ear#fn:6" class="footnote" rel="footnote" role="doc-noteref">6</a></sup>. Songwriters often use Am in verse and prechorus sections to build tension that then gets released in the chorus.</p>
  </li>
  <li>
    <p>G and F serve similar roles as happy-sounding chords that provide some flavor on the song’s way home to C. The G major chord sounds calm and expectant to me, often preceding a dramatic climax (“the baffled king com-POS-ing Hallelujah”) or the song’s final C chord (“Halle-luuuuuuuu-jah”). F sounds more casual and transient than G, as if it’s less worried about making it to C<sup id="fnref:7"><a href="https://chaidarun.com/how-to-play-guitar-by-ear#fn:7" class="footnote" rel="footnote" role="doc-noteref">7</a></sup>.</p>
  </li>
</ul>

<p>Once you develop a feel for these chords’ moods, you’ll start noticing them everywhere. <em>Hallelujah</em> offers us a shortcut: its lyrics name the song’s own chords!</p>

<p><img src="https://chaidarun.com/img/how-to-play-guitar-by-ear-prechorus.png" alt="" /></p>

<p>The C major scale’s fourth note counting from C is F, so “the fourth” refers to F major. Similarly, “the fifth” is G major. The “minor fall” and the “major lift” are Am and F again. (“Fall” and “lift” aren’t technical terms; they just evoke the sad and happy natures of minor and major chords.)<sup id="fnref:8"><a href="https://chaidarun.com/how-to-play-guitar-by-ear#fn:8" class="footnote" rel="footnote" role="doc-noteref">8</a></sup></p>

<h2 id="7-mix-it-up">7. Mix it up</h2>

<p>Even after we put melody and chords together, our arrangement still sounds hollow. Strumming the new chord once at every chord change moves the song forward in a rather unsophisticated manner.</p>

<p>We can make our arrangement more interesting by <em>arpeggiating</em> the chords (playing their constituent notes one at a time), omitting some chords’ notes, or repeating those notes at different rhythms. We can improvise these right hand decisions on the fly instead of committing them to memory. As long as the left hand holds down the correct chord shape, anything the right hand does will sound fine.</p>

<p>Simply arpeggiate the C-Am chord progression in a certain way and you get <em>Hallelujah</em>’s distinctive intro:</p>

<p><img src="https://chaidarun.com/img/how-to-play-guitar-by-ear-intro.png" alt="" /></p>

<h2 id="8-get-slapping">8. Get slapping</h2>

<p>Slapping on guitar is like cooking with MSG. It’s like white balancing your photos. It’s a hack that instantly improves most things.</p>

<p>The guitar’s most basic percussive technique is to slap the lowest string or two with the left side of your right thumb, usually notated as “X” in tabs. Doing this while simultaneously plucking a note takes some practice. Other possible percussive techniques include tapping the guitar’s body with your thumb, bumping it with your wrist, drumming it with your fingers, or even scratching it with your nails, but the humble string slap alone will carry you pretty far.</p>

<p>When to slap? <em>Offbeats</em>, the evenly spaced points at which people normally clap when clapping along to a song, are a good start. We could slap throughout the entire song, but for greater variety and dramatic effect, it’s often better to wait until either the first chorus or the second verse. Many songs have a quieter, more intimate bridge section that behooves us to take a break from all the slapping. As with our chord playing, slapping is improvisable and largely up to personal taste.</p>

<h2 id="9-throw-in-some-ornamentation">9. Throw in some ornamentation</h2>

<p>As a final touch, we can sprinkle in some small flourishes such as grace notes, slides, and harmonics. Take care not to overuse these, and again feel free to improvise rather than memorize.</p>

<p><img src="https://chaidarun.com/img/how-to-play-guitar-by-ear-slap.png" alt="" /></p>

<h2 id="why-this-approach">Why this approach?</h2>

<p>I used to think that playing by ear meant pulling up a song on Spotify and reproducing it note for note. That might help train your ear, but otherwise it’s a waste of time. Next week when your adoring fans ask you to play <em>Hallelujah</em>, will you really remember all 1000+ notes of that Spotify recording? Even if you nail every single note, will your audience notice or care? Faithfulness clearly doesn’t count for everything, given that Jeff Buckley’s <a href="https://www.youtube.com/watch?v=y8AWFf7EAc4">version</a> of <em>Hallelujah</em> is at least as popular as Cohen’s original!</p>

<p>This post’s methods optimize for <em>memory efficiency</em>, not <em>fidelity</em>. In computing terms, it’s lossy compression: JPEG vs RAW, MP3 vs WAV. Instead of memorizing unimportant details like the order in which the original recording arpeggiates a particular chord’s notes, we can improvise them at performance time. Sticking to the C major scale and reducing every song to its melody and chord progression lets us fit dozens—or even hundreds—of <a href="https://chaidarun.com/songs">songs</a> into our brain!</p>
<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:1">
      <p>On piano, a C note is any key immediately to the left of a cluster of two black keys. There are eight of them. On guitar, C notes are located at the third fret of the A string and at the first fret of the B string, among other places. <a href="https://chaidarun.com/how-to-play-guitar-by-ear#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:2">
      <p>These two options’ placement on the fretboard is another reason why I prefer to set songs in C major rather than G major, the guitar’s other most common scale. The G major scale does avoid the awkwardness of barring an F major chord, and it does provide three options (on the G string and both E strings) for the song’s final note rather than two, but it also awkwardly crams two full octaves into the first three frets. Most melodies focus on a single octave, so I find it convenient that the C major scale provides a single choice of octave with ample breathing room above and below. In contrast, both of the G major scale’s two octaves are physically off-center on the fretboard. <a href="https://chaidarun.com/how-to-play-guitar-by-ear#fnref:2" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:3">
      <p>Major chords like G major may be abbreviated as Gmaj or simply G, while minor chords like A minor are conventionally abbreviated as Amin or Am. Somewhat confusingly, the letter “G” without any further context may refer to the G note, the G major scale, the G major chord, or even the G string. <a href="https://chaidarun.com/how-to-play-guitar-by-ear#fnref:3" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:4">
      <p>Taylor Swift is especially fond of and successful with the C-G-Am-F formula. She’s easily the biggest bang for your buck when playing songs by ear. <a href="https://chaidarun.com/how-to-play-guitar-by-ear#fnref:4" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:5">
      <p>Keeping the melody note on top isn’t strictly necessary, especially when the melody is at a low enough point that barely any chord notes would fit underneath. Just make sure to <em>always</em> play the melody note the loudest so that listeners can identify it readily. <a href="https://chaidarun.com/how-to-play-guitar-by-ear#fnref:5" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:6">
      <p>If you’re arranging a song that’s <em>meant</em> to sound sad the whole time, ignore everything I’m saying about C as the song’s final note and chord. The song might actually be using a sad minor scale (as opposed to a happy major scale), in which case we should aim to reach A as the final note and Am as the final chord. All other tips here remain mostly the same since the A minor scale happens to contain exactly the same notes as the C major scale. Examples of songs written in a minor scale include Linkin Park’s <a href="https://www.youtube.com/watch?v=kXYiU_JCYtU"><em>Numb</em></a>, Simon and Garfunkel’s <a href="https://www.youtube.com/watch?v=NAEppFUWLfc"><em>The Sound of Silence</em></a>, Bill Withers’s <a href="https://www.youtube.com/watch?v=CICIOJqEb5c"><em>Ain’t No Sunshine</em></a>, and <em>To Zanarkand</em> as performed by myself at the top of this post. <a href="https://chaidarun.com/how-to-play-guitar-by-ear#fnref:6" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:7">
      <p>I’m generally not synesthetic, but I do mentally associate these chords with certain colors: C is white, G is yellow, Am is red, and F is blue. G is an old man, F is a young woman. Go figure. <a href="https://chaidarun.com/how-to-play-guitar-by-ear#fnref:7" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:8">
      <p><em>Hallelujah</em>’s lyrics mention one more chord: the “secret chord” stated in the first verse. Can you guess what it is? It’s not actually F-G-Am-F, which is a <em>progression</em> of multiple chords. The secret chord is <a href="https://adamsguitars.com/content/guitarwebapp/index.php?md=4&amp;rn=20&amp;ct=5&amp;ks=F1&amp;fm=0">Gsus</a>, of course :) More seriously, my money is on <a href="https://chordbank.com/chords/e-7/">E7</a>, the chord that dramatically accompanies the phrase “composing Hallelujah”. E7 marks the very first occurrence in the song’s lyrics of its namesake word “hallelujah”, it appears nowhere else in the song’s structure, it’s the song’s only chord other than the four most common ones, and it’s not named in the “it goes like this” lyrics—it’s literally a secret. <a href="https://chaidarun.com/how-to-play-guitar-by-ear#fnref:8" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>
]]></description>
      </item>
      
    
      
      <item>
        <title>How to Use a Custom Email Domain with Gmail</title>
        <link>https://chaidarun.com/custom-email-domain-with-gmail</link>
        <pubDate>Mon, 16 Jan 2023 00:00:00 GMT</pubDate>
        <guid isPermaLink="true">https://chaidarun.com/custom-email-domain-with-gmail</guid>
        
        <description><![CDATA[<p>Here’s exactly what I did to set up my own <code class="language-plaintext highlighter-rouge">firstname@lastname.com</code> email address in Gmail, allowing me to seamlessly use that new address with my existing Gmail account:</p>

<p><img src="https://chaidarun.com/img/gmail-from.png" alt="" /></p>

<p>This process takes an hour or two and costs around $10/year.</p>

<ol>
  <li>Create a personal <a href="https://www.google.com/gmail/about/">Gmail</a> account if you don’t already have one.
    <ul>
      <li>Optional: go to gear icon &gt; Settings &gt; Images and disable automatic image loading. You know how some chat apps have read receipts? Well it turns out that nosy email senders (e.g. spammers) often use inline images in a similar way to <a href="https://www.wired.com/2013/12/turn-gmail-auto-image-loading-off/">determine</a> whether the recipient has opened their message.<br /><br /><img src="https://chaidarun.com/img/gmail-images.png" alt="" /></li>
    </ul>
  </li>
  <li>Buy a domain name at <a href="https://www.namecheap.com/">Namecheap</a>, e.g. <code class="language-plaintext highlighter-rouge">chaidarun.com</code>.
    <ul>
      <li>Try to get a <code class="language-plaintext highlighter-rouge">.com</code> for the credibility and familiarity. You <em>could</em> get a <code class="language-plaintext highlighter-rouge">.org</code> or <code class="language-plaintext highlighter-rouge">.net</code> if your preferred <code class="language-plaintext highlighter-rouge">.com</code> isn’t available, but then you run the risk of people forgetting and trying to email you at <code class="language-plaintext highlighter-rouge">.com</code> anyway<sup id="fnref:fawm"><a href="https://chaidarun.com/custom-email-domain-with-gmail#fn:fawm" class="footnote" rel="footnote" role="doc-noteref">1</a></sup>.</li>
      <li>This is the only step that costs money!<br /><br /><img src="https://chaidarun.com/img/namecheap-domain.png" alt="" /></li>
    </ul>
  </li>
  <li>Go to your Namecheap account &gt; Profile &gt; <a href="https://ap.www.namecheap.com/settings/security">Settings</a> and enable 2FA.
    <ul>
      <li>By default, Namecheap sends a verification code to your <code class="language-plaintext highlighter-rouge">@gmail.com</code> address whenever you try to log in. Enabling 2FA via either TOTP or Yubikey will replace that step, removing the dependency on your old address—more on this <a href="https://chaidarun.com/custom-email-domain-with-gmail#why-you-need-a-custom-email-domain">later</a>.</li>
    </ul>
  </li>
  <li>Create a free <a href="https://www.cloudflare.com/">Cloudflare</a> account and “Add a Site” for your new domain
    <ul>
      <li>Like me, you might already be using their free CDN on your personal website. You should just reuse your existing site entry if your desired custom email address will be on the same domain.</li>
    </ul>
  </li>
  <li>Go to your Cloudflare site’s dashboard &gt; DNS and take note of your nameservers.<br /><br /><img src="https://chaidarun.com/img/cloudflare-nameservers.png" alt="" /></li>
  <li>Go back to your Namecheap account &gt; <a href="https://ap.www.namecheap.com/domains/list/">Domain List</a> &gt; Manage &gt; Nameservers &gt; Custom DNS and enter in those nameserver values.
    <ul>
      <li><a href="https://en.wikipedia.org/wiki/Domain_Name_System">DNS</a> is like the internet’s phonebook system. DNS <em>records</em> are pieces of metadata associated with a given domain name, similar to how a phonebook associates your phone number and home address with your full name. By pointing your domain to Cloudflare’s nameservers, you tell the entire internet to consult Cloudflare as the keeper of your domain’s metadata.<br /><br /><img src="https://chaidarun.com/img/namecheap-nameservers.png" alt="" /></li>
    </ul>
  </li>
  <li>Go back to your Cloudflare site dashboard &gt; Email and enable email routing.
    <ul>
      <li>This is the point at which you actually choose your new custom address, e.g. <code class="language-plaintext highlighter-rouge">firstname@lastname.com</code><br /><br /><img src="https://chaidarun.com/img/cloudflare-routing.png" alt="" /></li>
      <li>Routing solves the easy half of the email equation: <em>receiving</em> email at your new address. The rest of this guide tackles <em>sending</em> email from your new address.</li>
    </ul>
  </li>
  <li>Create a free <a href="https://www.smtp2go.com/">SMTP2GO</a> account.
    <ul>
      <li>This is <a href="https://en.wikipedia.org/wiki/Simple_Mail_Transfer_Protocol">SMTP</a> as a service, similar to SendGrid and Mailgun and Mailjet and Amazon SES and many many more. Businesses normally use these services to blast out <em>transactional</em> (i.e. marketing) emails, but they also handle personal email perfectly fine. It makes little difference which SMTP service you choose—I went with SMTP2GO as <a href="https://www.reddit.com/r/selfhosted/comments/wt88z6/what_is_the_best_free_smtp_solution_to_use_with/">recommended</a> on Hacker News and Reddit.</li>
      <li>You don’t really need to know anything about SMTP servers beyond the fact that you need one in order to send email.</li>
    </ul>
  </li>
  <li>At SMTP2GO &gt; Settings &gt; Verified Senders, add your domain as a sender domain. Take note of its CNAME records.<br /><br /><img src="https://chaidarun.com/img/smtp2go-senders.png" alt="" /></li>
  <li>Go to your Cloudflare site dashboard &gt; DNS and add those CNAME records.<br /><br /><img src="https://chaidarun.com/img/smtp.png" alt="" /></li>
  <li>Go to SMTP2GO &gt; Settings &gt; SMTP Users and “Add SMTP user” with default settings. Take note of the connection details.<br /><br /><img src="https://chaidarun.com/img/smtp2go-users.png" alt="" /></li>
  <li>Go to Gmail &gt; gear icon &gt; Settings &gt; Accounts and Import &gt; Send mail as &gt; Add another email address, uncheck “Treat as an alias”, and enter the connection details from the previous step.
    <ul>
      <li>Some other guides online will tell you to use Gmail’s own <code class="language-plaintext highlighter-rouge">smtp.gmail.com</code> here, which mostly works and is slightly easier than setting up SMTP2GO. The problem there is that Gmail’s SMTP server won’t sign outgoing mail from your new address with <a href="https://en.wikipedia.org/wiki/DomainKeys_Identified_Mail">DKIM</a>, increasing the likelihood that your messages will get marked as spam. Services like SMTP2GO do handle DKIM, <a href="https://en.wikipedia.org/wiki/Sender_Policy_Framework">SPF</a>, etc.<br /><br /><img src="https://chaidarun.com/img/gmail-smtp.png" alt="" /></li>
    </ul>
  </li>
  <li>Add your new email address to your Google account as an <a href="https://myaccount.google.com/email">alternate email</a>.
    <ul>
      <li>Profile pictures are a Gmail thing, not an email thing. Gmail users will find it sketchy if you send them a faceless email from your new address, so how do you tell Google what picture to show them? Setting your new address as an alternate email in your Google account will cause Gmail recipients to see your Google photo even when you email them from your non-Gmail address.<br /><br /><img src="https://chaidarun.com/img/google-alternate-email.png" alt="" /></li>
    </ul>
  </li>
  <li>Verify reliable deliverability with tools like <a href="https://www.mail-tester.com/">Mail Tester</a> and <a href="https://www.learndmarc.com/">Learn DMARC</a>.<br /><br /><img src="https://chaidarun.com/img/mail-tester.png" alt="" /><br /><img src="https://chaidarun.com/img/learndmarc.png" alt="" /></li>
</ol>

<p>Congrats, you did it! Now to explain some decisions above in more detail…</p>

<h2 id="why-you-need-a-custom-email-domain">Why you need a custom email domain</h2>

<p>Email is just one of many ways to communicate online, while your email <em>address</em> is your entire online identity. If you accidentally delete all your email messages, that’s a bummer but not too bad. If you ever lose control of your email address, which is tied to your accounts on dozens (if not hundreds) of other websites, that’s catastrophic.</p>

<p>In the worst case, someone takes over your Gmail and now has access to your other online accounts via password reset. In a hopefully more likely scenario, you might simply want to change email providers without needing to also update all your online accounts and human contacts. Gmail is popular today, but remember Hotmail and Yahoo Mail?</p>

<p>By decoupling your email address from your email provider, you retain ownership of your own identity.</p>

<h2 id="why-you-should-still-use-gmail">Why you should still use Gmail</h2>

<p>Once you fully own your email address, the choice of email provider becomes less important. Gmail is still perfectly fine for the actual handling of email—it filters spam with surgical precision, it tends to have better features than competitors, and it costs $0.</p>

<p>Privacy-conscious people might balk at giving their emails to the world’s largest advertising company, who also happens to be a world leader in artificial intelligence. That’s a reasonable take, but a few counterpoints worth considering:</p>

<ul>
  <li>Google <a href="https://mako.cc/copyrighteous/google-has-most-of-my-email-because-it-has-all-of-yours">already has access</a> to all of your email communications with Gmail users</li>
  <li>Google has likely <a href="https://techcrunch.com/2017/06/23/google-has-all-the-data-it-needs-will-stop-scanning-gmail-inboxes/">become so good</a> at ad targeting that they don’t even need to read your emails anymore</li>
  <li>Gmail-to-Gmail messaging is arguably <em>more</em> secure than, say, Fastmail-to-Gmail since the data never leaves Google servers to travel across the open internet</li>
  <li>Email is <a href="https://security.stackexchange.com/a/30094">fundamentally insecure</a> anyway</li>
</ul>

<h2 id="why-you-shouldnt-worry-about-email-privacy">Why you shouldn’t worry about email privacy</h2>

<p>Generally speaking, it’s a lost cause. Email was invented over half a century ago without any thought given to privacy or security—it’s the digital equivalent of <a href="https://www.ias.edu/security/would-you-send-postcard-mail">postcards</a>. Would you write your credit card info on a postcard, visible to your landlord and your nosy neighbors and who knows how many random postal workers? This is why your bank never emails you sensitive information. Instead, banks go to the trouble of building email-like communication channels on their own websites for customers.</p>

<p>If you <em>really</em> need email privacy because you’re a whistleblower or journalist then there’s <a href="https://www.maketecheasier.com/pgp-encryption-how-it-works/">PGP</a>, but that’s hardly the normal use case for email. Extremely few people know how insecure email is, let alone care about it, let alone are willing to jump through user-unfriendly hoops like PGP or ProtonMail, let alone talk to people who also choose to jump those same hoops.</p>

<p>For the vast majority of ordinary people who just want their private messages with friends and family to actually be private, chat apps like <a href="https://signal.org/en/">Signal</a> easily beat email. If Signal itself is too hard a sell (fair enough), WhatsApp and Google Messages are more popular alternatives that use the same end-to-end <a href="https://en.wikipedia.org/wiki/Signal_Protocol">encryption technology</a> created by Signal.</p>

<hr />

<p>References:</p>

<ul>
  <li><a href="https://clr.is/articles/custom_email/">https://clr.is/articles/custom_email/</a></li>
  <li><a href="https://news.ycombinator.com/item?id=30443399">https://news.ycombinator.com/item?id=30443399</a></li>
  <li><a href="https://jay.gooby.org/2022/05/06/use-a-basic-gmail-account-to-send-mail-as-with-a-domain-that-uses-cloudflare-email-routing">https://jay.gooby.org/2022/05/06/use-a-basic-gmail-account-to-send-mail-as-with-a-domain-that-uses-cloudflare-email-routing</a></li>
  <li><a href="https://sales.rocks/blog/set-up-profile-picture-in-gmail-from-different-domains/">https://sales.rocks/blog/set-up-profile-picture-in-gmail-from-different-domains/</a></li>
  <li><a href="https://piszek.com/2022/01/23/gmail-custom-domain-free/">https://piszek.com/2022/01/23/gmail-custom-domain-free/</a></li>
  <li><a href="https://sneak.berlin/20201029/stop-emailing-like-a-rube/">https://sneak.berlin/20201029/stop-emailing-like-a-rube/</a></li>
</ul>
<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:fawm">
      <p>I have a friend who snagged <code class="language-plaintext highlighter-rouge">fawm.org</code> for <a href="https://fiftyninety.fawm.org/">his website</a>, only to then spend several years battling a domain squatter for control of <code class="language-plaintext highlighter-rouge">fawm.com</code>. In the meantime, the latter domain housed a hardcore porn website. <a href="https://chaidarun.com/custom-email-domain-with-gmail#fnref:fawm" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>
]]></description>
      </item>
      
    
      
      <item>
        <title>Apps I Use</title>
        <link>https://chaidarun.com/apps-i-use</link>
        <pubDate>Sat, 31 Dec 2022 00:00:00 GMT</pubDate>
        <guid isPermaLink="true">https://chaidarun.com/apps-i-use</guid>
        
        <description><![CDATA[<p>Here’s a gratuitously detailed rundown of some of my software choices. I tend to prioritize efficiency and flexibility over aesthetics and ease of use out of the box. My <a href="https://github.com/artnc/dotfiles">dotfiles repo</a> contains text-based config files for these apps.</p>

<!-- duo toc src/blog/_posts/2022-12-31-apps-i-use.md | tr '\n' , | sed 's/,-/,/g' | xc -->

<ul>
  <li>
    <p>General: <a href="https://chaidarun.com/apps-i-use#android">Android</a>, <a href="https://chaidarun.com/apps-i-use#chronofile">Chronofile</a>, <a href="https://chaidarun.com/apps-i-use#duolingo">Duolingo</a>, <a href="https://chaidarun.com/apps-i-use#firefox">Firefox</a>, <a href="https://chaidarun.com/apps-i-use#fitnotes">FitNotes</a>, <a href="https://chaidarun.com/apps-i-use#freetaxusa">FreeTaxUSA</a>, <a href="https://chaidarun.com/apps-i-use#google-fi">Google Fi</a>, <a href="https://chaidarun.com/apps-i-use#google-keep">Google Keep</a>, <a href="https://chaidarun.com/apps-i-use#google-tasks">Google Tasks</a>, <a href="https://chaidarun.com/apps-i-use#inoreader">Inoreader</a>, <a href="https://chaidarun.com/apps-i-use#keepassxc">KeePassXC</a>, <a href="https://chaidarun.com/apps-i-use#linux">Linux</a>, <a href="https://chaidarun.com/apps-i-use#meteogram">Meteogram</a>, <a href="https://chaidarun.com/apps-i-use#mobilesheets">MobileSheets</a>, <a href="https://chaidarun.com/apps-i-use#monarch">Monarch</a>, <a href="https://chaidarun.com/apps-i-use#mpv">mpv</a>, <a href="https://chaidarun.com/apps-i-use#mullvad">Mullvad</a>, <a href="https://chaidarun.com/apps-i-use#musescore">MuseScore</a>, <a href="https://chaidarun.com/apps-i-use#overleaf">Overleaf</a>, <a href="https://chaidarun.com/apps-i-use#rclone">rclone</a>, <a href="https://chaidarun.com/apps-i-use#reaper">Reaper</a>, <a href="https://chaidarun.com/apps-i-use#signal">Signal</a>, <a href="https://chaidarun.com/apps-i-use#syncthing">Syncthing</a></p>
  </li>
  <li>
    <p>Coding: <a href="https://chaidarun.com/apps-i-use#alacritty">Alacritty</a>, <a href="https://chaidarun.com/apps-i-use#cursor">Cursor</a>, <a href="https://chaidarun.com/apps-i-use#dejavu-sans-mono">DejaVu Sans Mono</a>, <a href="https://chaidarun.com/apps-i-use#digitalocean">DigitalOcean</a>, <a href="https://chaidarun.com/apps-i-use#fzf">fzf</a>, <a href="https://chaidarun.com/apps-i-use#isso">Isso</a>, <a href="https://chaidarun.com/apps-i-use#jekyll">Jekyll</a>, <a href="https://chaidarun.com/apps-i-use#nano">nano</a>, <a href="https://chaidarun.com/apps-i-use#ripgrep">ripgrep</a>, <a href="https://chaidarun.com/apps-i-use#tmux">tmux</a>, <a href="https://chaidarun.com/apps-i-use#zsh">zsh</a></p>
  </li>
  <li>
    <p>Linux: <a href="https://chaidarun.com/apps-i-use#arch-linux">Arch Linux</a>, <a href="https://chaidarun.com/apps-i-use#clipman">clipman</a>, <a href="https://chaidarun.com/apps-i-use#easystroke">Easystroke</a>, <a href="https://chaidarun.com/apps-i-use#i3">i3</a>, <a href="https://chaidarun.com/apps-i-use#xbindkeys">xbindkeys</a>, <a href="https://chaidarun.com/apps-i-use#xfce4-goodies">XFCE4 goodies</a>, <a href="https://chaidarun.com/apps-i-use#yay">Yay</a></p>
  </li>
  <li>
    <p>macOS: <a href="https://chaidarun.com/apps-i-use#aerospace">AeroSpace</a>, <a href="https://chaidarun.com/apps-i-use#autoraise">AutoRaise</a>, <a href="https://chaidarun.com/apps-i-use#hammerspoon">Hammerspoon</a>, <a href="https://chaidarun.com/apps-i-use#maccy">Maccy</a></p>
  </li>
</ul>

<hr />

<h2 id="android">Android</h2>

<p><em>Mobile OS. Alternatives I’ve tried: iOS, Windows Phone, CyanogenMod</em></p>

<p>I prefer more control over my phone than iOS offers: I can freely customize Android’s home screen, sideload apps, pick and choose hardware specs, charge with any old USB-C cable instead of Apple’s not-even-included Lightning cable, easily develop and share my <a href="https://github.com/artnc/chronofile">own</a> <a href="https://github.com/artnc/kasa-widget-android">apps</a>, automate nearly anything with Tasker, and so on. I don’t mind appearing as a green texter in a chat app that I don’t use :)</p>

<h2 id="chronofile">Chronofile</h2>

<p><em>Personal analytics, a.k.a. <a href="https://en.wikipedia.org/wiki/Lifelog">lifelogging</a>, a.k.a. <a href="https://en.wikipedia.org/wiki/Quantified_self">quantified self</a>. Alternatives I’ve tried: spreadsheets</em></p>

<p>I’ve been continuously recording my daily activities by hand since I was 17, amounting to ~100,000 activities over the past 11 years. Most of it has taken place in an <a href="https://github.com/artnc/chronofile">app</a> that I built for myself. I described the process and data in a <a href="https://chaidarun.com/ten-years-of-logging-my-life">blog post</a> that generated a lively <a href="https://news.ycombinator.com/item?id=29692087">discussion</a> on Hacker News and got <a href="https://buzzorange.com/techorange/2021/12/29/track-data-software-engineer/">picked up</a> by Taiwanese media (lol?)</p>

<p><img src="https://chaidarun.com/img/chronofile-screens.png" alt="" /></p>

<h2 id="duolingo">Duolingo</h2>

<p><em>Language learning. Alternatives I’ve tried: Anki, Memrise, LingoDeer, Drops, Tandem, HelloTalk, Cake, ELSA Speak, textbooks</em></p>

<p>Full disclosure: I work at <a href="https://www.duolingo.com/">Duolingo</a>. But that’s because I was already a <a href="https://chaidarun.com/duolingo">power user</a>, not the other way around.</p>

<p>As a casual language learner, Duolingo’s gamification features had me hooked immediately. By now I’ve made significant progress through around a dozen courses, completing seven of them. Although language proficiency does fade quickly without ongoing practice, I was fairly decent at the time of finishing each course: not fully conversational and definitely not fluent, but equivalent after only a few dozen hours on Duolingo to having taken two or three years of high school instruction. The vocab that I do still remember comes in handy surprisingly often when I recognize the meanings of infrequent musical directives like <em>pesante</em>, brand names like <em>Fjällräven</em>, Spanish chatter at pickup volleyball, and even <a href="https://esperanto.stackexchange.com/questions/3264/what-motivated-the-choice-of-esperanto-in-the-saga-comic">alien dialogue</a> in science fiction.</p>

<p>To reach fluency, there’s no substitute for talking with humans. <a href="https://www.tandem.net/">Tandem</a> worked pretty well for me as a way to find someone with whom to practice conversational Thai offline, but within the app itself I’d say the best feature is its specialized UI for gracefully correcting any mistakes in your partner’s chat messages. Nowadays I mostly stick to Duolingo and use my phone keyboard’s voice typing feature to practice speaking. Google’s unforgivingly (and unintentionally?) strict speech recognizer serves as my pronunciation guide.</p>

<p><img src="https://chaidarun.com/img/duolingo-yir.png" alt="" /></p>

<h2 id="firefox">Firefox</h2>

<p><em>Web browser. Alternatives I’ve tried: Chrome, Chromium, Edge, Opera</em></p>

<p>After falling behind Chrome in performance and features for many years, Firefox finally <a href="https://www.nytimes.com/2018/06/20/technology/personaltech/firefox-chrome-browser-privacy.html">caught up</a>. It continues to support privacy and ad blocking features in a way that no browser created by an online advertising company will ever match. I still use Google products that blow away the competition, but this is one place where it’s easy to avoid putting more eggs than necessary in the Google basket.</p>

<p>Browser extensions that I use include Dark Reader, Disconnect, I still don’t care about cookies, KeePassXC-Browser, Privacy Badger, Refined GitHub, Stylus, and uBlock Origin.</p>

<h2 id="fitnotes">FitNotes</h2>

<p><em>Workout tracker. Alternatives I’ve tried: Fitocracy, Strong, MyFitnessPal, spreadsheets</em></p>

<p>Way back in 2013 when <a href="https://en.wikipedia.org/wiki/Apache_Cordova">PhoneGap</a> reached peak hype, I went about learning it by developing my own workout tracking app… until I found <a href="https://www.fitnotesapp.com/">FitNotes</a>, which was the exact app I planned to build. No frills, streamlined UI, and full ownership of the data.</p>

<p>I find it comforting that FitNotes is also developed independently by just a guy like me, which is about the scope that feels appropriate for something as simple as a workout tracker. No worries that big fitness will aggressively try to monetize and engage me.</p>

<h2 id="freetaxusa">FreeTaxUSA</h2>

<p><em>Tax preparer. Alternatives I’ve tried: TurboTax, TaxAct, Credit Karma, a human CPA</em></p>

<p>Despite the extremely scammy-sounding name (which they’ve apparently tried to address by offering exactly the same product under the alternate name <a href="https://www.taxhawk.com/">TaxHawk</a>), <a href="https://www.freetaxusa.com/">FreeTaxUSA</a> is easily the most wholesome tax software that I’ve ever used—no surprise fees, shady upselling, or <a href="https://www.propublica.org/article/inside-turbotax-20-year-fight-to-stop-americans-from-filing-their-taxes-for-free">parasitic lobbying</a>. You know they’re legit because the IRS website lists them as a <a href="https://apps.irs.gov/app/freeFile/browse-all-offers/">trusted partner</a>.</p>

<p>FreeTaxUSA does come with a small fee for filing state taxes, but I find it totally worth the lack of sleaze. It almost feels like a charitable donation in comparison to feeding the TurboTax monster.</p>

<h2 id="google-fi">Google Fi</h2>

<p><em>Wireless carrier. Alternatives I’ve tried: T-Mobile, Verizon</em></p>

<p>My Fi family plan gets me unlimited calls, texts, and data for $24/mo after taxes and fees. I don’t travel enough internationally that it makes sense anymore, but previously I used their flexible plan for $20/mo plus $10/GB for mobile data that works practically anywhere in the world.</p>

<p>Although Fi was initially available by invitation only for a handful of phone models, they now <a href="https://fi.google.com/compatibility">support</a> iPhones and many Android devices. If you decide to make the switch, you can save us both $20 by using this <a href="https://g.co/fi/r/A2D70F">referral link</a> or code: <code class="language-plaintext highlighter-rouge">A2D70F</code></p>

<h2 id="google-keep">Google Keep</h2>

<p><em>Notes. Alternatives I’ve tried: Evernote, OneNote, Notion, text files</em></p>

<p>As with FitNotes and Google Tasks, it’s a relief that <a href="https://play.google.com/store/apps/details?id=com.google.android.keep">Google Keep</a>’s product decisions don’t suffer from the business pressure of being an entire company’s sole source of income. It’s just a dead simple note-taking app that syncs between my laptop and phone, which is all I want or need.</p>

<h2 id="google-tasks">Google Tasks</h2>

<p><em>Todo list. Alternatives I’ve tried: Remember the Milk, text files, physical planner</em></p>

<p>After languishing for years in a state of limbo and dubious recommendability, <a href="https://play.google.com/store/apps/details?id=com.google.android.apps.tasks">Google Tasks</a> finally implemented the last feature on my wishlist: an Android widget to show upcoming tasks. Or maybe I should say <em>second</em> feature because the only other feature that I want out of a todo app is seamless integration with Google Calendar. The use cases for todo lists and calendars are so intertwined that I can’t imagine managing them nearly as effectively in two separate places.</p>

<p><img src="https://chaidarun.com/img/tasks.png" alt="" /></p>

<h2 id="inoreader">Inoreader</h2>

<p><em>RSS reader. Alternatives I’ve tried: Google Reader, Feedly, Tiny Tiny RSS, NewsBlur</em></p>

<p>Like many people, I migrated to Feedly upon Google Reader’s untimely demise. Feedly’s extravagant use of screen space and lack of customizability bothered me, so I then <a href="https://chaidarun.com/ttrss-heroku">ran my own TTRSS server</a> for several years until I got tired of having to regularly upgrade and troubleshoot it myself.</p>

<p><a href="https://www.inoreader.com/">Inoreader</a> feels closest to the spirit of Google Reader. After trying their free version with an ad blocker for a while, I happily upgraded to their $20/yr ad free plan.</p>

<p><img src="https://chaidarun.com/img/inoreader.png" alt="" /></p>

<h2 id="keepassxc">KeePassXC</h2>

<p><em>Password manager. Alternatives I’ve tried: LastPass, 1Password, KeePass, KeePassX</em></p>

<p>A security incident with some cloud-based password manager or another seems to <a href="https://www.theverge.com/2022/12/28/23529547/lastpass-vault-breach-disclosure-encryption-cybersecurity-rebuttal">make the news</a> every other month. The most popular totally offline, totally <abbr title="free and open-source software">FOSS</abbr> option is KeePass and its forks. <a href="https://keepassxc.org/">KeePassXC</a> is a modern fork <a href="https://ssd.eff.org/module/creating-strong-passwords">recommended</a> by the EFF. All passwords live in a single file that I sync across my devices via <a href="https://chaidarun.com/apps-i-use#syncthing">Syncthing</a>.</p>

<h2 id="linux">Linux</h2>

<p><em>Desktop OS. Alternatives I’ve tried: Windows 95 - Windows 10, macOS Mavericks - Sequoia</em></p>

<p>Compared to Windows and/or Mac, <a href="https://en.wikipedia.org/wiki/Linux">Linux</a>’s strengths include hassle-free package management, the ability to customize or switch out any part of the OS (e.g. to avoid shenanigans like <a href="https://www.ghacks.net/2022/11/21/microsoft-is-turning-windows-11s-start-menu-into-an-advertisement-delivery-system/">start menu ads</a>), being a smaller target for consumer malware, generally better performance and reliability on the same hardware, native support for industry standard programming tools like Docker, no data harvesting, and of course the $0 price tag. After years of troubleshooting my mom’s Windows machines, I set up <a href="https://linuxmint.com/">Linux Mint</a> for her and have gotten zero complaints in the decade since.</p>

<p>Linux’s weaknesses include the typical need to install it yourself and less support for proprietary software such as AAA games and professional creative tools. Depending on which Linux distro (variant) you choose, support for peripherals such as printers and cameras may also take some legwork.</p>

<blockquote>
  <p><span class="badge" title="2023-05-16">Update</span> I’m currently using macOS again at <a href="https://chaidarun.com/projects#duolingo">work</a> since Apple requires it for iOS development. I’ve managed to recreate my Linux setup well enough on macOS that it’s no longer super jarring to switch between the two.</p>
</blockquote>

<p><img src="https://chaidarun.com/img/software-update.jpg" alt="" /></p>

<h2 id="meteogram">Meteogram</h2>

<p><em>Weather app. Alternatives I’ve tried: Aix Weather Widget, Google Weather</em></p>

<p>In a vast ocean of Android weather apps, <a href="https://www.wirefresh.com/aix-weather-widget-our-new-favourite-android-widget/">Aix Weather Widget</a> was the perfect one for me until Android 11 finally <a href="https://github.com/pveierland/aix-weather-widget/issues/18">broke</a> it in 2020. Some time later, I asked my friend about the staggeringly detailed weather widget that I couldn’t help but notice taking up half their home screen. I was pleasantly surprised to discover that not only does <a href="https://play.google.com/store/apps/details?id=com.cloud3squared.meteogram">Meteogram</a> give you full control over every last aspect of its display, but it even comes with a minimalist “Aix lookalike” preset!</p>

<p><img src="https://chaidarun.com/img/meteogram.png" alt="" /></p>

<h2 id="mobilesheets">MobileSheets</h2>

<p><em>Sheet music display. Alternatives I’ve tried: PDF viewers, paper</em></p>

<p>PDF viewers work okay for sheet music but come with a bunch of annoyances, chief among them the problem of page turning. I once hacked up my own solution using <a href="https://chaidarun.com/page-turner">face recognition</a> via my Linux laptop’s webcam, but that’s hardly a normal setting for musical performance.</p>

<p><img src="https://chaidarun.com/img/page-turner.jpg" alt="" /></p>

<p>Dedicated apps like <a href="https://www.zubersoft.com/mobilesheets/">MobileSheets</a> provide helpful features like half-page turns, Bluetooth integration with page turning devices, custom setlists, and automatic whitespace cropping. MobileSheets is available for both Android and iOS, although <a href="https://forscore.co/">forScore</a> seems more popular on iOS.</p>

<h2 id="monarch">Monarch</h2>

<p><em>Personal finance tracking. Alternatives I’ve tried: Mint, Credit Karma, Empower / Personal Capital, Firefly III, spreadsheets</em></p>

<p>Every RPG out there has some kind of dashboard for checking your character’s stats. <a href="https://mint.intuit.com/">Mint</a> provides a similar overview of your financial life. Its Android widgets let me easily monitor all of my accounts’ current balances and recent transactions. I’d prefer an equally convenient alternative that isn’t now owned by Intuit though, so maybe I’ll give <a href="https://www.personalcapital.com/">Personal Capital</a> a spin sometime.</p>

<blockquote>
  <p><span class="badge" title="2024-09-18">Update</span> Now that Intuit has shut down Mint, I’ve switched to <a href="https://www.monarchmoney.com/referral/u8n53iwq4k?r_source=copy">Monarch</a>. It comes from the original developers of Mint and feels much the same.</p>
</blockquote>

<h2 id="mpv">mpv</h2>

<p><em>Media player. Alternatives I’ve tried: VLC, RealPlayer</em></p>

<p><a href="https://en.wikipedia.org/wiki/VLC_media_player">VLC</a> is the best-known media player that can handle any audio or video file you throw at it. <a href="https://en.wikipedia.org/wiki/Mpv_(media_player)">mpv</a> is a similar (both are based on <a href="https://en.wikipedia.org/wiki/FFmpeg">FFmpeg</a>) <abbr title="command-line interface">CLI</abbr> program that supposedly offers slightly better defaults, performance, and file support. If I hadn’t already been looking for a CLI media player, I’d probably just stick to VLC.</p>

<h2 id="mullvad">Mullvad</h2>

<p><em>VPN</em></p>

<p>I’m not really the most privacy-conscious person in the world, and I <a href="https://www.vice.com/en/article/xgxnwk/you-probably-dont-need-a-vpn">don’t</a> go around evangelizing VPNs. I just happen to spend more time than most people on public WiFi networks that mess with traffic, e.g. <a href="https://www.reddit.com/r/InoReader/comments/o6lv7g/why_doesnt_inoreader_work_on_this_one_particular/?utm_source=share&amp;utm_medium=web2x&amp;context=3">breaking my RSS reader</a> for some reason. <a href="https://mullvad.net/en/">Mullvad</a> doesn’t spend as much on marketing as NordVPN or ExpressVPN, but it’s the only commercial option that I’ve personally heard security engineers recommend. Mozilla’s own VPN offering is basically just <a href="https://arstechnica.com/gadgets/2020/07/we-test-mozillas-new-wireguard-based-5-mo-vpn-service/">rebranded</a> Mullvad.</p>

<h2 id="musescore">MuseScore</h2>

<p><em>Music notation. Alternatives I’ve tried: Sibelius, Frescobaldi, LilyPond, TuxGuitar, Guitar Pro</em></p>

<p>I wrote a few scores in Sibelius as a teenager and it blew MuseScore out of the water back then. Now that the original Sibelius development team has moved to Steinberg, I’d guess that <a href="https://www.steinberg.net/dorico/se/">Dorico SE</a> is an excellent free option for getting started today.</p>

<p>That said, <a href="https://musescore.org/en">MuseScore</a> has improved a ton and I’ve seen some of my music teachers using it. It’s more than sufficient for <a href="https://chaidarun.com/musescore-tab">my guitar tabbing</a> and occasional piano scoring purposes. I’ve only ever tried my hand at a multi-instrument score once, but well… that’s one more time than trialware like Dorico SE would allow.</p>

<p><img src="https://chaidarun.com/img/musescore.png" alt="" /></p>

<h2 id="overleaf">Overleaf</h2>

<p><em>Typesetting. Alternatives I’ve tried: TeX Live, Microsoft Word</em></p>

<p>I learned <a href="https://en.wikipedia.org/wiki/LaTeX">LaTeX</a> to make my high school resume prettier, wrote all of my college assignments in LaTeX for fun, and recently chose to use <a href="https://hub.docker.com/r/blang/latex">dockerized LaTeX</a> for a project at my day job. Clearly I don’t hate LaTeX, but just getting it to run has always been a pain. Installations take up gigabytes of disk space, the tooling ecosystem is extremely fragmented, and good luck with basic tasks like changing the font. For the occasional resume tweak or formula render, an online editor like <a href="https://www.overleaf.com/">Overleaf</a> will spit out a PDF with minimal hassle.</p>

<h2 id="rclone">rclone</h2>

<p><em>File backup. Alternatives I’ve tried: Carbonite, SugarSync, external HDD, crossed fingers</em></p>

<p>I use <a href="https://chaidarun.com/apps-i-use#syncthing">Syncthing</a> to sync files across my devices and a <a href="https://github.com/artnc/dotfiles">public GitHub repo</a> to house my program settings. By “backup”, I’m referring to the act of shipping my old photos and documents off to some remote datacenter where they’ll survive any disaster that may befall my laptop.</p>

<p><a href="https://rclone.org/">Rclone</a> lets you easily sync your local files to pretty much any cloud storage provider. As easily as <a href="https://en.wikipedia.org/wiki/Rsync">rsync</a>, that is—both are CLIs after all. Rclone’s <a href="https://rclone.org/crypt/">encryption</a> at rest means that I don’t have to worry about the cloud provider snooping on my files or losing them in a data breach.</p>

<h2 id="reaper">Reaper</h2>

<p><em>Digital audio workstation (DAW)</em></p>

<p>Yes, this one is mostly about the money. <a href="https://www.reaper.fm/">Reaper</a> is effectively donationware for which I happily shelled out $60 after a few mixing projects. Logic Pro and every other <abbr title="digital audio workstation">DAW</abbr> worth mentioning all cost hundreds of dollars, which is more than I’d like to spend on a chore that’s only tangentially related to my actual hobby of playing music. Reaper’s <a href="https://en.wikipedia.org/wiki/Blender_(software)">blenderesque</a> UI takes some getting used to but ends up feeling reasonably efficient once you’re comfortable with it.</p>

<p><img src="https://chaidarun.com/img/reaper.png" alt="" /></p>

<h2 id="signal">Signal</h2>

<p><em>Instant messaging. Alternatives I’ve tried: Messenger, WhatsApp, LINE, etc. etc. etc.</em></p>

<p>I’m not enough of an ideologue to forgo Messenger, WhatsApp, or whatever else my friends and family already use, but if we both happen to have <a href="https://signal.org/en/">Signal</a> then that’s the chat app of choice. Signal’s security measures <a href="https://signal.org/bigbrother/santaclara/">survive subpoenas</a> while other apps get in PR trouble for unexpectedly <a href="https://www.wired.com/story/whatsapp-facebook-data-share-notification/">sharing your data</a>. As a bonus of being open source, Signal is also the only popular chat app that would ever let me dive into its code and <a href="https://github.com/signalapp/Signal-Android/commit/49a1a4a123e82d86ee3963b5d577cf9d33bd10e8">fix a bug</a> myself!</p>

<h2 id="syncthing">Syncthing</h2>

<p><em>File sync across devices. Alternatives I’ve tried: Dropbox, SugarSync, OneDrive</em></p>

<p><a href="https://syncthing.net/">Syncthing</a> is self-hosted Dropbox. Five years after my <a href="https://chaidarun.com/dropbox-syncthing">blog post</a> about why and how I made the switch, Syncthing still works well for me and gets recommended often in Hacker News comments.</p>

<hr />

<p><span id="coding"></span></p>

<h2 id="alacritty">Alacritty</h2>

<p><em>Terminal emulator. Alternatives I’ve tried: xterm, xfce4-terminal, urxvt, Tilda, Terminal, iTerm2</em></p>

<p><a href="https://alacritty.org/">Alacritty</a> made a splashy entrance a few years ago with bold claims of trouncing every other terminal’s performance now and forever. I haven’t used any alternatives recently enough to remember how much slower their rendering felt, but I appreciate Alacritty’s philosophy at least as much as its results. I already use <a href="https://chaidarun.com/apps-i-use#tmux">tmux</a> for features like panels and scrolling, which leaves text rendering as the <a href="https://en.wikipedia.org/wiki/Unix_philosophy#Do_One_Thing_and_Do_It_Well">one thing</a> for my terminal to do well.</p>

<h2 id="cursor">Cursor</h2>

<p><em>GUI code editor. Alternatives I’ve tried: Sublime Text, Visual Studio Code, Notepad++, various JetBrains IDEs, Eclipse, Visual Studio, etc. etc.</em></p>

<p>I use Android Studio for Android development because Google more or less forces you to. Whenever I have more of a choice, I avoid IDEs since they’re so slow and complex, crammed with tons of features that are unreliable and/or unnecessary for me. Even VS Code is too bloated out of the box for my taste despite my championing of GitHub Codespaces <a href="https://blog.duolingo.com/developer-onboarding-with-github-codespaces/">at my job</a>.</p>

<p>I’ve spent at least 100 hours using each of the alternatives listed above, and <a href="https://www.sublimetext.com/">Sublime Text</a> remains my favorite for its speed and simplicity. The only action that causes any perceivable lag is opening a file that weighs several megabytes or even gigabytes, a task that other editors handle worse (if at all). Instead of trying to pare beefier IDEs down to just what I want, I install a few Sublime <a href="https://github.com/artnc/dotfiles/blob/9daf0a602ddde8189bed28e1962109cfbe7f310c/sublime/Package%20Control.sublime-settings#L8-L17">plugins</a> that add helpful IDE features like symbol renaming and type inference hints.</p>

<blockquote>
  <p><span class="badge" title="2025-05-12">Update</span> I now primarily use <a href="https://www.cursor.com/">Cursor</a>, an AI-powered editor based on VS Code that I’ve <a href="https://github.com/artnc/dotfiles/tree/master/code">customized</a> to look and feel like Sublime Text as much as possible. It’s still annoying that basic actions like syntax highlighting and folder switching are noticeably laggy, but the AI assistance is a game changer that saves way too much time to pass up.</p>
</blockquote>

<h2 id="dejavu-sans-mono">DejaVu Sans Mono</h2>

<p><em>Programming font. Alternatives I’ve tried: Consolas, Inconsolata, Source Code Pro</em></p>

<p>I want my editor and terminal font to be monospaced, unambiguous when it comes to similar characters like <code class="language-plaintext highlighter-rouge">1</code> / <code class="language-plaintext highlighter-rouge">l</code> / <code class="language-plaintext highlighter-rouge">I</code>, legible at small sizes, available everywhere, and as plain or “normal” looking as possible—in that order. <a href="https://www.fontsquirrel.com/fonts/dejavu-sans-mono">DejaVu Sans Mono</a> does a pretty good job ticking those boxes. For many years, it was the default monospaced font on both MacOS and Fedora Linux.</p>

<p>Maybe I just haven’t spent enough time with them to reach enlightment, but I find ligature-heavy fonts like Fira Code impractically cute. Whenever I see something like <code class="language-plaintext highlighter-rouge">≉</code> in my editor, I’d rather not need to also remember that <code class="language-plaintext highlighter-rouge">!~</code> is the “source code” for the source code itself.</p>

<h2 id="digitalocean">DigitalOcean</h2>

<p><em>Web host. Alternatives I’ve tried: AWS, Heroku, GitHub Pages, x10hosting, Raspberry Pi</em></p>

<p>I have no complaints about <a href="https://m.do.co/c/3a56d6fd2e26">DigitalOcean</a> and find their documentation in particular to be excellent, but my preference here is less about DigitalOcean specifically and more about <abbr title="virtual private server">VPS</abbr> vs. cloud vs. <abbr title="platform as a service">PaaS</abbr> vs. static HTML vs. shared hosting vs. home server. For me, the VPS route strikes the best balance between flexibility and maintainability. I can roll my own features like <a href="https://chaidarun.com/apps-i-use#isso">self-hosted blog comments</a> and custom URL redirects without spending too much time on the ops side.</p>

<h2 id="fzf">fzf</h2>

<p><em>CLI autocomplete for common programs</em></p>

<p><a href="https://github.com/junegunn/fzf">fzf</a> (“fuzzy finder”) is a general-purpose CLI tool that automatically converts long lists into searchable menus, similar to how a web browser suggests URLs as you type into its location bar. It takes over your shell’s <code class="language-plaintext highlighter-rouge">Ctrl + R</code> to present your command history in that browser-style UI, as opposed to <a href="https://en.wikipedia.org/wiki/GNU_Readline">readline</a>’s functional but tedious behavior of paging chronologically through one entry at a time. Hitting <code class="language-plaintext highlighter-rouge">Ctrl + T</code> shows similar UI for recursively searching the current directory for any given file name.</p>

<p>My third main use case for fzf is typing <code class="language-plaintext highlighter-rouge">kill **&lt;TAB&gt;</code> to get a searchable menu of killable processes without needing to worry at all about PIDs, which handily beats the old <code class="language-plaintext highlighter-rouge">ps aux</code> + <code class="language-plaintext highlighter-rouge">grep</code> + <code class="language-plaintext highlighter-rouge">kill</code> ritual:</p>

<p><img src="https://chaidarun.com/img/fzf.png" alt="" /></p>

<h2 id="isso">Isso</h2>

<p><em>Blog comments. Alternatives I’ve tried: Disqus</em></p>

<p>I previously ran Disqus on this blog but eventually got tired of the ads and slowness. <a href="https://isso-comments.de/">Isso</a> is a self-hosted commenting system and admin panel that, like <a href="https://chaidarun.com/apps-i-use#fitnotes">FitNotes</a>, does exactly what I want in a simple way that closely matches what I’d otherwise just build from scratch for myself.</p>

<h2 id="jekyll">Jekyll</h2>

<p><em>Blog CMS. Alternatives I’ve tried: Pelican, WordPress, Ghost, Drupal, Joomla, MODX</em></p>

<p><a href="https://jekyllrb.com/">Jekyll</a> popularized the idea of generating static HTML from Markdown files. I’m comfortable rsyncing the HTML to my VPS, so I don’t want or need anything more “engineered” than Jekyll. Despite <a href="https://www.theregister.com/2021/09/14/future_of_jekyll_project_engine/">murmurs</a> of its deprecation, Jekyll seems unlikely to go away or even lose its status as the most popular <abbr title="static site generator">SSG</abbr> as long as it remains GitHub’s default method for publishing to GitHub Pages.</p>

<p>My Jekyll <a href="https://github.com/artnc/personal-website#workflow">workflow</a>: start the local development server, open a <a href="https://chaidarun.com/apps-i-use#firefox">Firefox</a> window next to a <a href="https://chaidarun.com/apps-i-use#cursor">Cursor</a> window, see the output refresh itself whenever I save in Cursor, and publish by rsyncing the entire build folder to <a href="https://chaidarun.com/apps-i-use#digitalocean">DigitalOcean</a>.</p>

<h2 id="nano">nano</h2>

<p><em>CLI text editor. Alternatives I’ve tried: vi/vim/neovim, emacs</em></p>

<p>If you’re not all in on terminal editors like vim, <a href="https://en.wikipedia.org/wiki/Nano">nano</a> comes preinstalled in most Linux distros and provides a much more user-friendly <abbr title="terminal user interface">TUI</abbr> for stuff like amending Git commits. Just <a href="https://github.com/artnc/dotfiles/blob/9daf0a602ddde8189bed28e1962109cfbe7f310c/zsh/.zshrc#L266">set</a> it as your <code class="language-plaintext highlighter-rouge">$EDITOR</code> and you’ll never need to worry again about forgetting rarely used keyboard shortcuts.</p>

<p><img src="https://chaidarun.com/img/nano.png" alt="" /></p>

<p>MacOS once came with nano but now preinstalls <a href="https://en.wikipedia.org/wiki/Pico_(text_editor)">pico</a> instead, which I can only assume was due to a <a href="https://discussions.apple.com/thread/250722978">licensing situation</a> similar to Bash vs. Zsh.</p>

<h2 id="ripgrep">ripgrep</h2>

<p><em>Local code search. Alternatives I’ve tried: grep, ag</em></p>

<p><a href="https://github.com/BurntSushi/ripgrep">Ripgrep</a> is a faster drop-in replacement for <a href="https://en.wikipedia.org/wiki/Grep">grep</a>. Like other grep alternatives, it respects <code class="language-plaintext highlighter-rouge">.gitignore</code> by default. Microsoft now <a href="https://github.com/microsoft/vscode-ripgrep">uses</a> ripgrep to power VS Code’s search feature.</p>

<h2 id="tmux">tmux</h2>

<p><em>Terminal multiplexer (tab and pane manager). Alternatives I’ve tried: screen, GUI tabs</em></p>

<p>Most people who want to open multiple terminal windows use their terminal’s GUI tab feature, a familiar approach that matches web browsers’ UI. Some terminal apps get even fancier and let you split tabs horizontally or vertically into multiple panes. This all works fine until you land in an environment that doesn’t support your favored GUI terminal: a remote server you’re SSHed into, a headless local machine, or your IDE’s built-in terminal panel.</p>

<p><a href="https://en.wikipedia.org/wiki/Tmux">tmux</a> uses Unicode art to implement those windowing features all inside a single terminal itself, removing the need for GUI tabs. Other than portability, tmux’s main draw is persistence across SSH sessions. I can log into a remote server, kick off some jobs inside tmux there, log out without killing those jobs, and come back later to view those jobs running inside the same tmux session exactly as I had left it.</p>

<h2 id="zsh">Zsh</h2>

<p><em>Interactive Unix shell. Alternatives I’ve tried: Bash</em></p>

<p>For all its hype, Zsh is actually almost identical to Bash (and just one year younger!). While Zsh does offer a few advantages like spellcheck and automatic <code class="language-plaintext highlighter-rouge">cd</code>, it owes much of its relatively recent popularity to a plugin manager called <a href="https://ohmyz.sh/">Oh My Zsh</a>.</p>

<p>I don’t use Oh My Zsh anymore. Bundling the kitchen sink might be the fastest way to get a decent setup, but eventually I wanted better performance and control. Now I just declare my own <a href="https://github.com/artnc/dotfiles/blob/9daf0a602ddde8189bed28e1962109cfbe7f310c/zsh/.zshrc#L215-L255">Git aliases</a> and install <a href="https://github.com/zsh-users/zsh-syntax-highlighting">Zsh syntax highlighting</a> directly.</p>

<p>To be clear, I only use Zsh as an interactive shell. Unless you’re specifically writing a Zsh plugin, Bash and Bourne shell remain the only sane choices for non-interactive scripting due to their ubiquity.</p>

<p>There’s also <a href="https://fishshell.com/">Fish</a>, the only other Unix shell today with any voluntary adoption to speak of. While Zsh is essentially just Bash with a few extra features, the whole Fish shtick (sorry) is its <a href="https://en.wikipedia.org/wiki/Fish_(Unix_shell)#Bash/fish_translation_table">thorough departure</a> from POSIX standards. Some of Fish’s interactive features do sound tempting, but to me they don’t feel worth the mental burden of always having to remember what shell features are safe to use inside Bash scripts.</p>

<hr />

<h2 id="arch-linux">Arch Linux</h2>

<p><em>Desktop Linux distro. Alternatives I’ve tried: Fedora, Ubuntu, Mint, ChromeOS</em></p>

<p>Everything I said <a href="https://chaidarun.com/apps-i-use#linux">above</a> about Linux is even truer of the minimalist <a href="https://en.wikipedia.org/wiki/Arch_Linux">Arch Linux</a> than of other common distros. I began with <a href="https://en.wikipedia.org/wiki/Fedora_Linux">Fedora</a> in college and stuck with it through my first few years of full-time work. Eventually I became comfortable enough with Linux to try out Arch, whose <a href="https://wiki.archlinux.org/title/Arch_Linux">principles</a> align more with what I want out of software: simplicity, modernity, pragmatism, user centrality, and versatility.</p>

<p>Simple doesn’t necessarily mean easy—it’s much easier to churn out a long and rambling blog post <em>*cough*</em> than a clear and concise one. In contrast to Arch, distros like <a href="https://en.wikipedia.org/wiki/Ubuntu">Ubuntu</a> are easy but complex. Here are <a href="https://chaidarun.com/arch-notes">my notes</a> on how I’ve arrived at my current Arch setup.</p>

<h2 id="clipman">clipman</h2>

<p><em>Clipboard history.</em></p>

<p><code class="language-plaintext highlighter-rouge">Ctrl + V</code> pastes the last thing you copied, while a clipboard manager can remember and provide easy access to hundreds of things you’ve recently copied. Life-changing.</p>

<p>Xfce’s <a href="https://docs.xfce.org/panel-plugins/xfce4-clipman-plugin/start">clipman</a> introduced me to the concept. On macOS, I use <a href="https://chaidarun.com/apps-i-use#maccy">Maccy</a>.</p>

<h2 id="easystroke">Easystroke</h2>

<p><em>GUI navigation via mouse gestures</em></p>

<p><a href="https://aur.archlinux.org/packages/easystroke">Easystroke</a> translates mouse gestures into keyboard shortcuts, which programs then translate into commands like undo, refresh, next tab, etc. For example, I can draw an L-shape while holding down my mouse’s right button to send a <code class="language-plaintext highlighter-rouge">Ctrl + W</code> command that closes the active tab in programs like Firefox and Cursor. The only time I ever think about mouse gestures anymore is whenever I use someone else’s computer and realize how much I miss them!</p>

<p><img src="https://chaidarun.com/img/easystroke.png" alt="" /></p>

<h2 id="i3">i3</h2>

<p><em>Window manager. Alternatives I’ve tried: GNOME, KDE Plasma, Xfce, Unity, Cinnamon</em></p>

<p><a href="https://i3wm.org/">i3</a> is like <a href="https://chaidarun.com/apps-i-use#tmux">tmux</a> for desktop apps. If you hate wasting screen space and love keyboard shortcuts, i3 will let you manage your app windows as efficiently as possible.</p>

<p>Here’s a screenshot from my <a href="https://chaidarun.com/apps-i-use#arch-linux">Arch</a> laptop that shows <a href="https://chaidarun.com/apps-i-use#cursor">Sublime Text</a> and <a href="https://chaidarun.com/apps-i-use#alacritty">Alacritty</a> equally sharing the third of six desktops, which I can jump to via <code class="language-plaintext highlighter-rouge">CapsLock + 3</code>. I can open a new app by hitting <code class="language-plaintext highlighter-rouge">CapsLock + E</code> and typing part of its name.</p>

<p><img src="https://chaidarun.com/img/arch.png" alt="" /></p>

<p>The half-screen window snapping features introduced in Windows Vista and MacOS Catalina don’t hold a candle to i3. <a href="https://chaidarun.com/apps-i-use#aerospace">AeroSpace</a> for Mac is a solid i3 clone.</p>

<h2 id="xbindkeys">xbindkeys</h2>

<p><em>GUI automation. Alternatives I’ve tried: AutoHotkey</em></p>

<p>On Linux I use <a href="https://wiki.archlinux.org/title/Xbindkeys">xbindkeys</a> to create system-wide <a href="https://github.com/artnc/dotfiles/blob/9daf0a602ddde8189bed28e1962109cfbe7f310c/x/.xbindkeysrc#L4-L9">keyboard shortcuts</a> for common actions like typing out my email address.</p>

<p>That comes in handy several times a day but pales in comparison to the absurdly powerful <a href="https://en.wikipedia.org/wiki/AutoHotkey">AutoHotkey</a>, a programming language whose name barely scratches the surface of what it makes trivially easy even for non-programmers: keyboard automation, mouse automation, GUI automation, GUI creation, audio playback, etc. Before getting into more mainstream programming languages like Python, I first learned TI-BASIC to develop <a href="https://chaidarun.com/calculator">calculator games</a> and AutoHotkey to create my own productivity tools and RuneScape bots. Tragically, AutoHotkey is only available for Windows.</p>

<h2 id="xfce4-goodies">Xfce4 goodies</h2>

<p><em>GUI-based OS utilities. Alternatives I’ve tried: Nautilus, Ranger, Flameshot, etc. etc.</em></p>

<p>Although I haven’t run <a href="https://en.wikipedia.org/wiki/Xfce">Xfce</a> itself in many years, I still use several of its <a href="https://archlinux.org/groups/x86_64/xfce4-goodies/">components</a> alongside <a href="https://chaidarun.com/apps-i-use#i3">i3</a> since they consistently follow Xfce’s philosophy of speed and simplicity: clipboard manager <code class="language-plaintext highlighter-rouge">clipman</code>, image viewer <code class="language-plaintext highlighter-rouge">ristretto</code>, file manager <code class="language-plaintext highlighter-rouge">thunar</code> with <code class="language-plaintext highlighter-rouge">thunar-archive-plugin</code>, system tray applets <code class="language-plaintext highlighter-rouge">xfce4-battery-plugin</code> and <code class="language-plaintext highlighter-rouge">xfce4-clipman-plugin</code>, and <code class="language-plaintext highlighter-rouge">xfce4-screenshooter</code>.</p>

<h2 id="yay">Yay</h2>

<p><em>AUR helper. Alternatives I’ve tried: pacaur, yaourt, trizen</em></p>

<p><a href="https://github.com/Jguer/yay">Yay</a> is the AUR helper <em>du jour</em> and <a href="https://aur.archlinux.org/packages/pacaur">pacaur</a> has been something of a zombie since its original author left in 2018, but the latter still works fine for me. I’m sure Yay is slightly nicer and it’s what I’d recommend to new Arch users—it just doesn’t seem worth switching over my existing machines and scripts.</p>

<blockquote>
  <p><span class="badge" title="2024-09-23">Update</span> Welp, pacaur finally died on me. Now I use Yay.</p>
</blockquote>

<hr />

<h2 id="aerospace">AeroSpace</h2>

<p><em>Window tiling. Alternatives I’ve tried: yabai, Rectangle</em></p>

<p>At long last, sane window management. <a href="https://github.com/nikitabobko/AeroSpace">AeroSpace</a> solves my biggest macOS gripe by faithfully copying the design decisions of Linux’s <a href="https://chaidarun.com/apps-i-use#i3">i3</a>. Now my apps always make full use of all available screen space as soon as they open, and I can navigate between them instantaneously via keyboard shortcuts without having to wait for any annoying animations.</p>

<h2 id="autoraise">AutoRaise</h2>

<p><em>Autofocus windows on hover.</em></p>

<p><a href="https://chaidarun.com/apps-i-use#aerospace">AeroSpace</a> quite reasonably forgoes reimplementation of one useful i3 feature that’s somewhat controversial on macOS: automatically focusing (raising) windows when you hover your mouse over them.</p>

<p>Why is that controversial? Unlike Windows and Linux apps that each contain their own menu bars, all macOS apps share a single menu bar at the top of the screen. If macOS were to have the same autofocus behavior that i3 provides, then you could accidentally end up switching apps while dragging your mouse up to click on the menu bar.</p>

<p>Personally, I don’t find that a problem at all. I rely a lot on keyboard shortcuts and don’t need to click on the menu bar too often anyway. Some apps like <a href="https://chaidarun.com/apps-i-use#alacritty">Alacritty</a> don’t even have a menu bar. I use <a href="https://github.com/sbmpost/AutoRaise">AutoRaise</a> to get i3-style autofocusing on macOS.</p>

<h2 id="hammerspoon">Hammerspoon</h2>

<p><em>GUI automation. Alternatives I’ve tried: AutoHotkey</em></p>

<p><a href="https://www.hammerspoon.org/">Hammerspoon</a> lets you programmatically automate GUI actions such as moving windows around and simulating keyboard events. It’s like <a href="https://www.autohotkey.com/">AutoHotkey</a> on Windows and <a href="https://play.google.com/store/apps/details?id=net.dinglisch.android.taskerm">Tasker</a> on Android.</p>

<p>Its Lua-based APIs are powerful enough that I was able to build my own custom implementation of i3 in Hammerspoon (until I switched to <a href="https://chaidarun.com/apps-i-use#aerospace">AeroSpace</a> for that). Nowadays I mainly use Hammerspoon to create global keyboard shortcuts for automatically <a href="https://github.com/artnc/dotfiles/blob/master/hammerspoon/init.lua">typing</a> out my various email addresses.</p>

<h2 id="maccy">Maccy</h2>

<p><em>Clipboard history.</em></p>

<p>This is a no-nonsense, open-source macOS clipboard manager similar to <a href="https://chaidarun.com/apps-i-use#clipman">clipman</a>.</p>

<!-- ## MiddleClick

_. Alternatives I've tried:_

## Stats

_. Alternatives I've tried:_ -->
]]></description>
      </item>
      
    
      
      <item>
        <title>Ten Years of Logging My Life</title>
        <link>https://chaidarun.com/ten-years-of-logging-my-life</link>
        <pubDate>Sat, 25 Dec 2021 00:00:00 GMT</pubDate>
        <guid isPermaLink="true">https://chaidarun.com/ten-years-of-logging-my-life</guid>
        
        <description><![CDATA[<p>I’ve been continuously recording my daily activities by hand since I was 17, amounting to 85,000+ activities over the span of a decade.</p>

<blockquote>
  <p><span class="badge" title="2021-12-27">Update</span> See <a href="https://news.ycombinator.com/item?id=29692087">Hacker News</a> for 100+ more comments on this post.</p>
</blockquote>

<h2 id="why">Why?!</h2>

<p>Self-awareness. Am I getting enough sleep and exercise? Often I become engrossed in whatever I’m doing and forget about biological obligations like eating. My <a href="https://chaidarun.com/projects#duolingo">job</a> is cool, but have I been making enough time for other people and hobbies I care about? Balance requires constant attention.</p>

<p><a href="https://chaidarun.com/ten-years-of-logging-my-life#observations">The data</a> is also just endlessly fascinating to sift through. These pixels may not mean much to anyone else, but they tell an intensely personal story of my life’s ups and downs over the past four years:</p>

<!-- <p style="left:50%;max-width:95vw;position:relative;transform:translateX(-50%);width:calc(100% + 300px)">
<img src="https://chaidarun.com/img/chronofile-area.png" />
</p> -->

<p><img src="https://chaidarun.com/img/chronofile-area.png" alt="" /></p>

<h2 id="how-i-track-myself">How I track myself</h2>

<p>My log’s first entry is from October 16, 2011, soon after I started college. The original incarnation of the log was a massive spreadsheet in which I recorded a short summary of each day’s happenings alongside a more detailed breakdown of the total hours spent per activity. Some columns’ entries were automatically highlighted to indicate whether I reached certain daily goals, e.g. 8 hours of sleep.</p>

<p><img src="https://chaidarun.com/img/uva-xls.png" alt="" /></p>

<p>This setup worked fine for the next couple years of college, and with some minor tweaks it continued to carry me through my first four years of full-time work as well.</p>

<p>There was definitely room for improvement, though. I had to either enter activities immediately after they ended or simply try to remember them until I got back to the keyboard. By mentally rounding each activity’s duration to the nearest 15 minutes, I was able to enter data quickly but at the expense of precision. If I were to play piano for two hours, it would appear as a 2 in the spreadsheet but without any start or end time info. Tracking each activity’s geographical location was similarly infeasible.</p>

<p>The solution: developing my own Android app.</p>

<p><img src="https://chaidarun.com/img/chronofile-screens.png" alt="" /></p>

<p>I named it Chronofile, which I later learned was also the name of a <a href="https://en.wikipedia.org/wiki/Dymaxion_Chronofile">similar undertaking</a> by Buckminster Fuller. Its code<sup id="fnref:1"><a href="https://chaidarun.com/ten-years-of-logging-my-life#fn:1" class="footnote" rel="footnote" role="doc-noteref">1</a></sup> is open source and <a href="https://github.com/artnc/chronofile/">available on GitHub</a>.</p>

<blockquote>
  <p><span class="badge" title="2021-12-27">Update</span> Hello <a href="https://news.ycombinator.com/item?id=29692087">Hacker News</a>! As requested, here’s a <a href="https://github.com/artnc/chronofile/releases">release APK</a> that you can try installing for yourself on Android 8+. Please open a GitHub issue if you run into any problems with the app.</p>
</blockquote>

<blockquote>
  <p><span class="badge" title="2025-10-21">Update</span> Several years later, I’ve finally gotten around to uploading Chronofile to the <a href="https://play.google.com/store/apps/details?id=com.chaidarun.chronofile">Google Play store</a>!</p>
</blockquote>

<p>Internally the app saves each log entry as a <a href="https://en.wikipedia.org/wiki/Tab-separated_values">TSV</a> row containing the activity’s name, descriptive note (optional), latitude, longitude, and start time in seconds since 1970:</p>

<pre><code class="language-tsv">Work	40.461583	-79.926864		1639506621
</code></pre>

<p>Tapping on an old entry creates a new one for the same activity. Geolocation data comes from GPS. Chronofile’s streamlined interface has cut down the time that I spend tracking myself each day from around ten minutes to less than one minute.</p>

<h2 id="observations">Observations</h2>

<canvas id="music-chart">(Chart of practice per musical instrument)</canvas>

<p>Turns out I’ve been playing music for an average of 45 minutes a day over the past decade, which is honestly a little embarrassing given that I’m certainly better at it by now but still so far from where I’d like to be. Oh well, no need to be world-class at your hobbies I guess?</p>

<p>I did expect <a href="https://chaidarun.com/guitalele">guitalele</a> to top the list but was shocked to see that I’ve sunk 943 hours into this tiny guitar that I picked up for less than $100! Possibly my highest-ROI purchase ever.</p>

<canvas id="haircut-chart">(Chart of days between haircuts)</canvas>

<p>Yes I did the quarantine hair thing. Still kinda regret finally cutting it :S</p>

<p>The remaining charts cover only the past four years since it’s too cumbersome to extract this data from the pre-Chronofile spreadsheet era.</p>

<canvas id="transportation-chart">(Chart of transportation methods)</canvas>

<p>Lockdown sticks out like a sore thumb in this one too. It’s a small miracle that my legs still work—there were some months when I didn’t take a single step outside! Most of my pandemic travel has been on long road trips.</p>

<canvas id="media-chart">(Chart of daily media consumption)</canvas>

<p>Hidden in the chart above are a handful of games, 24 books, 39 shows, 102 movies, and thousands of news articles. I had never really been much into TV, but to stay somewhat social during lockdown I joined a viewing party that ended up covering all the corona classics: <em>Tiger King</em>, <em>Love Is Blind</em>, <em>Avatar</em>, kdrama after kdrama after kdrama…</p>

<p>You can see that “News” went flat for several months in 2021, corresponding to when my <a href="https://chaidarun.com/ttrss-heroku">TTRSS</a> server abruptly stopped fetching most of my RSS feeds due to some certificate error. Even though reading the news had been such a constant part of my daily life ever since the olden days of Slashdot and Google Reader, it took me five months to even notice this problem!</p>

<p>I have mixed feelings about that. I do think it’s important to know what’s going on in the world, but how much time is worth spending? Hacker News (via <a href="https://hnrss.github.io/">hnrss</a>) is an incredibly valuable resource and I can’t imagine having become as good of an engineer without it, but it’s also a bit of an echo chamber. In any case, it’s a relief to have such clear proof that I’m not as addicted to the news as I once suspected.</p>

<p>Notably absent from the chart is social media, which I mostly gave up after high school.</p>

<canvas id="productivity-chart">(Chart of daily personal productivity)</canvas>

<p>In contrast to the previous chart of passive media consumption, this one maps out “personal productivity” loosely defined as activities that improve myself in some measurable way or make progress toward non-work (unprofessional?) goals.</p>

<p>Occasions when things weren’t all going my way were responsible for a few of the “Music” upticks above. I’ve found that playing music is the best medicine: it uses up vast amounts of physical, emotional, and mental energy that I might otherwise be tempted to spend more counterproductively.</p>

<p>Obviously exercise is good too, but I’ve been less sure about the particular kind. At no point during my first (and probably last) half-marathon in May 2019 or the training for it did I ever experience anything remotely resembling runner’s high, and the <a href="https://www.youtube.com/watch?v=-xZQ0YZ7ls4">pump</a> has never quite done it for me like it does for Arnold. I still lift a bit but most of my exercise nowadays comes from rock climbing and volleyball. As the chart suggests, those have been much more enjoyable to sustain at an average pace above one hour a day.</p>

<canvas id="sleep-chart">(Chart of sleep hours)</canvas>

<p>Monday always feels like the busiest day of my week, which the chart confirms by giving Monday the smallest bubbles of any night. Overall I’m pretty happy with how boring my sleep schedule has become in recent years, a far cry from the chaos of high school.</p>

<canvas id="work-chart">(Chart of work hours)</canvas>

<p>Some might find this chart more concerning. Is nothing sacred, other than Sunday 7am?! A less alarming interpretation: I have enough freedom in my work life and personal life that I can attend to both whenever it’s most convenient.</p>

<p>For a few months during lockdown, I settled into a pattern where I would handle the more interpersonal aspects of my job in the afternoon, take a long nap in the evening, and do “real work” (i.e. coding) after midnight while free from any distractions. That stands in contrast to most of 2014, when I would head to the gym at 1am, go to bed at 2:30am, wake up at 10:30am—usually right on the minute without an alarm—and sit down in my office chair at 11am.</p>

<p>Which of those two schedules is better? I’ve found that at least for me, <a href="https://en.wikipedia.org/wiki/Biphasic_and_polyphasic_sleep">biphasic sleep</a> didn’t actually have much of a noticeable effect on my mood or productivity. Just getting 7-8 hours of sleep a day matters much more than how those hours are distributed.</p>

<canvas id="correlation-chart">(Chart of monthly activity correlation)</canvas>

<p>What surprises me most here is the extremely weak correlation between work and sleep, which I suppose is a good thing? Sleep and travel are negatively correlated because I categorize sleep while traveling as travel.</p>

<p>Apart from sleep, work is negatively correlated with <em>everything</em>! That makes sense—I do barely any business travel, for example. Burnout is definitely something to keep in mind here.</p>

<canvas id="switching-chart">(Chart of number of log entries per day)</canvas>

<p>This chart may be the hardest of all to interpret. Chronofile’s interface has barely ever changed, so that doesn’t explain any variations here. Adding a new entry takes so little time anyway that I doubt it affects my behavior.</p>

<p>Does lower activity churn equate to better focus, longer attention span? Or should I instead aim for <em>more</em> variety each day? This chart’s shape over time doesn’t match any personal metric that comes to mind: happiness, stress level, body weight, credit score…</p>

<p>A few major life events such as relocations and changes in my <em>*ahem*</em> romantic situation do seem to show up in the chart, but they account for only a small fraction of its peaks and valleys. Is this chart mostly just noise? Maybe any underlying causes here will become more apparent as time goes on.</p>

<h2 id="conclusions">Conclusions</h2>

<p>The quantity of time spent on a given activity doesn’t say much about the quality of that time, of course. And without a control condition, it’s hard to say whether any results of this experiment are causal or simply correlational. That said, I think it’s still worth noting some changes in my own thoughts and behavior that began around the time I started this project.</p>

<p>I get a dramatically more reasonable amount of sleep, a daily average of 7 hours and 38 minutes over the past decade.</p>

<p>I can make everyday plans with greater precision, knowing exactly how many minutes I’ll need to shower or drive or buy groceries or do laundry or water the plants.</p>

<p>I spend much less time on single-player games and idle internet stuff like Reddit. I fairly often still give them my full attention, but for the most part they’re restricted to downtime during other activities like traveling and eating. I don’t mean to suggest that these are bad habits in any practical or moral sense, just that I now have better control over them as opposed to the other way around.</p>

<p>Speaking more generally—although it may sound like Chronofile has taken over my life, it’s really no more stressful or controlling than my car’s speedometer. They’re both tools that do nothing more than show me the results of my <em>own</em> decisions, and it’s now equally hard to imagine flying blind without them.</p>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.6.2/chart.min.js"></script>

<script>
document.fonts.ready.then(() => {
  // Set global defaults
  const mergeObjects = (src, dst) => Object.entries(src).forEach(([k, v]) => {
    if (v && typeof v === "object") {
      mergeObjects(v, dst[k]);
    } else {
      dst[k] = v;
    }
  });
  mergeObjects({
    animation: false,
    color: "#c8c8c8",
    font: { family: "Open Sans, sans-serif" },
    plugins: {
      legend: { display: false },
      title: { display: true },
    },
    responsive: false,
    scale: { grid: { display: false, drawBorder: false } },
  }, Chart.defaults);

  // Render individual charts
  const monthLabels = ["Jan '18", "Feb '18", "Mar '18", "Apr '18", "May '18", "Jun '18", "Jul '18", "Aug '18", "Sep '18", "Oct '18", "Nov '18", "Dec '18", "Jan '19", "Feb '19", "Mar '19", "Apr '19", "May '19", "Jun '19", "Jul '19", "Aug '19", "Sep '19", "Oct '19", "Nov '19", "Dec '19", "Jan '20", "Feb '20", "Mar '20", "Apr '20", "May '20", "Jun '20", "Jul '20", "Aug '20", "Sep '20", "Oct '20", "Nov '20", "Dec '20", "Jan '21", "Feb '21", "Mar '21", "Apr '21", "May '21", "Jun '21", "Jul '21", "Aug '21", "Sep '21", "Oct '21", "Nov '21", "Dec '21"];
  const haircutDays = [
    57,
    95,
    93,
    85,
    92,
    97,
    57,
    41,
    43,
    43,
    42,
    47,
    120,
    168,
    81, // until oct 15, 2015
    164, // until mar 28, 2016
    76,
    72, // split from 322
    86, // split from 322
    80, // split from 322
    84, // split from 322 until apr 30, 2017
    122, // split from 357
    102, // split from 357
    134, // split from 357 until apr 22, 2018
    77,
    76,
    43,
    35,
    35,
    34,
    42,
    35,
    50,
    48,
    28,
    35,
    41,
    44,
    27,
    28,
    256,
    30,
    34,
    36,
    42,
    42,
    41,
    72,
    23,
    42
  ];
  const bubbleOptions = {
    clip: 40,
    events: [],
    scales: {
      x: {
        min: 0,
        max: 23,
        ticks: {
          callback: value => value % 3 ? "" : value === 0 ? "12am" : value === 12 ? "12pm" : value < 12 ? `${value}am` : `${value - 12}pm`,
          padding: 15,
          stepSize: 3,
        }
      },
      y: {
        reverse: true,
        ticks: {
          callback: value => ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"][value],
          padding: 15,
        },
      },
    },
  };
  const correlationData = [
    [1,0,0,0,0,0,0,0,0,0],
    [0.008176371527,1,0,0,0,0,0,0,0,0,0],
    [0.005383377635,-0.3963415937,1,0,0,0,0,0,0,0,0],
    [-0.1664989388,-0.0693359137,-0.07860970823,1,0,0,0,0,0,0,0],
    [0.04085778615,-0.3352397547,-0.04903616957,-0.1278800239,1,0,0,0,0,0,0],
    [0.2082741975,-0.001373978466,-0.4178344017,0.03162809882,0.1541555084,1,0,0,0,0,0],
    [0.1214638688,-0.1767920413,-0.3414280152,0.3720877076,0.1593224842,0.3143167272,1,0,0,0,0],
    [-0.4521179127,-0.3207140753,0.283728704,0.08403995982,0.1189739165,-0.2121134805,-0.3173369063,1,0,0,0],
    [0.2078986006,-0.183195081,-0.4046147748,-0.3052183756,0.1090788851,0.1998981457,0.06021061275,-0.3081830436,1,0,0],
    [-0.1700525107,-0.4120136877,0.4008586175,0.2766714432,0.05736317522,-0.009161975885,0.03032305445,0.3999532407,-0.3678647283,1,0],
    [-0.2609036101,-0.197422513,-0.319693051,-0.01406227662,0.05112123312,-0.2214213993,0.08507022619,-0.1340874535,0.1797060268,-0.2312480792,1],
  ];
  const correlationPositives = [];
  const correlationNegatives = [];
  for (let i = 0; i < correlationData.length; ++i) {
    for (let j = 0; j < correlationData.length; ++j) {
      const v = correlationData[i][j] ? correlationData[i][j] : correlationData[j][i];
      (v > 0 ? correlationPositives : correlationNegatives).push({x:i,y:j,r:24*Math.sqrt(Math.abs(v))});
    }
  }
  const correlationScale = {
    ticks: {
      callback: value => ["Sleep","Work","People","Food","Chores","Read","Music","Travel","Projects","Exercise","Other"][value],
      padding: 30,
    },
  };
  new Chart(
    $("#correlation-chart"),
    {
      data: {
        datasets: [
          {
            backgroundColor: "#59a14f",
            data: correlationPositives,
          },
          {
            backgroundColor: "#e15759",
            data: correlationNegatives,
          },
        ],
        labels: [...new Array(168)].map(_ => ""),
      },
      options: {
        ...bubbleOptions,
        aspectRatio: 1.04,
        plugins: { title: { padding: 30, text: "Monthly activity correlation, 2018-2021" } },
        scales: { x: correlationScale, y: {...correlationScale } },
      },
      type: "bubble",
    }
  );
  new Chart(
    $("#haircut-chart"),
    {
      data: {
        datasets: [{
          backgroundColor: "#4e79a7",
          data: haircutDays,
        }],
        labels: [...new Array(haircutDays.length)].map(_ => ""),
      },
      options: {
        plugins: { title: { text: "Days between haircuts, 2011-2021" } },
      },
      type: "bar",
    }
  );
  new Chart(
    $("#media-chart"),
    {
      data: {
        datasets: [
          {
            backgroundColor: "#4e79a7",
            data: [25, 17, 19, 17, 12, 22, 14, 13, 27, 22, 18, 14, 21, 22, 18, 15, 8, 13, 9, 6, 13, 27, 12, 9, 11, 5, 14, 8, 8, 8, 7, 23, 13, 29, 43, 22, 22, 9, 6, 23, 19, 22, 1, 4, 3, 0, 0, 14],
            label: "News",
          },
          {
            backgroundColor: "#f28e2c",
            data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 23, 10, 10, 5, 6, 5, 7, 14, 6, 6, 14, 13, 20, 18, 15, 17, 30, 30, 19, 2, 12, 70, 83, 1, 5],
            label: "Video games",
          },
          {
            backgroundColor: "#e15759",
            data: [3, 0, 0, 14, 5, 22, 22, 5, 0, 14, 8, 12, 11, 2, 41, 9, 4, 13, 24, 21, 7, 11, 6, 18, 21, 0, 8, 8, 1, 6, 16, 9, 0, 0, 3, 1, 6, 4, 0, 4, 0, 0, 3, 0, 9, 13, 4, 5],
            label: "Movies",
          },
          {
            backgroundColor: "#76b7b2",
            data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 28, 189, 154, 74, 91, 62, 54, 7, 34, 89, 0, 0, 0, 0, 0, 0, 2, 0, 0, 16, 0, 0],
            label: "TV",
          },
          {
            backgroundColor: "#59a14f",
            data: [0, 0, 0, 0, 0, 0, 0, 3, 14, 48, 28, 76, 3, 2, 0, 5, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 38, 18],
            label: "Books",
          },
        ],
        labels: monthLabels,
      },
      options: {
        plugins: {
          legend: { display: true, position: "bottom" },
          title: { text: "Average daily minutes of media consumption" },
        },
        scales: {
          x: { stacked: true },
          y: { stacked: true },
        },
      },
      type: "bar",
    }
  );
  new Chart(
    $("#music-chart"),
    {
      data: {
        datasets: [{
          backgroundColor: "#4e79a7",
          data: [
            // uva.xls, me.ods, Chronofile
            28 + 0 + 1,
            8,
            0 + 335 + 608,
            151 + 113 + 111,
            0 + 10 + 2,
            396 + 172 + 215,
            8 + 36 + 9,
            192 + 0 + 0,
            30 + 0 + 318,
          ],
        }],
        labels: [
          "Bass guitar",
          "Clarinet",
          "Guitalele",
          "Guitar",
          "Harmonica",
          "Piano",
          "Saxophone",
          "Sousaphone",
          "Tuba",
        ],
      },
      options: {
        indexAxis: "y",
        plugins: { title: { text: "Hours per musical instrument, 2011-2021" } },
      },
      type: "bar",
    }
  );
  new Chart(
    $("#productivity-chart"),
    {
      data: {
        datasets: [
          {
            backgroundColor: "#4e79a7",
            data: [51, 29, 4, 19, 9, 26, 24, 45, 54, 44, 26, 58, 65, 56, 62, 43, 76, 69, 87, 57, 133, 87, 117, 48, 71, 87, 76, 30, 42, 52, 50, 20, 42, 122, 68, 39, 73, 54, 44, 49, 27, 62, 12, 44, 44, 53, 20, 44],
            label: "Music",
          },
          {
            backgroundColor: "#f28e2c",
            data: [16, 7, 12, 8, 9, 7, 10, 35, 44, 50, 25, 39, 57, 58, 27, 29, 34, 20, 37, 46, 31, 35, 40, 29, 24, 25, 18, 15, 24, 15, 15, 23, 5, 5, 0, 4, 15, 1, 0, 8, 29, 21, 73, 71, 62, 87, 75, 50],
            label: "Exercise",
          },
          {
            backgroundColor: "#e15759",
            data: [0, 0, 0, 0, 0, 0, 0, 9, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 15, 0, 0, 9, 22, 1, 1, 24, 0, 0, 0, 0, 41, 201, 153, 94, 55, 65, 101, 35, 5, 5, 2, 2, 3],
            label: "Language study",
          },
          {
            backgroundColor: "#76b7b2",
            data: [93, 4, 2, 4, 2, 0, 5, 2, 2, 0, 0, 40, 5, 13, 0, 10, 21, 35, 4, 5, 5, 17, 4, 12, 4, 9, 8, 1, 3, 3, 54, 5, 41, 42, 166, 69, 6, 26, 29, 21, 10, 6, 12, 5, 3, 2, 37, 83],
            label: "Other projects, e.g. this blog",
          },
        ],
        labels: monthLabels,
      },
      options: {
        plugins: {
          legend: { display: true, position: "bottom" },
          title: { text: "Average daily minutes of personal productivity" },
        },
        scales: {
          x: { stacked: true },
          y: { stacked: true },
        },
      },
      type: "bar",
    }
  );
  new Chart(
    $("#switching-chart"),
    {
      data: {
        datasets: [
          {
            backgroundColor: "#4e79a7",
            data: [20.4, 19.6, 19.7, 18.2, 16.9, 17.5, 18.6, 22.5, 27.1, 26.9, 23.5, 25.0, 26.6, 24.7, 23.8, 22.6, 23.5, 25.9, 23.2, 27.1, 29.9, 28.3, 32.9, 27.4, 28.8, 25.8, 24.5, 24.5, 21.5, 19.5, 21.0, 20.2, 17.5, 22.5, 22.6, 25.3, 28.6, 21.3, 18.8, 25.4, 26.1, 26.5, 21.8, 19.7, 20.9, 24.5, 22.9, 16.3],
          },
        ],
        labels: monthLabels,
      },
      options: {
        plugins: {
          title: { text: "Average daily number of log entries" },
        },
      },
      type: "bar",
    }
  );
  new Chart(
    $("#sleep-chart"),
    {
      data: {
        datasets: [
          {
            backgroundColor: "#4e79a7",
            data: [{"x": 1, "y": 3, "r": 5.8}, {"x": 2, "y": 3, "r": 7.0}, {"x": 3, "y": 3, "r": 8.4}, {"x": 4, "y": 3, "r": 9.5}, {"x": 5, "y": 3, "r": 9.9}, {"x": 6, "y": 3, "r": 10.3}, {"x": 7, "y": 3, "r": 10.5}, {"x": 9, "y": 3, "r": 9.4}, {"x": 10, "y": 3, "r": 7.0}, {"x": 3, "y": 4, "r": 7.9}, {"x": 4, "y": 4, "r": 8.8}, {"x": 5, "y": 4, "r": 9.7}, {"x": 6, "y": 4, "r": 10.4}, {"x": 7, "y": 4, "r": 10.5}, {"x": 8, "y": 4, "r": 10.4}, {"x": 9, "y": 4, "r": 9.6}, {"x": 19, "y": 4, "r": 2.8}, {"x": 20, "y": 4, "r": 2.8}, {"x": 2, "y": 5, "r": 6.8}, {"x": 3, "y": 5, "r": 8.0}, {"x": 4, "y": 5, "r": 9.0}, {"x": 5, "y": 5, "r": 9.6}, {"x": 6, "y": 5, "r": 10.3}, {"x": 7, "y": 5, "r": 10.6}, {"x": 8, "y": 5, "r": 10.4}, {"x": 3, "y": 6, "r": 8.2}, {"x": 4, "y": 6, "r": 9.0}, {"x": 5, "y": 6, "r": 9.6}, {"x": 6, "y": 6, "r": 10.1}, {"x": 7, "y": 6, "r": 10.3}, {"x": 8, "y": 6, "r": 10.3}, {"x": 9, "y": 6, "r": 9.8}, {"x": 3, "y": 0, "r": 7.2}, {"x": 4, "y": 0, "r": 8.5}, {"x": 5, "y": 0, "r": 9.4}, {"x": 6, "y": 0, "r": 10.4}, {"x": 7, "y": 0, "r": 10.8}, {"x": 8, "y": 0, "r": 10.8}, {"x": 9, "y": 0, "r": 10.0}, {"x": 10, "y": 0, "r": 9.2}, {"x": 3, "y": 1, "r": 8.0}, {"x": 4, "y": 1, "r": 9.2}, {"x": 5, "y": 1, "r": 10.2}, {"x": 6, "y": 1, "r": 10.5}, {"x": 7, "y": 1, "r": 10.9}, {"x": 8, "y": 1, "r": 10.7}, {"x": 9, "y": 1, "r": 9.7}, {"x": 10, "y": 1, "r": 7.3}, {"x": 11, "y": 1, "r": 4.9}, {"x": 20, "y": 1, "r": 1.7}, {"x": 21, "y": 1, "r": 2.8}, {"x": 6, "y": 2, "r": 10.6}, {"x": 7, "y": 2, "r": 10.8}, {"x": 8, "y": 2, "r": 10.6}, {"x": 9, "y": 2, "r": 9.5}, {"x": 10, "y": 2, "r": 7.1}, {"x": 20, "y": 2, "r": 2.6}, {"x": 8, "y": 3, "r": 10.2}, {"x": 17, "y": 3, "r": 1.9}, {"x": 18, "y": 3, "r": 2.8}, {"x": 19, "y": 3, "r": 3.2}, {"x": 1, "y": 6, "r": 6.3}, {"x": 2, "y": 6, "r": 7.1}, {"x": 17, "y": 6, "r": 4.8}, {"x": 18, "y": 6, "r": 5.2}, {"x": 0, "y": 0, "r": 2.5}, {"x": 1, "y": 0, "r": 3.3}, {"x": 2, "y": 0, "r": 5.5}, {"x": 14, "y": 0, "r": 3.6}, {"x": 1, "y": 1, "r": 5.7}, {"x": 2, "y": 1, "r": 6.9}, {"x": 2, "y": 2, "r": 6.7}, {"x": 3, "y": 2, "r": 8.2}, {"x": 4, "y": 2, "r": 9.6}, {"x": 5, "y": 2, "r": 10.4}, {"x": 1, "y": 4, "r": 5.5}, {"x": 2, "y": 4, "r": 6.7}, {"x": 21, "y": 5, "r": 3.7}, {"x": 22, "y": 5, "r": 4.9}, {"x": 23, "y": 5, "r": 5.1}, {"x": 0, "y": 6, "r": 5.6}, {"x": 16, "y": 6, "r": 4.1}, {"x": 1, "y": 2, "r": 5.2}, {"x": 1, "y": 5, "r": 5.8}, {"x": 19, "y": 6, "r": 4.3}, {"x": 21, "y": 6, "r": 3.5}, {"x": 22, "y": 6, "r": 3.3}, {"x": 23, "y": 6, "r": 2.6}, {"x": 9, "y": 5, "r": 9.6}, {"x": 10, "y": 6, "r": 8.7}, {"x": 11, "y": 6, "r": 7.6}, {"x": 14, "y": 6, "r": 4.7}, {"x": 15, "y": 6, "r": 4.5}, {"x": 10, "y": 4, "r": 7.7}, {"x": 21, "y": 4, "r": 3.3}, {"x": 22, "y": 4, "r": 4.9}, {"x": 23, "y": 4, "r": 5.3}, {"x": 10, "y": 5, "r": 7.4}, {"x": 20, "y": 6, "r": 3.6}, {"x": 0, "y": 4, "r": 4.7}, {"x": 13, "y": 0, "r": 4.6}, {"x": 23, "y": 0, "r": 4.4}, {"x": 0, "y": 1, "r": 4.8}, {"x": 17, "y": 0, "r": 2.8}, {"x": 18, "y": 0, "r": 2.9}, {"x": 19, "y": 0, "r": 2.9}, {"x": 0, "y": 5, "r": 5.2}, {"x": 11, "y": 0, "r": 8.0}, {"x": 12, "y": 6, "r": 6.2}, {"x": 13, "y": 6, "r": 5.1}, {"x": 22, "y": 0, "r": 4.1}, {"x": 23, "y": 3, "r": 5.0}, {"x": 20, "y": 0, "r": 2.9}, {"x": 21, "y": 3, "r": 4.3}, {"x": 22, "y": 3, "r": 4.8}, {"x": 14, "y": 1, "r": 1.7}, {"x": 15, "y": 1, "r": 1.7}, {"x": 0, "y": 2, "r": 3.7}, {"x": 21, "y": 0, "r": 3.4}, {"x": 21, "y": 2, "r": 3.3}, {"x": 22, "y": 2, "r": 3.9}, {"x": 23, "y": 2, "r": 4.3}, {"x": 0, "y": 3, "r": 4.2}, {"x": 22, "y": 1, "r": 3.1}, {"x": 23, "y": 1, "r": 3.1}, {"x": 20, "y": 3, "r": 3.1}, {"x": 15, "y": 4, "r": 2.6}, {"x": 16, "y": 4, "r": 2.2}, {"x": 12, "y": 1, "r": 3.0}, {"x": 19, "y": 1, "r": 2.0}, {"x": 12, "y": 0, "r": 6.2}, {"x": 11, "y": 3, "r": 3.6}, {"x": 20, "y": 5, "r": 3.0}, {"x": 14, "y": 4, "r": 2.0}, {"x": 17, "y": 4, "r": 2.0}, {"x": 18, "y": 4, "r": 2.0}, {"x": 17, "y": 5, "r": 1.9}, {"x": 18, "y": 5, "r": 2.2}, {"x": 19, "y": 5, "r": 2.8}, {"x": 11, "y": 5, "r": 5.0}, {"x": 11, "y": 2, "r": 3.9}, {"x": 15, "y": 2, "r": 2.0}, {"x": 16, "y": 2, "r": 1.9}, {"x": 17, "y": 2, "r": 2.0}, {"x": 11, "y": 4, "r": 5.7}, {"x": 12, "y": 4, "r": 4.3}, {"x": 13, "y": 4, "r": 2.4}, {"x": 16, "y": 1, "r": 1.7}, {"x": 12, "y": 2, "r": 2.5}, {"x": 13, "y": 2, "r": 2.0}, {"x": 14, "y": 2, "r": 1.7}, {"x": 15, "y": 3, "r": 1.9}, {"x": 16, "y": 3, "r": 1.9}, {"x": 15, "y": 0, "r": 3.1}, {"x": 16, "y": 0, "r": 2.9}, {"x": 14, "y": 5, "r": 2.0}, {"x": 15, "y": 5, "r": 2.0}, {"x": 17, "y": 1, "r": 1.7}, {"x": 18, "y": 1, "r": 2.0}, {"x": 13, "y": 1, "r": 2.4}, {"x": 12, "y": 3, "r": 3.0}, {"x": 12, "y": 5, "r": 3.6}, {"x": 13, "y": 5, "r": 2.2}, {"x": 18, "y": 2, "r": 2.0}, {"x": 14, "y": 3, "r": 1.2}, {"x": 16, "y": 5, "r": 2.0}, {"x": 19, "y": 2, "r": 2.4}, {"x": 13, "y": 3, "r": 1.4}],
          },
        ],
        labels: [...new Array(168)].map(_ => ""),
      },
      options: {
        ...bubbleOptions,
        plugins: { title: { padding: 25, text: "Sleep, 2018-2021" } },
      },
      type: "bubble",
    }
  );
  new Chart(
    $("#transportation-chart"),
    {
      data: {
        datasets: [
          {
            backgroundColor: "#4e79a7",
            data: [0, 0, 0, 1, 2, 0, 0, 13, 20, 17, 17, 9, 13, 12, 16, 15, 23, 15, 21, 18, 26, 25, 27, 18, 15, 18, 11, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 12, 2, 44, 19, 18, 34, 19, 9],
            label: "Walk",
          },
          {
            backgroundColor: "#f28e2c",
            data: [36, 31, 44, 42, 45, 41, 37, 77, 22, 6, 61, 12, 15, 15, 7, 14, 18, 15, 28, 31, 31, 26, 53, 58, 27, 18, 29, 0, 0, 0, 2, 38, 20, 6, 1, 2, 1, 2, 0, 2, 69, 19, 133, 27, 52, 76, 84, 28],
            label: "Car",
          },
          {
            backgroundColor: "#e15759",
            data: [0, 34, 0, 32, 28, 0, 0, 8, 0, 0, 130, 9, 10, 42, 0, 13, 22, 0, 0, 0, 0, 0, 7, 92, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13, 0, 38, 16, 6, 5],
            label: "Airplane",
          },
          {
            backgroundColor: "#76b7b2",
            data: [0, 9, 0, 0, 0, 0, 0, 7, 0, 0, 16, 7, 5, 6, 0, 12, 1, 0, 0, 0, 0, 0, 8, 8, 7, 4, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 2, 0, 6, 5],
            label: "Bus",
          },
          {
            backgroundColor: "#59a14f",
            data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0],
            label: "Train",
          },
        ],
        labels: monthLabels,
      },
      options: {
        plugins: {
          legend: { display: true, position: "bottom" },
          title: { text: "Average daily minutes of travel" },
        },
        scales: {
          x: { stacked: true },
          y: { stacked: true },
        },
      },
      type: "bar",
    }
  );
  new Chart(
    $("#work-chart"),
    {
      data: {
        datasets: [
          {
            backgroundColor: "#4e79a7",
            data: [{"x": 18, "y": 3, "r": 10.4}, {"x": 21, "y": 4, "r": 5.9}, {"x": 9, "y": 5, "r": 2.9}, {"x": 10, "y": 5, "r": 5.7}, {"x": 11, "y": 5, "r": 8.4}, {"x": 11, "y": 4, "r": 7.8}, {"x": 12, "y": 4, "r": 9.3}, {"x": 14, "y": 4, "r": 10.5}, {"x": 15, "y": 4, "r": 10.6}, {"x": 16, "y": 4, "r": 10.4}, {"x": 17, "y": 4, "r": 10.6}, {"x": 18, "y": 4, "r": 10.2}, {"x": 19, "y": 4, "r": 8.4}, {"x": 12, "y": 5, "r": 9.5}, {"x": 14, "y": 5, "r": 10.3}, {"x": 15, "y": 5, "r": 10.4}, {"x": 16, "y": 5, "r": 10.4}, {"x": 17, "y": 5, "r": 10.4}, {"x": 18, "y": 5, "r": 9.8}, {"x": 19, "y": 5, "r": 7.6}, {"x": 21, "y": 5, "r": 4.9}, {"x": 23, "y": 5, "r": 4.3}, {"x": 13, "y": 6, "r": 3.8}, {"x": 20, "y": 0, "r": 2.8}, {"x": 21, "y": 0, "r": 3.5}, {"x": 11, "y": 1, "r": 8.8}, {"x": 12, "y": 1, "r": 10.1}, {"x": 14, "y": 1, "r": 10.7}, {"x": 15, "y": 1, "r": 10.7}, {"x": 16, "y": 1, "r": 10.6}, {"x": 17, "y": 1, "r": 10.6}, {"x": 18, "y": 1, "r": 10.4}, {"x": 19, "y": 1, "r": 9.4}, {"x": 21, "y": 1, "r": 5.7}, {"x": 22, "y": 1, "r": 5.8}, {"x": 23, "y": 1, "r": 7.3}, {"x": 0, "y": 2, "r": 6.9}, {"x": 1, "y": 2, "r": 6.2}, {"x": 11, "y": 2, "r": 9.0}, {"x": 12, "y": 2, "r": 10.1}, {"x": 14, "y": 2, "r": 11.0}, {"x": 15, "y": 2, "r": 10.8}, {"x": 16, "y": 2, "r": 10.6}, {"x": 17, "y": 2, "r": 10.6}, {"x": 19, "y": 2, "r": 8.1}, {"x": 20, "y": 2, "r": 5.8}, {"x": 23, "y": 2, "r": 6.3}, {"x": 0, "y": 3, "r": 6.7}, {"x": 1, "y": 3, "r": 5.5}, {"x": 2, "y": 3, "r": 5.2}, {"x": 3, "y": 3, "r": 4.7}, {"x": 4, "y": 3, "r": 4.1}, {"x": 9, "y": 3, "r": 3.7}, {"x": 10, "y": 3, "r": 6.8}, {"x": 11, "y": 3, "r": 9.4}, {"x": 12, "y": 3, "r": 10.0}, {"x": 13, "y": 3, "r": 4.1}, {"x": 14, "y": 3, "r": 9.1}, {"x": 15, "y": 3, "r": 10.8}, {"x": 16, "y": 3, "r": 10.7}, {"x": 19, "y": 3, "r": 8.4}, {"x": 0, "y": 5, "r": 5.3}, {"x": 16, "y": 0, "r": 3.6}, {"x": 17, "y": 0, "r": 3.2}, {"x": 18, "y": 2, "r": 10.3}, {"x": 17, "y": 3, "r": 10.7}, {"x": 23, "y": 3, "r": 6.4}, {"x": 0, "y": 4, "r": 6.4}, {"x": 1, "y": 4, "r": 5.8}, {"x": 6, "y": 5, "r": 2.8}, {"x": 10, "y": 6, "r": 2.5}, {"x": 17, "y": 6, "r": 4.3}, {"x": 23, "y": 0, "r": 4.2}, {"x": 10, "y": 1, "r": 5.4}, {"x": 20, "y": 1, "r": 6.3}, {"x": 22, "y": 2, "r": 6.5}, {"x": 20, "y": 3, "r": 6.3}, {"x": 21, "y": 3, "r": 6.1}, {"x": 22, "y": 3, "r": 6.4}, {"x": 14, "y": 6, "r": 3.6}, {"x": 15, "y": 6, "r": 3.2}, {"x": 16, "y": 6, "r": 3.8}, {"x": 18, "y": 6, "r": 4.6}, {"x": 20, "y": 6, "r": 4.8}, {"x": 21, "y": 6, "r": 4.8}, {"x": 23, "y": 6, "r": 5.1}, {"x": 0, "y": 0, "r": 4.9}, {"x": 10, "y": 0, "r": 2.5}, {"x": 12, "y": 0, "r": 3.1}, {"x": 19, "y": 0, "r": 3.4}, {"x": 0, "y": 1, "r": 5.2}, {"x": 22, "y": 4, "r": 5.2}, {"x": 23, "y": 4, "r": 5.4}, {"x": 22, "y": 5, "r": 4.2}, {"x": 0, "y": 6, "r": 4.0}, {"x": 1, "y": 6, "r": 3.6}, {"x": 2, "y": 6, "r": 3.5}, {"x": 3, "y": 6, "r": 3.1}, {"x": 19, "y": 6, "r": 4.9}, {"x": 22, "y": 6, "r": 4.9}, {"x": 1, "y": 0, "r": 4.3}, {"x": 2, "y": 0, "r": 3.6}, {"x": 3, "y": 0, "r": 3.7}, {"x": 11, "y": 0, "r": 2.9}, {"x": 14, "y": 0, "r": 4.4}, {"x": 15, "y": 0, "r": 4.2}, {"x": 13, "y": 1, "r": 4.8}, {"x": 1, "y": 5, "r": 5.7}, {"x": 22, "y": 0, "r": 3.5}, {"x": 1, "y": 1, "r": 5.7}, {"x": 20, "y": 4, "r": 6.0}, {"x": 2, "y": 5, "r": 4.8}, {"x": 3, "y": 5, "r": 4.7}, {"x": 4, "y": 5, "r": 3.6}, {"x": 5, "y": 5, "r": 3.8}, {"x": 12, "y": 6, "r": 3.2}, {"x": 20, "y": 5, "r": 5.0}, {"x": 11, "y": 6, "r": 2.4}, {"x": 13, "y": 0, "r": 3.8}, {"x": 2, "y": 1, "r": 5.1}, {"x": 3, "y": 1, "r": 4.1}, {"x": 9, "y": 1, "r": 2.9}, {"x": 10, "y": 2, "r": 5.6}, {"x": 2, "y": 4, "r": 5.5}, {"x": 10, "y": 4, "r": 5.6}, {"x": 4, "y": 6, "r": 2.9}, {"x": 21, "y": 2, "r": 5.4}, {"x": 18, "y": 0, "r": 3.8}, {"x": 3, "y": 4, "r": 4.9}, {"x": 13, "y": 4, "r": 4.9}, {"x": 13, "y": 5, "r": 3.9}, {"x": 8, "y": 2, "r": 2.0}, {"x": 2, "y": 2, "r": 6.0}, {"x": 3, "y": 2, "r": 5.2}, {"x": 13, "y": 2, "r": 4.7}, {"x": 5, "y": 3, "r": 2.5}, {"x": 6, "y": 3, "r": 2.2}, {"x": 7, "y": 3, "r": 1.4}, {"x": 8, "y": 3, "r": 2.8}, {"x": 8, "y": 0, "r": 1.4}, {"x": 9, "y": 0, "r": 1.9}, {"x": 9, "y": 2, "r": 3.1}, {"x": 8, "y": 4, "r": 2.0}, {"x": 8, "y": 6, "r": 1.7}, {"x": 4, "y": 0, "r": 3.5}, {"x": 4, "y": 4, "r": 4.1}, {"x": 5, "y": 4, "r": 3.3}, {"x": 9, "y": 4, "r": 2.5}, {"x": 8, "y": 5, "r": 2.5}, {"x": 6, "y": 2, "r": 2.4}, {"x": 7, "y": 2, "r": 1.9}, {"x": 5, "y": 6, "r": 2.2}, {"x": 6, "y": 6, "r": 2.2}, {"x": 7, "y": 6, "r": 2.4}, {"x": 5, "y": 0, "r": 2.9}, {"x": 4, "y": 1, "r": 3.6}, {"x": 6, "y": 0, "r": 1.4}, {"x": 7, "y": 1, "r": 1.4}, {"x": 8, "y": 1, "r": 1.4}, {"x": 4, "y": 2, "r": 3.5}, {"x": 6, "y": 4, "r": 2.4}, {"x": 7, "y": 4, "r": 2.0}, {"x": 7, "y": 5, "r": 2.6}, {"x": 5, "y": 1, "r": 2.8}, {"x": 9, "y": 6, "r": 1.7}, {"x": 5, "y": 2, "r": 2.4}, {"x": 6, "y": 1, "r": 2.0}],
          },
        ],
        labels: [...new Array(168)].map(_ => ""),
      },
      options: {
        ...bubbleOptions,
        plugins: { title: { padding: 25, text: "Work, 2018-2021" } },
      },
      type: "bubble",
    }
  );
});
</script>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:1">
      <p>Chronofile uses <a href="https://github.com/ReactiveX/RxJava">RxJava</a> to reimplement <a href="https://redux.js.org/">Redux</a> (itself inspired by the <a href="https://guide.elm-lang.org/architecture/">Elm architecture</a>) with type safety in <a href="https://github.com/artnc/chronofile/blob/e1b3a8f9405a5fcad079f625f5eae37e8ffabc94/app/src/main/java/com/chaidarun/chronofile/Store.kt#L102-L113">9 lines of code</a>, some of the most satisfying that I’ve ever written! <a href="https://chaidarun.com/ten-years-of-logging-my-life#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>
]]></description>
      </item>
      
    
      
      <item>
        <title>How to Ring Calls and Vibrate Notifications on Android</title>
        <link>https://chaidarun.com/ring-calls-vibrate-notifications-android</link>
        <pubDate>Sun, 01 Nov 2020 00:00:00 GMT</pubDate>
        <guid isPermaLink="true">https://chaidarun.com/ring-calls-vibrate-notifications-android</guid>
        
        <description><![CDATA[<p>I want calls to ring audibly, and I want notifications to vibrate silently.</p>

<p>Is that too much to ask for? Recent Android versions make this exceedingly reasonable configuration nearly impossible to implement.</p>

<blockquote>
  <p><span class="badge" title="2023-12-28">Update</span> Android 14 finally <a href="https://chromeunboxed.com/android-14-notification-ringtone-split-in-two">fixed</a> this problem by providing separate settings for ringtone volume and notification volume! Just set your notification volume to 0, set your ringtone volume to something above 0, and stop reading this blog post.</p>
</blockquote>

<h2 id="the-solution">The solution</h2>

<p>Android’s native <a href="https://support.google.com/android/answer/9069335?hl=en">Do Not Disturb</a> (henceforth “DND”) feature is the perfect solution except that it doesn’t allow notifications to vibrate. So we’ll roll that feature ourselves:</p>

<ol>
  <li>Enable DND and keep it turned on forever</li>
  <li>Allow calls to interrupt DND. On Android 11, this option is at <code class="language-plaintext highlighter-rouge">Settings &gt; Sound &gt; Do Not Disturb &gt; People &gt; Calls</code></li>
  <li>Install <a href="https://play.google.com/store/apps/details?id=net.dinglisch.android.taskerm">Tasker</a></li>
  <li>
    <p>Create a new “Do Disturb” profile that overrides the notification behavior of your permanent DND by triggering a 200ms vibration whenever a new notification arrives (optionally with your waking hours as a second constraint if you’re an extremely light sleeper like me):</p>

    <p><img src="https://chaidarun.com/img/do-disturb.png" alt="" /></p>
  </li>
</ol>

<p>I’ve been using this setup for six months now. The only downside is that I can no longer identify apps by their custom vibration patterns, but that’s a relatively small price to pay.</p>

<hr />

<h2 id="the-non-solutions">The non-solutions</h2>

<p>My path to the solution above is littered with the bodies of many failed attempts, some documented below. Note that Android has two subtly annoying limitations to work around:</p>

<ul>
  <li>Vibrate mode achieves the desired notification behavior, but Android offers no way to ring calls audibly in vibrate mode</li>
  <li>DND mutes notifications and allows calls to ring audibly, but Android offers no way to both vibrate and mute notifications during DND</li>
</ul>

<h2 id="faking-vibrate-mode-via-inaudible-notifications">Faking vibrate mode via inaudible notifications</h2>

<p>Strategy: Remove notification audio directly.</p>

<ol>
  <li>Permanently disable both DND and vibrate mode</li>
  <li>Roll your own vibrate mode by going into <code class="language-plaintext highlighter-rouge">Sound</code> settings and changing the <code class="language-plaintext highlighter-rouge">Default notification sound</code> to the <code class="language-plaintext highlighter-rouge">None</code> option (which might be located inside <code class="language-plaintext highlighter-rouge">My Sounds</code>)</li>
</ol>

<p>Fatal flaw: Some apps use their own custom notification sounds, which still play.</p>

<h2 id="overriding-system-volume-via-pagerduty">Overriding system volume via PagerDuty</h2>

<p>Strategy: Give up hope on ringing all calls audibly and settle for ringing only PagerDuty calls audibly.</p>

<ol>
  <li>Permanently enable vibrate mode</li>
  <li>Go into the PagerDuty app’s settings and enable system volume override</li>
</ol>

<p>Fatal flaw: That override option just flat out doesn’t work on my Pixel 2.</p>

<h2 id="temporarily-unmuting-the-ringer-via-tasker">Temporarily unmuting the ringer via Tasker</h2>

<p>Strategy: Stay in vibrate mode but use Tasker to temporarily disable vibrate mode during calls.</p>

<ol>
  <li>Permanently enable vibrate mode</li>
  <li>Create a Tasker profile that disables vibrate mode whenever a call comes in and reenables vibrate mode when the call ends</li>
</ol>

<p>Fatal flaw: Android doesn’t actually let you <a href="http://tasker.wikidot.com/alwaysringonimportantcontact">leave vibrate mode</a> while ringing?!</p>

<h2 id="ringing-on-the-media-channel-via-tasker">Ringing on the media channel via Tasker</h2>

<p>Strategy: Stay in vibrate mode and use Tasker to “ring” calls by simply playing an MP3 file that you specify.</p>

<ol>
  <li>Permanently enable vibrate mode</li>
  <li>Follow <a href="http://tasker.wikidot.com/alwaysringonimportantcontact">these instructions</a> to create a Tasker profile that plays an audio file when a call comes in</li>
</ol>

<p>Fatal flaw: There’s an Android OS <a href="https://android.stackexchange.com/questions/139524/turn-ringer-to-loud-from-vibrate-when-a-particular-contact-calls#comment178601_139525">bug</a> that causes the ringtone to continue looping forever?! The provided workaround doesn’t work on my Pixel 2.</p>
]]></description>
      </item>
      
    
      
      <item>
        <title>TP-Link API Reference</title>
        <link>https://chaidarun.com/tp-link-api</link>
        <pubDate>Wed, 02 Sep 2020 00:00:00 GMT</pubDate>
        <guid isPermaLink="true">https://chaidarun.com/tp-link-api</guid>
        
        <description><![CDATA[<p>My <a href="https://www.kasasmart.com/us/products/smart-plugs/kasa-smart-wifi-plug-lite-hs103p2">Kasa HS103</a> smart plugs arrived today, and I felt an uncontrollable urge to control them via API. This post is a distillation of <a href="https://itnerd.space/2017/01/22/how-to-control-your-tp-link-hs100-smartplug-from-internet/">these guides</a> for my own reference. It should work for at least the HS1xx product line.</p>

<h2 id="1-get-authentication-token">1. Get authentication token</h2>

<p>Substitute your login details. You can use <code class="language-plaintext highlighter-rouge">uuidgen</code> to generate a UUID.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-s</span> https://wap.tplinkcloud.com <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span> <span class="nt">-d</span> <span class="s1">'{"method":"login","params":{"appType":"Kasa_Android","cloudUserName":"$ACCOUNT_EMAIL","cloudPassword":"$ACCOUNT_PASSWORD","terminalUUID":"$UUID"}}'</span> | jq <span class="nt">-r</span> .result.token
</code></pre></div></div>

<h2 id="2-list-devices">2. List devices</h2>

<p>Substitute the token obtained in the previous step.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-s</span> <span class="s2">"https://wap.tplinkcloud.com?token=</span><span class="nv">$TOKEN</span><span class="s2">"</span> <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span> <span class="nt">-d</span> <span class="s1">'{"method":"getDeviceList"}'</span> | jq <span class="nt">-S</span> .result.deviceList
</code></pre></div></div>

<h2 id="3-change-device-state">3. Change device state</h2>

<p>Substitute your desired device’s info. State <code class="language-plaintext highlighter-rouge">1</code> means “on”, <code class="language-plaintext highlighter-rouge">0</code> means “off”.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-s</span> <span class="s2">"</span><span class="nv">$APP_SERVER_URL</span><span class="s2">?token=</span><span class="nv">$TOKEN</span><span class="s2">"</span> <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span> <span class="nt">-d</span> <span class="s1">'{"method":"passthrough","params":{"deviceId":"$DEVICE_ID","requestData":"{\"system\":{\"set_relay_state\":{\"state\":1}}}"}}'</span>
</code></pre></div></div>

<p>That’s all for now! Let me know if TP-Link ever provides real API documentation…</p>
]]></description>
      </item>
      
    
      
      <item>
        <title>How to Write Guitar Tabs in MuseScore</title>
        <link>https://chaidarun.com/musescore-tab</link>
        <pubDate>Sun, 02 Jun 2019 00:00:00 GMT</pubDate>
        <guid isPermaLink="true">https://chaidarun.com/musescore-tab</guid>
        
        <description><![CDATA[<p>After brief forays into LilyPond and TuxGuitar (and a failed attempt at running Guitar Pro in Wine), I’ve settled on <a href="https://musescore.org/en">MuseScore</a> for my guitar tabbing needs. Here are some notes on how I produce tab files like <a href="https://chaidarun.com/files/tab/Journey - Don't Stop Believin'.pdf">this one</a>:</p>

<object style="height:500px;width:100%;" type="application/pdf" data="/files/tab/Journey - Don't Stop Believin'.pdf?#navpanes=0&amp;scrollbar=0&amp;statusbar=0&amp;toolbar=0&amp;view=FitH">
  <a href="https://chaidarun.com/files/tab/Journey - Don't Stop Believin'.pdf">Journey - Don't Stop Believin'.pdf</a>
</object>

<p>For more advanced topics, check out MuseScore’s <a href="https://musescore.org/en/handbook/tablature">Tablature</a> handbook.</p>

<h2 id="creating-a-new-file">Creating a new file</h2>

<ol>
  <li>In the new score wizard, enter Title and Composer</li>
  <li>Select the “Choose new instruments” template</li>
  <li>Add “Acoustic Guitar” or “Classical Guitar”</li>
  <li>Select the newly added staff, click “Add Linked Staff”, and change that second staff’s type to “Tab. 6-str. common”</li>
</ol>

<h2 id="customizing-the-music-font">Customizing the music font</h2>

<p>In “Format” &gt; “Style” &gt; “Score”, set the music symbols font to Bravura. The default choice of LilyPond’s Emmentaler works fine, but I prefer heavier fonts for legibility.</p>

<h2 id="styling-the-tab-staff">Styling the tab staff</h2>

<p>I find MuseScore’s default tab style pretty noisy and hard to read. Keeping note values and ties confined to the standard staff results in a cleaner tab staff.</p>

<ol>
  <li>Right-click the tab staff and select “Staff/Part Properties”</li>
  <li>Click “Advanced Style Properties”</li>
  <li>Change the font to Musescore Tab Sans</li>
  <li>Decrease the font size to 8pt</li>
  <li>Uncheck “Show back-tied fret marks”</li>
  <li>In the “Note Values” tab, select “Shown as: None”</li>
</ol>

<h2 id="note-entry">Note entry</h2>

<p>A natural way to write your score might be to fully complete each measure before moving on to the next one, but unfortunately this is probably the slowest and most annoying way.</p>

<p>A much faster method is to write your score one layer at a time:</p>

<ol>
  <li>Fill the first measure with eighth rests</li>
  <li>Create several dozen new measures and copy the first measure’s rests into them</li>
  <li>Starting back at the first measure, use your computer’s numpad and arrow keys to enter all of the song’s note pitches into the tab staff as eighth notes</li>
  <li>Repeat step 3 for voices (and then for note values, then for articulations, etc.)</li>
</ol>

<p>Note that by the end of step 3, your tab staff is already 99% done! You can just consider your score finished at that point if you don’t care about the standard staff.</p>

<h2 id="performance-techniques">Performance techniques</h2>

<p>Since MuseScore is intended as a general-purpose score editor for all instruments, expressing guitar-specific performance techniques sometimes takes a little creativity.</p>

<h3 id="hammer-ons-and-pull-offs">Hammer-ons and pull-offs</h3>

<p>These are usually written as slurs. Since slurs are visually similar to ties, you’ll want to hide all ties in the tab staff first.</p>

<ol>
  <li>Complete all aspects of your tab except for hammer-ons/pull-offs</li>
  <li>Right-click a tie (if any exist) in your tab staff and choose “Select” &gt; “All Similar Elements in Same Staff”</li>
  <li>Hit <code class="language-plaintext highlighter-rouge">v</code> to toggle all selected ties’ visibility to invisible</li>
  <li>On the starting note of each hammer-on/pull-off, hit <code class="language-plaintext highlighter-rouge">s</code> to create a slur to the next note</li>
</ol>

<h3 id="slides">Slides</h3>

<p>I use a straight glissando for slower slides and an appoggiatura for faster slides. Both marks are available in the “Palettes” pane. Dragging a glissando to the tab staff (as opposed to the standard staff) will produce a clean line without the unnecessary “gliss.” text.</p>

<h3 id="slaps">Slaps</h3>

<ol>
  <li>Enter each slap as an E2 note, i.e. fret 0 on the low E string</li>
  <li>Hold down <code class="language-plaintext highlighter-rouge">Ctrl</code>, select those 0’s, and hit <code class="language-plaintext highlighter-rouge">Shift+X</code> to display them as X’s</li>
  <li>In the standard staff, select the corresponding note heads and set “Head group: Cross” in the Inspector pane</li>
</ol>

<p>Note that these X notes do make sound as E2 during audio playback, although they’re at least low enough to not be overly distracting. MuseScore doesn’t really provide a perfect solution to this problem, pointing to the fact that it’s primarily a score editor and not a score player.</p>

<h2 id="generating-pdfs-from-the-command-line">Generating PDFs from the command line</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mscore input.mscz <span class="nt">-o</span> output.pdf
</code></pre></div></div>

<p>To be extra fancy, you can set up <code class="language-plaintext highlighter-rouge">inotifywait</code> to run this command on save.</p>
]]></description>
      </item>
      
    
      
      <item>
        <title>Bash Style Guide for Mac and Linux</title>
        <link>https://chaidarun.com/bash-style</link>
        <pubDate>Sun, 30 Dec 2018 00:00:00 GMT</pubDate>
        <guid isPermaLink="true">https://chaidarun.com/bash-style</guid>
        
        <description><![CDATA[<p>Yesterday I had the deranged pleasure of writing 1000+ lines of cross-platform Bash, which got me thinking that I could probably save myself some unnecessary googling and/or decision-making in future projects by documenting my stylistic choices and the reasons behind them. I don’t expect that these guidelines will ever be completely finished, but for now:</p>

<ul>
  <li>
    <p><strong>Follow <a href="https://google.github.io/styleguide/shell.xml">Google’s style guide</a> and use <a href="https://github.com/koalaman/shellcheck">ShellCheck</a></strong>. These resources have hundreds of good opinions that will save me a ton of typing here.</p>
  </li>
  <li>
    <p><strong>Stick to Bash 3.</strong> Apple preinstalls a decrepit version of Bash from 2007 because <a href="https://www.reddit.com/r/osx/comments/51v1jg/what_is_the_reason_for_osx_to_use_bash_3257_and/">they don’t like GPL v3</a>. I use Linux but often write scripts for Mac users, so that’s a portability issue I can’t ignore. Although Bash 4 globs and associative arrays must be avoided, older <a href="https://mywiki.wooledge.org/Bashism">bashisms</a> like <code class="language-plaintext highlighter-rouge">[[</code> are totally fine by me.</p>
  </li>
  <li>
    <p><strong>If you must drop into another language, use version-independent Python.</strong> Some simple tasks like percent-encoding and JSON parsing require a more fully featured language than Bash. Macs and all major Linux distros ship with Python included (and Perl too, although Python is rather more hip these days).</p>

    <p><a href="https://en.wikipedia.org/wiki/Here_document">Heredoc</a> syntax lets you declare foreign code snippets inline inside a Bash script. Your code should support both Python 2 and 3 since you’ll likely have end users on both versions. PyPI packages are out of the question—at that point you might as well give up on Bash and switch to either Docker or a statically compiled language.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">readonly </span><span class="nv">response</span><span class="o">=</span><span class="s2">"</span><span class="si">$(</span>curl <span class="nt">-s</span> <span class="s1">'https://example.com'</span><span class="si">)</span><span class="s2">"</span>
python - <span class="o">&lt;&lt;</span> <span class="no">EOF</span><span class="sh">
# -*- coding: utf-8 -*-
import json
for repo, result in sorted(json.loads(r'''</span><span class="k">${</span><span class="nv">response</span><span class="k">}</span><span class="sh">''')['Results'].items()):
  for f in result['Matches']:
    for l in f['Matches']:
      print('%s/%s:%s:%s' % (repo, f['Filename'], l['LineNumber'], l['Line']))
</span><span class="no">EOF
</span><span class="nb">printf</span> <span class="s1">'Hello from Bash land again\n'</span>
</code></pre></div>    </div>

    <p>Note that in this example, the Bash variable <code class="language-plaintext highlighter-rouge">response</code> is interpolated into a raw, triple-quoted Python string as <code class="language-plaintext highlighter-rouge">r'''${response}'''</code> in order to avoid possible issues caused by unescaped characters.</p>
  </li>
  <li>
    <p><strong>Use shebang <code class="language-plaintext highlighter-rouge">#!/usr/bin/env bash</code>.</strong> The most common Bash <a href="https://en.wikipedia.org/wiki/Shebang_(Unix)">shebangs</a> are <code class="language-plaintext highlighter-rouge">/bin/bash</code> and (abusedly) <code class="language-plaintext highlighter-rouge">/bin/sh</code>, but I like to use <code class="language-plaintext highlighter-rouge">env</code> for consistency with other languages’ standard shebangs.</p>
  </li>
  <li>
    <p><strong>Always declare <code class="language-plaintext highlighter-rouge">set -eu</code>.</strong> There’s never a good reason to swallow errors and continue script execution as if nothing happened. There’s <em>sometimes</em> a good reason to allow undeclared variables, but I find it safer to use default values in those cases.</p>
  </li>
  <li>
    <p><strong>Always use <code class="language-plaintext highlighter-rouge">printf</code> instead of <code class="language-plaintext highlighter-rouge">echo</code>.</strong> This one’s a bit controversial. POSIX and Bash’s maintainer both <a href="https://askubuntu.com/a/537987">recommend</a> <code class="language-plaintext highlighter-rouge">printf</code> over <code class="language-plaintext highlighter-rouge">echo</code> for portability and robustness. Dogma aside, I prefer <code class="language-plaintext highlighter-rouge">printf</code> because I often don’t want <code class="language-plaintext highlighter-rouge">echo</code>’s trailing newline, e.g. when piping a string variable into <code class="language-plaintext highlighter-rouge">grep -qE '^foobar$'</code>.</p>
  </li>
  <li>
    <p><strong>Always use <code class="language-plaintext highlighter-rouge">while read -r ... done &lt;</code> to loop through lines.</strong> The <code class="language-plaintext highlighter-rouge">| while</code> form of the loop runs its contents in a subshell, which is rarely desired since any variable assignments that happen in there will be lost.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Bad</span>
<span class="nb">echo</span> <span class="s2">"</span><span class="k">${</span><span class="nv">var</span><span class="k">}</span><span class="s2">"</span> | <span class="k">while </span><span class="nb">read </span>line<span class="p">;</span> <span class="k">do
  </span><span class="nb">printf</span> <span class="s1">'%s\n'</span> <span class="s2">"</span><span class="k">${</span><span class="nv">line</span><span class="k">}</span><span class="s2">"</span>
<span class="k">done</span>

<span class="c"># Good</span>
<span class="k">while </span><span class="nb">read</span> <span class="nt">-r</span> line<span class="p">;</span> <span class="k">do
  </span><span class="nb">printf</span> <span class="s1">'%s\n'</span> <span class="s2">"</span><span class="k">${</span><span class="nv">line</span><span class="k">}</span><span class="s2">"</span>
<span class="k">done</span> <span class="o">&lt;&lt;&lt;</span> <span class="s2">"</span><span class="k">${</span><span class="nv">var</span><span class="k">}</span><span class="s2">"</span>

<span class="c"># Good</span>
<span class="k">while </span><span class="nb">read</span> <span class="nt">-r</span> line<span class="p">;</span> <span class="k">do
  </span><span class="nb">printf</span> <span class="s1">'%s\n'</span> <span class="s2">"</span><span class="k">${</span><span class="nv">line</span><span class="k">}</span><span class="s2">"</span>
<span class="k">done</span> &lt; file.txt

<span class="c"># Good</span>
<span class="k">while </span><span class="nb">read</span> <span class="nt">-r</span> line<span class="p">;</span> <span class="k">do
  </span><span class="nb">printf</span> <span class="s1">'%s\n'</span> <span class="s2">"</span><span class="k">${</span><span class="nv">line</span><span class="k">}</span><span class="s2">"</span>
<span class="k">done</span> &lt; &lt;<span class="o">(</span>find <span class="nb">.</span> <span class="nt">-type</span> f<span class="o">)</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>Always use <code class="language-plaintext highlighter-rouge">[[</code> instead of <code class="language-plaintext highlighter-rouge">[</code>.</strong> The former is a more powerful drop-in replacement for the latter, and it’s simpler to always use <code class="language-plaintext highlighter-rouge">[[</code> rather than remember all of the subtle differences.</p>
  </li>
  <li>
    <p><strong>Always use <code class="language-plaintext highlighter-rouge">${HOME}</code> instead of <code class="language-plaintext highlighter-rouge">~</code>.</strong> Only the former gets expanded inside double-quoted strings.</p>
  </li>
  <li>
    <p><strong>Prefer <code class="language-plaintext highlighter-rouge">shift</code> to <code class="language-plaintext highlighter-rouge">$2</code>.</strong> Calling <code class="language-plaintext highlighter-rouge">shift</code> immediately after reading each command-line argument lets you always refer to them as <code class="language-plaintext highlighter-rouge">$1</code>, which removes the need for a reader of your code to mentally keep track of argument indices and reduces the chance of making mistakes when adding or removing arguments.</p>
  </li>
  <li>
    <p><strong>Never read the same value from <code class="language-plaintext highlighter-rouge">$1</code> twice.</strong> If you’re going to use a command-line argument multiple times, it’s a good defensive practice to immediately store it into a named variable—especially when your program accepts multiple arguments.</p>
  </li>
  <li>
    <p><strong>Print logging messages to stderr in color.</strong> This avoids tainting stdout and makes your logs easier to read and debug.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># I'm calling these functions logX for consistency with Android's Log class</span>

logD<span class="o">()</span> <span class="o">{</span>
  <span class="k">if</span> <span class="o">[[</span> <span class="nt">-n</span> <span class="s2">"</span><span class="k">${</span><span class="nv">DEBUG</span><span class="k">:-}</span><span class="s2">"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
    </span><span class="nb">printf</span> <span class="s1">'%s%s%s\n'</span> <span class="s2">"</span><span class="si">$(</span>tput setaf 4<span class="si">)</span><span class="s2">"</span> <span class="s2">"</span><span class="k">${</span><span class="nv">1</span><span class="k">:-}</span><span class="s2">"</span> <span class="s2">"</span><span class="si">$(</span>tput sgr0<span class="si">)</span><span class="s2">"</span> <span class="o">&gt;</span>&amp;2
  <span class="k">fi</span>
<span class="o">}</span>

logE<span class="o">()</span> <span class="o">{</span>
  <span class="nb">printf</span> <span class="s1">'%s%s%s\n'</span> <span class="s2">"</span><span class="si">$(</span>tput setaf 1<span class="si">)</span><span class="s2">"</span> <span class="s2">"</span><span class="k">${</span><span class="nv">1</span><span class="k">:-}</span><span class="s2">"</span> <span class="s2">"</span><span class="si">$(</span>tput sgr0<span class="si">)</span><span class="s2">"</span> <span class="o">&gt;</span>&amp;2
<span class="o">}</span>

logI<span class="o">()</span> <span class="o">{</span>
  <span class="nb">printf</span> <span class="s1">'%s%s%s\n'</span> <span class="s2">"</span><span class="si">$(</span>tput setaf 2<span class="si">)</span><span class="s2">"</span> <span class="s2">"</span><span class="k">${</span><span class="nv">1</span><span class="k">:-}</span><span class="s2">"</span> <span class="s2">"</span><span class="si">$(</span>tput sgr0<span class="si">)</span><span class="s2">"</span> <span class="o">&gt;</span>&amp;2
<span class="o">}</span>

logE <span class="s1">'I am a red error message'</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>Always use <code class="language-plaintext highlighter-rouge">grep -E</code> instead of <code class="language-plaintext highlighter-rouge">grep -P</code>.</strong> The Mac version of <code class="language-plaintext highlighter-rouge">grep</code> doesn’t support <code class="language-plaintext highlighter-rouge">-P</code>. <a href="https://en.wikibooks.org/wiki/Regular_Expressions/POSIX-Extended_Regular_Expressions">POSIX ERE</a> is usually capable enough; the only <a href="https://en.wikipedia.org/wiki/Perl_Compatible_Regular_Expressions">PCRE</a> feature I regularly miss is multiline matching.</p>
  </li>
  <li>
    <p><strong>Mark all variables <code class="language-plaintext highlighter-rouge">readonly</code> by default.</strong> Code that doesn’t reassign variables all over the place is easier to read. <code class="language-plaintext highlighter-rouge">readonly</code> also alerts you to unintended reassignments. Inside a function, use <code class="language-plaintext highlighter-rouge">local -r</code> instead of <code class="language-plaintext highlighter-rouge">readonly</code> to additionally limit a variable’s scope to that function.</p>
  </li>
  <li>
    <p><strong>Always use <code class="language-plaintext highlighter-rouge">=</code> instead of <code class="language-plaintext highlighter-rouge">==</code> in tests.</strong> <code class="language-plaintext highlighter-rouge">=</code> is equivalent, shorter, and more POSIXy.</p>
  </li>
  <li>
    <p><strong>Prefer <code class="language-plaintext highlighter-rouge">${var:-default}</code> to <code class="language-plaintext highlighter-rouge">${var-default}</code>.</strong> It’s simpler to have only one kind of empty value rather than treating unset and null differently. This behavior is also consistent with string interpolation, where unset variables and null variables both get interpolated as an empty string.</p>
  </li>
  <li>
    <p><strong>Indent a level between <code class="language-plaintext highlighter-rouge">pushd</code> and <code class="language-plaintext highlighter-rouge">popd</code>.</strong> These two commands aren’t actually control flow statements, but indenting them as such improves readability and reduces the chance of mismatches.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Bad</span>
<span class="nb">pushd </span>foo <span class="o">&gt;</span> /dev/null
<span class="nb">printf</span> <span class="s1">'bar\n'</span>
<span class="nb">printf</span> <span class="s1">'baz\n'</span>
<span class="nb">popd</span> <span class="o">&gt;</span> /dev/null

<span class="c"># Good</span>
<span class="nb">pushd </span>foo <span class="o">&gt;</span> /dev/null
  <span class="nb">printf</span> <span class="s1">'bar\n'</span>
  <span class="nb">printf</span> <span class="s1">'baz\n'</span>
<span class="nb">popd</span> <span class="o">&gt;</span> /dev/null
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>Prefer <code class="language-plaintext highlighter-rouge">pushd</code>/<code class="language-plaintext highlighter-rouge">popd</code> to <code class="language-plaintext highlighter-rouge">cd</code>.</strong> Combined with the previous tip, this makes code much easier to follow.</p>
  </li>
  <li>
    <p><strong>Always use <code class="language-plaintext highlighter-rouge">command -v</code> instead of <code class="language-plaintext highlighter-rouge">which</code>.</strong> The former is POSIX compliant and more consistent between GNU (i.e. Linux) and Mac.</p>
  </li>
  <li>
    <p><strong>Trim whitespace from <code class="language-plaintext highlighter-rouge">wc</code> output.</strong> The Mac version of <code class="language-plaintext highlighter-rouge">wc</code> prepends whitespace to its output. You can remove it with <code class="language-plaintext highlighter-rouge">awk</code>:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>find <span class="nb">.</span> <span class="nt">-type</span> f <span class="nt">-name</span> <span class="s1">'*.pyc'</span> | <span class="nb">wc</span> <span class="nt">-l</span> | <span class="nb">awk</span> <span class="s1">'{print $1}'</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>Prefer single quotes to double quotes when interpolating into an <code class="language-plaintext highlighter-rouge">eval</code>.</strong> This is pretty niche, but basically it’s much <a href="https://stackoverflow.com/questions/15783701/which-characters-need-to-be-escaped-when-using-bash#comment71498177_20053121">simpler</a> to programmatically escape characters inside single-quoted strings than inside double-quoted strings. Single-quoted strings only need to escape <code class="language-plaintext highlighter-rouge">'</code>, while double-quoted strings need to escape each of <code class="language-plaintext highlighter-rouge">"$`\</code>.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">readonly </span><span class="nv">json</span><span class="o">=</span><span class="s2">"</span><span class="si">$(</span>&lt; <span class="s1">'request_body.json'</span><span class="si">)</span><span class="s2">"</span>
<span class="nb">readonly </span><span class="nv">curl_command</span><span class="o">=</span><span class="s2">"curl 'https://example.com' -d '</span><span class="k">${</span><span class="nv">json</span><span class="p">//\</span><span class="s1">'/\'</span><span class="p">\\\</span><span class="s1">'\'</span><span class="k">}</span><span class="s2">'"</span>
<span class="nb">printf</span> <span class="s1">'%s\n'</span> <span class="s2">"</span><span class="k">${</span><span class="nv">curl_command</span><span class="k">}</span><span class="s2">"</span>
<span class="nb">eval</span> <span class="s2">"</span><span class="k">${</span><span class="nv">curl_command</span><span class="k">}</span><span class="s2">"</span>
</code></pre></div>    </div>

    <p>Note that <code class="language-plaintext highlighter-rouge">printf %q</code> also does the job, but it’s supposedly less reliable due to <a href="https://stackoverflow.com/questions/15783701/which-characters-need-to-be-escaped-when-using-bash#comment71234255_27817504">bugginess</a> in old versions.</p>
  </li>
</ul>
]]></description>
      </item>
      
    
      
      <item>
        <title>How to Connect to an L2TP/IPsec VPN from Linux</title>
        <link>https://chaidarun.com/l2tp-ipsec</link>
        <pubDate>Wed, 26 Dec 2018 00:00:00 GMT</pubDate>
        <guid isPermaLink="true">https://chaidarun.com/l2tp-ipsec</guid>
        
        <description><![CDATA[<p>I needed to connect a Linux client to an <a href="https://en.wikipedia.org/wiki/Layer_2_Tunneling_Protocol#L2TP/IPsec">L2TP/IPsec</a> VPN using shared secret (a.k.a. pre-shared key) authentication, but every online guide I could find was inaccurate and/or incomplete. Here’s a fully working solution at the time of writing.</p>

<p>The initial 10-minute setup is pretty tedious, but once you’ve got it working you can throw it all into a script and never worry about it again.</p>

<blockquote>
  <p><span class="badge" title="2021-03-21">Update</span> A less-than-ideal but much easier fix is to build xl2tpd from source with one problematic line <a href="https://github.com/xelerance/xl2tpd/issues/136#issuecomment-365761037">commented out</a> and save <code class="language-plaintext highlighter-rouge">: PSK "sh4r3ds3cr3t"</code> to <code class="language-plaintext highlighter-rouge">/etc/ipsec.secrets</code>. This allows the use of Libreswan and NetworkManager, although on Arch Linux I also had to <code class="language-plaintext highlighter-rouge">sudo mkdir -p /var/lib/ipsec/nss</code> since that directory wasn’t created during Libreswan installation (?!)</p>
</blockquote>

<h2 id="walkthrough">Walkthrough</h2>

<p>Let’s say you want to connect to a VPN server with public IP address <code class="language-plaintext highlighter-rouge">68.68.32.79</code> and shared secret <code class="language-plaintext highlighter-rouge">sh4r3ds3cr3t</code>. Your user account on the VPN server is <code class="language-plaintext highlighter-rouge">johndoe</code> with password <code class="language-plaintext highlighter-rouge">j0hn5p455w0rd</code>.</p>

<ol>
  <li>
    <p>Install <a href="https://www.openswan.org/">Openswan</a> for IPsec and <a href="https://github.com/xelerance/xl2tpd">xl2tpd</a> for L2TP:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Arch Linux</span>
pacaur <span class="nt">-S</span> openswan xl2tpd

<span class="c"># Ubuntu</span>
apt-get update <span class="o">&amp;&amp;</span> apt-get <span class="nb">install </span>openswan xl2tpd
</code></pre></div>    </div>
  </li>
  <li>
    <p>Run <code class="language-plaintext highlighter-rouge">ip route show default</code> to determine your local IP and default network interface. They should be the 3rd and 5th items in the single line of output. Let’s say they’re <code class="language-plaintext highlighter-rouge">192.168.1.1</code> and <code class="language-plaintext highlighter-rouge">eth0</code>.</p>
  </li>
  <li>
    <p>As root, create these four files, plugging in the six variables we’ve gotten so far:</p>

    <h3 id="etcipsecconf">/etc/ipsec.conf</h3>

    <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>version 2.0

config setup
  virtual_private=%v4:10.0.0.0/8,%v4:192.168.0.0/16,%v4:172.16.0.0/12
  nat_traversal=yes
  protostack=netkey
  plutoopts="--interface=eth0"

conn L2TP-PSK
  authby=secret
  pfs=no
  auto=add
  keyingtries=3
  dpddelay=30
  dpdtimeout=120
  dpdaction=clear
  rekey=yes
  ikelifetime=8h
  keylife=1h
  type=transport
  left=%defaultroute
  leftnexthop=%defaultroute
  leftprotoport=17/1701
  right=68.68.32.79
</code></pre></div>    </div>

    <h3 id="etcipsecsecrets">/etc/ipsec.secrets</h3>

    <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.0.0.0 68.68.32.79: PSK "sh4r3ds3cr3t"
</code></pre></div>    </div>

    <h3 id="etcxl2tpdxl2tpdconf">/etc/xl2tpd/xl2tpd.conf</h3>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[lac vpn-connection]
lns = 68.68.32.79
refuse chap = yes
refuse pap = yes
require authentication = yes
name = vpn-server
ppp debug = yes
pppoptfile = /etc/ppp/options.l2tpd.client
length bit = yes
</code></pre></div>    </div>

    <h3 id="etcpppoptionsl2tpdclient">/etc/ppp/options.l2tpd.client</h3>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ipcp-accept-local
ipcp-accept-remote
refuse-eap
require-mschap-v2
noccp
noauth
idle 1800
mtu 1410
mru 1410
defaultroute
usepeerdns
debug
connect-delay 5000
name johndoe
password j0hn5p455w0rd
</code></pre></div>    </div>
  </li>
  <li>
    <p>Start Openswan and xl2tpd. These three commands, along with all other commands in the remainder of this walkthrough, should be run as root:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ipsec setup <span class="nt">--start</span>
xl2tpd <span class="nt">-D</span> &amp;
ipsec auto <span class="nt">--up</span> L2TP-PSK
</code></pre></div>    </div>
  </li>
  <li>
    <p>Connect to the VPN:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s1">'c vpn-connection'</span> <span class="o">&gt;</span> /var/run/xl2tpd/l2tp-control
</code></pre></div>    </div>
  </li>
  <li>
    <p>Determine the name of the <a href="https://en.wikipedia.org/wiki/Point-to-Point_Protocol">PPP</a> network interface by running <code class="language-plaintext highlighter-rouge">ip address</code> and looking for the entry containing <code class="language-plaintext highlighter-rouge">ppp</code>. Let’s say it’s called <code class="language-plaintext highlighter-rouge">ppp0</code>. Now look inside its entry for the word “peer” and the local IP that immediately follows it. Let’s say the peer IP is <code class="language-plaintext highlighter-rouge">10.1.14.252</code>. This is the VPN server’s local IP.</p>
  </li>
  <li>
    <p>Add a rule to route subnet traffic through the VPN. <code class="language-plaintext highlighter-rouge">10.0.0.0/8</code> is <a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing#CIDR_notation">CIDR notation</a> for the range of local IPs assigned inside your remote network. It doesn’t need to be exact. For example, you can use <code class="language-plaintext highlighter-rouge">10.0.0.0/8</code> to specify that all IPs of the form <code class="language-plaintext highlighter-rouge">10.*.*.*</code> belong to the VPN even if you suspect that your remote network only assigns IPs of the form <code class="language-plaintext highlighter-rouge">10.1.10.*</code> and <code class="language-plaintext highlighter-rouge">10.1.14.*</code>.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ip route add 10.0.0.0/8 via 10.1.14.252 dev ppp0
</code></pre></div>    </div>

    <p>You can test the new rule by pinging or SSHing the local IP of another machine inside the VPN. If that’s all you need, you can stop here.</p>
  </li>
  <li>
    <p>Remember the variables we found in step 2? Use them here to route <em>all</em> internet traffic (not just subnet traffic) through the VPN:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ip route add 68.68.32.79 via 192.168.1.1 dev eth0
ip route delete default via 192.168.1.1 dev eth0
ip route add default via 10.1.14.252 dev ppp0
</code></pre></div>    </div>
  </li>
</ol>

<p>Done! You can now open your web browser and access VPN-only resources. To disconnect:</p>

<ol>
  <li>
    <p>Undo the routing rules:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ip route delete default via 10.1.14.252 dev ppp0
ip route add default via 192.168.1.1 dev eth0
ip route delete 68.68.32.79 via 192.168.1.1 dev eth0
</code></pre></div>    </div>
  </li>
  <li>
    <p>Kill the VPN connection, xl2tpd, and Openswan:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s1">'d vpn-connection'</span> <span class="o">&gt;</span> /var/run/xl2tpd/l2tp-control
ipsec auto <span class="nt">--down</span> L2TP-PSK
killall xl2tpd
ipsec setup <span class="nt">--stop</span>
</code></pre></div>    </div>
  </li>
</ol>

<h2 id="caveats">Caveats</h2>

<p>I don’t recommend switching from Ethernet to Wi-Fi or vice versa while connected to the VPN since that will change the default network interface (<code class="language-plaintext highlighter-rouge">eth0</code> in our example) and possibly leave your routing table in a weird state until reboot.</p>

<p>These instructions assume that you regularly use only one L2TP/IPsec VPN. It’s straightforward to simply add a new section to the <code class="language-plaintext highlighter-rouge">.conf</code> files for each additional VPN, but the script below doesn’t support that use case out of the box.</p>

<p>I’ve only tested this on Arch Linux. Let me know if your distro needs any tweaks!</p>

<h2 id="script">Script</h2>

<p>Once you’ve successfully executed the steps above by hand, you can automate them all using a script like the one below. I normally run it as <code class="language-plaintext highlighter-rouge">sudo ./vpn toggle</code>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/env bash</span>
<span class="c">#</span>
<span class="c"># Enables or disables a client connection to an L2TP/IPsec VPN. Usage: save</span>
<span class="c"># this file as `vpn`, `chmod +x` it, and run `./vpn [up/down/toggle]` as root.</span>
<span class="c"># Requires openswan and xl2tpd packages. Tested on Arch Linux.</span>
<span class="c">#</span>
<span class="c"># Based on:</span>
<span class="c">#   https://bbs.archlinux.org/viewtopic.php?pid=1773313#p1773313</span>
<span class="c">#   https://bbs.archlinux.org/viewtopic.php?pid=1781882#p1781882</span>
<span class="c">#</span>
<span class="c"># Example `ip route` output before connecting to VPN:</span>
<span class="c">#   default via 192.168.1.1 dev wlp4s0 proto dhcp src 192.168.1.7 metric 303</span>
<span class="c">#   10.1.14.252 dev ppp0 proto kernel scope link src 10.1.16.107</span>
<span class="c">#   192.168.1.0/24 dev wlp4s0 proto dhcp scope link src 192.168.1.7 metric 303</span>
<span class="c">#</span>
<span class="c"># Example `ip route` output after connecting to VPN:</span>
<span class="c">#   default via 10.1.14.252 dev ppp0</span>
<span class="c">#   10.0.0.0/8 via 10.1.14.252 dev ppp0</span>
<span class="c">#   10.1.14.252 dev ppp0 proto kernel scope link src 10.1.16.107</span>
<span class="c">#   71.245.184.58 via 192.168.1.1 dev wlp4s0</span>
<span class="c">#   192.168.1.0/24 dev wlp4s0 proto dhcp scope link src 192.168.1.7 metric 303</span>

<span class="nb">set</span> <span class="nt">-eu</span>

<span class="c"># VPN settings (edit these!)</span>
<span class="nv">vpn_server_public_ip</span><span class="o">=</span><span class="s1">'68.68.32.79'</span>
<span class="nv">vpn_subnet</span><span class="o">=</span><span class="s1">'10.0.0.0/8'</span>
<span class="nv">vpn_pingee_local_ip</span><span class="o">=</span><span class="s1">'10.1.10.22'</span>
<span class="nv">vpn_shared_secret</span><span class="o">=</span><span class="s1">'sh4r3ds3cr3t'</span>
<span class="nv">vpn_username</span><span class="o">=</span><span class="s1">'johndoe'</span>
<span class="nv">vpn_password</span><span class="o">=</span><span class="s1">'j0hn5p455w0rd'</span>

<span class="c"># Ensure that we're running as root</span>
<span class="k">if</span> <span class="o">[[</span> <span class="s2">"</span><span class="si">$(</span><span class="nb">id</span> <span class="nt">-u</span><span class="si">)</span><span class="s2">"</span> <span class="o">!=</span> 0 <span class="o">]]</span><span class="p">;</span> <span class="k">then
  </span><span class="nb">echo</span> <span class="s1">'Must run as root!'</span>
  <span class="nb">exit </span>1
<span class="k">fi</span>

<span class="c"># Ensure that required packages are installed</span>
<span class="k">if</span> <span class="o">!</span> <span class="nb">command</span> <span class="nt">-v</span> ipsec <span class="o">&gt;</span> /dev/null<span class="p">;</span> <span class="k">then
  </span><span class="nb">echo</span> <span class="s1">'`ipsec` command not found! Please install Openswan.'</span>
  <span class="nb">exit </span>1
<span class="k">fi
if</span> <span class="o">!</span> <span class="nb">command</span> <span class="nt">-v</span> xl2tpd <span class="o">&gt;</span> /dev/null<span class="p">;</span> <span class="k">then
  </span><span class="nb">echo</span> <span class="s1">'`xl2tpd` command not found! Please install xl2tpd.'</span>
  <span class="nb">exit </span>1
<span class="k">fi</span>

<span class="c"># Handle subcommands</span>
<span class="nv">subcommand</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">1</span><span class="p">-</span><span class="k">}</span><span class="s2">"</span>
<span class="k">if</span> <span class="o">[[</span> <span class="s2">"</span><span class="k">${</span><span class="nv">subcommand</span><span class="k">}</span><span class="s2">"</span> <span class="o">=</span> <span class="s1">'toggle'</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
  if </span>ip address | <span class="nb">grep</span> <span class="nt">-q</span> <span class="s1">': ppp'</span><span class="p">;</span> <span class="k">then
    </span><span class="nv">subcommand</span><span class="o">=</span><span class="s1">'down'</span>
  <span class="k">else
    </span><span class="nv">subcommand</span><span class="o">=</span><span class="s1">'up'</span>
  <span class="k">fi
fi
case</span> <span class="s2">"</span><span class="k">${</span><span class="nv">subcommand</span><span class="k">}</span><span class="s2">"</span> <span class="k">in</span>
  <span class="c"># Connect to VPN</span>
  up<span class="p">)</span>
    <span class="c"># Ensure that we're not already connected</span>
    <span class="k">if </span>ip address | <span class="nb">grep</span> <span class="nt">-q</span> <span class="s1">': ppp'</span><span class="p">;</span> <span class="k">then
      </span><span class="nb">echo</span> <span class="s1">'Already connected to VPN!'</span>
      <span class="nb">exit </span>1
    <span class="k">fi</span>

    <span class="c"># Write config files</span>
    <span class="nv">default_network_device</span><span class="o">=</span><span class="s2">"</span><span class="si">$(</span>ip route show default | <span class="nb">cut</span> <span class="nt">-d</span><span class="s1">' '</span> <span class="nt">-f5</span><span class="si">)</span><span class="s2">"</span>
    <span class="nb">cat</span> <span class="o">&gt;</span> /etc/ipsec.conf <span class="o">&lt;&lt;</span> <span class="no">EOF</span><span class="sh">
version 2.0

config setup
  virtual_private=%v4:10.0.0.0/8,%v4:192.168.0.0/16,%v4:172.16.0.0/12
  nat_traversal=yes
  protostack=netkey
  plutoopts="--interface=</span><span class="k">${</span><span class="nv">default_network_device</span><span class="k">}</span><span class="sh">"

conn L2TP-PSK
  authby=secret
  pfs=no
  auto=add
  keyingtries=3
  dpddelay=30
  dpdtimeout=120
  dpdaction=clear
  rekey=yes
  ikelifetime=8h
  keylife=1h
  type=transport
  left=%defaultroute
  leftnexthop=%defaultroute
  leftprotoport=17/1701
  right=</span><span class="k">${</span><span class="nv">vpn_server_public_ip</span><span class="k">}</span><span class="sh">
</span><span class="no">EOF
</span>    <span class="nb">cat</span> <span class="o">&gt;</span> /etc/ipsec.secrets <span class="o">&lt;&lt;</span> <span class="no">EOF</span><span class="sh">
0.0.0.0 </span><span class="k">${</span><span class="nv">vpn_server_public_ip</span><span class="k">}</span><span class="sh">: PSK "</span><span class="k">${</span><span class="nv">vpn_shared_secret</span><span class="k">}</span><span class="sh">"
</span><span class="no">EOF
</span>    <span class="nb">cat</span> <span class="o">&gt;</span> /etc/xl2tpd/xl2tpd.conf <span class="o">&lt;&lt;</span> <span class="no">EOF</span><span class="sh">
[lac vpn-connection]
lns = </span><span class="k">${</span><span class="nv">vpn_server_public_ip</span><span class="k">}</span><span class="sh">
refuse chap = yes
refuse pap = yes
require authentication = yes
name = vpn-server
ppp debug = yes
pppoptfile = /etc/ppp/options.l2tpd.client
length bit = yes
</span><span class="no">EOF
</span>    <span class="nb">cat</span> <span class="o">&gt;</span> /etc/ppp/options.l2tpd.client <span class="o">&lt;&lt;</span> <span class="no">EOF</span><span class="sh">
ipcp-accept-local
ipcp-accept-remote
refuse-eap
require-mschap-v2
noccp
noauth
idle 1800
mtu 1410
mru 1410
defaultroute
usepeerdns
debug
connect-delay 5000
name </span><span class="k">${</span><span class="nv">vpn_username</span><span class="k">}</span><span class="sh">
password </span><span class="k">${</span><span class="nv">vpn_password</span><span class="k">}</span><span class="sh">
</span><span class="no">EOF

</span>    <span class="c"># Start Openswan</span>
    ipsec setup <span class="nt">--start</span>
    ipsec setup <span class="nt">--status</span> | <span class="nb">grep</span> <span class="nt">-q</span> <span class="s1">'IPsec running'</span>

    <span class="c"># Start xl2tpd</span>
    xl2tpd <span class="nt">-D</span> &amp;
    <span class="nb">sleep </span>1
    ipsec auto <span class="nt">--up</span> L2TP-PSK
    ipsec setup <span class="nt">--status</span> | <span class="nb">grep</span> <span class="nt">-q</span> <span class="s1">'1 tunnels up'</span>

    <span class="c"># Connect to VPN</span>
    <span class="nb">echo</span> <span class="s1">'c vpn-connection'</span> <span class="o">&gt;</span> /var/run/xl2tpd/l2tp-control
    <span class="k">while </span><span class="nb">true</span><span class="p">;</span> <span class="k">do
      </span><span class="nb">sleep </span>1
      <span class="nv">ppp_device</span><span class="o">=</span><span class="s2">"</span><span class="si">$(</span>ip address | <span class="nb">grep</span> <span class="nt">-oE</span> <span class="s1">'^[0-9]+: ppp\w+'</span> | <span class="nb">cut</span> <span class="nt">-d</span><span class="s1">' '</span> <span class="nt">-f2</span><span class="si">)</span><span class="s2">"</span>
      <span class="k">if</span> <span class="o">[[</span> <span class="nt">-n</span> <span class="s2">"</span><span class="k">${</span><span class="nv">ppp_device</span><span class="k">}</span><span class="s2">"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
        </span><span class="nb">break
      </span><span class="k">fi
      </span><span class="nb">echo</span> <span class="s1">'Waiting for ppp device...'</span>
    <span class="k">done
    </span><span class="nv">peer_ip</span><span class="o">=</span><span class="s2">"</span><span class="si">$(</span>ip address show <span class="s2">"</span><span class="k">${</span><span class="nv">ppp_device</span><span class="k">}</span><span class="s2">"</span> | <span class="nb">grep</span> <span class="nt">-oE</span> <span class="s1">'peer [0-9.]+'</span> | <span class="nb">cut</span> <span class="nt">-d</span><span class="s1">' '</span> <span class="nt">-f2</span><span class="si">)</span><span class="s2">"</span>
    ip route add <span class="s2">"</span><span class="k">${</span><span class="nv">vpn_subnet</span><span class="k">}</span><span class="s2">"</span> via <span class="s2">"</span><span class="k">${</span><span class="nv">peer_ip</span><span class="k">}</span><span class="s2">"</span> dev <span class="s2">"</span><span class="k">${</span><span class="nv">ppp_device</span><span class="k">}</span><span class="s2">"</span>
    <span class="o">[[</span> <span class="nt">-z</span> <span class="s2">"</span><span class="k">${</span><span class="nv">vpn_pingee_local_ip</span><span class="k">}</span><span class="s2">"</span> <span class="o">]]</span> <span class="o">||</span> ping <span class="nt">-c</span> 1 <span class="s2">"</span><span class="k">${</span><span class="nv">vpn_pingee_local_ip</span><span class="k">}</span><span class="s2">"</span>

    <span class="c"># Route all internet traffic through VPN</span>
    <span class="nv">local_ip</span><span class="o">=</span><span class="s2">"</span><span class="si">$(</span>ip route show default | <span class="nb">cut</span> <span class="nt">-d</span><span class="s1">' '</span> <span class="nt">-f3</span><span class="si">)</span><span class="s2">"</span>
    ip route add <span class="s2">"</span><span class="k">${</span><span class="nv">vpn_server_public_ip</span><span class="k">}</span><span class="s2">"</span> via <span class="s2">"</span><span class="k">${</span><span class="nv">local_ip</span><span class="k">}</span><span class="s2">"</span> dev <span class="s2">"</span><span class="k">${</span><span class="nv">default_network_device</span><span class="k">}</span><span class="s2">"</span>
    ip route delete default via <span class="s2">"</span><span class="k">${</span><span class="nv">local_ip</span><span class="k">}</span><span class="s2">"</span> dev <span class="s2">"</span><span class="k">${</span><span class="nv">default_network_device</span><span class="k">}</span><span class="s2">"</span>
    ip route add default via <span class="s2">"</span><span class="k">${</span><span class="nv">peer_ip</span><span class="k">}</span><span class="s2">"</span> dev <span class="s2">"</span><span class="k">${</span><span class="nv">ppp_device</span><span class="k">}</span><span class="s2">"</span>
    <span class="p">;;</span>

  <span class="c"># Disconnect from VPN</span>
  down<span class="p">)</span>
    <span class="c"># Ensure that we're already connected</span>
    <span class="k">if</span> <span class="o">!</span> ip address | <span class="nb">grep</span> <span class="nt">-q</span> <span class="s1">': ppp'</span><span class="p">;</span> <span class="k">then
      </span><span class="nb">echo</span> <span class="s1">'Not connected to VPN!'</span>
      <span class="nb">exit </span>1
    <span class="k">fi</span>

    <span class="c"># Undo routing rules</span>
    <span class="nv">default_network_device</span><span class="o">=</span><span class="s2">"</span><span class="si">$(</span>ip route show <span class="s2">"</span><span class="k">${</span><span class="nv">vpn_server_public_ip</span><span class="k">}</span><span class="s2">"</span> | <span class="nb">cut</span> <span class="nt">-d</span><span class="s1">' '</span> <span class="nt">-f5</span><span class="si">)</span><span class="s2">"</span>
    <span class="nv">ppp_device</span><span class="o">=</span><span class="s2">"</span><span class="si">$(</span>ip address | <span class="nb">grep</span> <span class="nt">-oE</span> <span class="s1">'^[0-9]+: ppp\w+'</span> | <span class="nb">cut</span> <span class="nt">-d</span><span class="s1">' '</span> <span class="nt">-f2</span><span class="si">)</span><span class="s2">"</span>
    <span class="nv">peer_ip</span><span class="o">=</span><span class="s2">"</span><span class="si">$(</span>ip address show <span class="s2">"</span><span class="k">${</span><span class="nv">ppp_device</span><span class="k">}</span><span class="s2">"</span> | <span class="nb">grep</span> <span class="nt">-oE</span> <span class="s1">'peer [0-9.]+'</span> | <span class="nb">cut</span> <span class="nt">-d</span><span class="s1">' '</span> <span class="nt">-f2</span><span class="si">)</span><span class="s2">"</span>
    <span class="nv">local_ip</span><span class="o">=</span><span class="s2">"</span><span class="si">$(</span>ip route show <span class="s2">"</span><span class="k">${</span><span class="nv">vpn_server_public_ip</span><span class="k">}</span><span class="s2">"</span> | <span class="nb">cut</span> <span class="nt">-d</span><span class="s1">' '</span> <span class="nt">-f3</span><span class="si">)</span><span class="s2">"</span>
    ip route delete default via <span class="s2">"</span><span class="k">${</span><span class="nv">peer_ip</span><span class="k">}</span><span class="s2">"</span> dev <span class="s2">"</span><span class="k">${</span><span class="nv">ppp_device</span><span class="k">}</span><span class="s2">"</span>
    ip route add default via <span class="s2">"</span><span class="k">${</span><span class="nv">local_ip</span><span class="k">}</span><span class="s2">"</span> dev <span class="s2">"</span><span class="k">${</span><span class="nv">default_network_device</span><span class="k">}</span><span class="s2">"</span>
    ip route delete <span class="s2">"</span><span class="k">${</span><span class="nv">vpn_server_public_ip</span><span class="k">}</span><span class="s2">"</span> via <span class="s2">"</span><span class="k">${</span><span class="nv">local_ip</span><span class="k">}</span><span class="s2">"</span> dev <span class="s2">"</span><span class="k">${</span><span class="nv">default_network_device</span><span class="k">}</span><span class="s2">"</span>

    <span class="c"># Kill VPN connection</span>
    <span class="nb">echo</span> <span class="s1">'d vpn-connection'</span> <span class="o">&gt;</span> /var/run/xl2tpd/l2tp-control
    <span class="nb">sleep </span>1

    <span class="c"># Kill xl2tpd</span>
    ipsec auto <span class="nt">--down</span> L2TP-PSK
    killall xl2tpd
    <span class="nb">sleep </span>1

    <span class="c"># Kill Openswan</span>
    ipsec setup <span class="nt">--stop</span>
    <span class="p">;;</span>

  <span class="k">*</span><span class="p">)</span>
    <span class="nb">echo</span> <span class="s1">'Invalid subcommand!'</span>
    <span class="nb">exit </span>1
    <span class="p">;;</span>
<span class="k">esac</span>

<span class="nb">echo</span> <span class="s1">'Success!'</span>
</code></pre></div></div>
]]></description>
      </item>
      
    
      
      <item>
        <title>How to Replace Dropbox with Syncthing</title>
        <link>https://chaidarun.com/dropbox-syncthing</link>
        <pubDate>Thu, 17 Aug 2017 00:00:00 GMT</pubDate>
        <guid isPermaLink="true">https://chaidarun.com/dropbox-syncthing</guid>
        
        <description><![CDATA[<p>Dropbox is convenient, but there are several reasons why you might want to drop it:</p>

<ul>
  <li>You feel <a href="https://www.troyhunt.com/the-dropbox-hack-is-real/">uneasy</a> about handing sensitive personal info to strangers</li>
  <li>You find the Dropbox client too resource hungry or <a href="http://applehelpwriter.com/2016/08/29/discovering-how-dropbox-hacks-your-mac/">invasive</a></li>
  <li>You don’t want to pay for storage beyond the free 2 GB</li>
</ul>

<p>The most popular open source, self-hosted alternatives to Dropbox are <a href="https://owncloud.org/">ownCloud</a>, <a href="https://www.seafile.com/en/home/">Seafile</a>, and <a href="https://syncthing.net/">Syncthing</a>. I went with Syncthing mainly because it’s the smallest and simplest, following the Unix philosophy of doing one thing well. Much of its simplicity stems from the fact that Syncthing uses a peer-to-peer protocol as opposed to the other options’ client-server models.</p>

<p class="text-centered">
  <img alt="Dropbox logo" src="https://chaidarun.com/img/dropbox.png" style="margin:10px 25px" />
  <img alt="Syncthing logo" src="https://chaidarun.com/img/syncthing.png" style="margin:10px 25px" />
</p>

<p>Here’s how I made the switch:</p>

<ol>
  <li>
    <p><strong>Set up a home server</strong></p>

    <p>In other words, obtain a computer that you can keep running 24/7. It doesn’t need to be especially powerful: I use a Raspberry Pi attached to a portable 2 TB HDD. Plugging your server into a <a href="https://en.wikipedia.org/wiki/Uninterruptible_power_supply">UPS</a> is a nice touch.</p>

    <p>It’s important to have at least one peer always online so that <em>someone</em> can provide a complete copy of your files at any given time. No syncing can ever actually take place if your devices never have the opportunity to sync with each other!</p>

    <p>But wait, doesn’t this scheme sound more like client-server than peer-to-peer? The P2P aspect becomes more important in the event that your home server goes offline for whatever reason, e.g. your house burning down. That would be a single point of failure if not for the fact that your
remaining devices can continue syncing among themselves as peers. (The <a href="https://www.hanselman.com/blog/TheComputerBackupRuleOfThree.aspx">ideal</a> setup is to have two “server” peers located in different cities in order to protect your data from catastrophes that could otherwise wipe out your entire network of synced devices.)</p>
  </li>
  <li>
    <p><strong><a href="https://syncthing.net/#get-started">Install</a> Syncthing on your devices</strong></p>

    <p>On Linux, I additionally use <a href="https://github.com/syncthing/syncthing-gtk">Syncthing-GTK</a> for laptops and <a href="https://github.com/syncthing/syncthing-inotify">Syncthing-inotify</a> for my headless home server.</p>

    <p>On Android, I use the unofficial <a href="https://play.google.com/store/apps/details?id=it.anyplace.syncbrowser">Anyplace Sync Browser</a> app. It’s bare-bones but much more practical than the <a href="https://play.google.com/store/apps/details?id=com.nutomic.syncthingandroid&amp;hl=en">official app</a> because it downloads files on demand instead of copying all of the files in your sync folder onto your phone. (Yes, you can have multiple top-level sync folders, but that’s more complexity than I care for right now.)</p>

    <blockquote>
      <p><span class="badge" title="2017-11-30">Update</span> To use Anyplace Sync Browser on Nougat or above, you’ll need to go into the system settings and manually grant it the “Storage” permission. Now I just use the official Syncthing app, though, since my current phone has enough space to fit my entire sync folder.</p>
    </blockquote>
  </li>
  <li>
    <p><strong>Make your Dropbox folder your Syncthing folder</strong></p>

    <p>Before firing up Syncthing for the first time, stop Dropbox on all of your devices to prevent conflicts. Then start Syncthing on your home server. After it creates the <a href="https://docs.syncthing.net/intro/getting-started.html#syncthing">default files</a>, stop Syncthing. Locate the newly created sync folder, e.g. <code class="language-plaintext highlighter-rouge">~/Sync/default</code>.</p>

    <p>Now that both Dropbox and Syncthing are off, it’s safe to symlink <code class="language-plaintext highlighter-rouge">~/Sync/default</code> to <code class="language-plaintext highlighter-rouge">~/Dropbox</code> or wherever your existing Dropbox folder is located. Alternatively, you can simply move/copy everything from your Dropbox folder into the new Syncthing folder.</p>

    <p>Start Syncthing again on your home server. On each of your other devices, you can now start Syncthing, add your home server as a remote device, and share the default sync folder. Adding the home server as an “introducer” has the benefit of automatically creating share connections among your non-home-server devices.</p>
  </li>
  <li>
    <p><strong>Enable file versioning</strong></p>

    <p>One creepy but lifesaving feature of Dropbox is that it stores every version of every synced file ever. In contrast, a real danger with Syncthing is that file deletion propagates to all devices and is irreversible by default (unless, of course, the deleting device moved the file into a trash can folder somewhere).</p>

    <p>Fortunately, you can tell Syncthing to use either its own <a href="https://docs.syncthing.net/users/versioning.html#trash-can-file-versioning">trash can</a> or Dropbox-style <a href="https://docs.syncthing.net/users/versioning.html#staggered-file-versioning">file versioning</a>. Whenever you delete or modify a file in a versioned sync folder, Syncthing places a timestamped copy of the original file into a special <code class="language-plaintext highlighter-rouge">.stversions</code> subdirectory of the sync folder. I’ve enabled staggered file versioning with no maximum age on my home server.</p>

    <p><em>After enabling file versioning, you may notice this minor <a href="https://forum.syncthing.net/t/why-does-rename-move-put-file-s-in-stversions-dir/2757">quirk</a>. It really makes no practical difference, but if you’re OCD about that stuff then you may take interest in this <a href="https://github.com/artnc/syncthing-dedupe">script</a> I wrote.</em></p>
  </li>
  <li>
    <p><strong>Optional: Access your home server from the public internet</strong></p>

    <p>Maybe you want to check out your home server’s <a href="https://docs.syncthing.net/intro/getting-started.html#configuring">Syncthing dashboard</a>, or maybe you want to remotely restore some deleted files from your home server’s <code class="language-plaintext highlighter-rouge">.stversions</code>. How do you connect to your server when you’re not at home?</p>

    <p><img src="https://chaidarun.com/img/home-server.jpg" alt="Home server" /></p>

    <p>You’ll first need to go home and open ports on your router, whose admin panel is typically accessible at <a href="http://192.168.0.1/">192.168.0.1</a> or <a href="http://192.168.0.1/">192.168.1.1</a>. Look for the <a href="https://en.wikipedia.org/wiki/Port_forwarding">port forwarding</a> settings and map the router’s port 8384 to your home server’s port 8384. The Syncthing dashboard runs on port 8384; you can also open ports for other programs like SSH<sup id="fnref:ssh"><a href="https://chaidarun.com/dropbox-syncthing#fn:ssh" class="footnote" rel="footnote" role="doc-noteref">1</a></sup>. This wiring step is necessary because all devices on your home network share the same public IP address (e.g. <code class="language-plaintext highlighter-rouge">123.45.67.89</code>), and so your router needs to know which one of them should handle incoming address-port combinations like <code class="language-plaintext highlighter-rouge">123.45.67.89:8384</code>.</p>

    <p>You can now remotely view your home server’s Syncthing dashboard by going to <code class="language-plaintext highlighter-rouge">https://123.45.67.89:8384/</code> in your web browser. Go into the dashboard settings and set a password so that nobody else will be able to view it.</p>

    <p>One last thing: that IP address is hard to remember and not even guaranteed to stay the same forever! Registering for a free subdomain with a service like <a href="http://freedns.afraid.org/subdomain/">FreeDNS</a> will let you access your server via something more reasonable like <code class="language-plaintext highlighter-rouge">https://johndoe.jumpingcrab.com:8384/</code>. FreeDNS works by giving you a cron script for your home server that periodically sends your router’s current IP address to the <a href="https://en.wikipedia.org/wiki/RAS_syndrome">FreeDNS DNS servers</a>, which in turn map it to a human-readable domain name.</p>
  </li>
</ol>

<p>In the end, this is all a bit of legwork but definitely worth the peace of mind. I’ve found my holy grail of a sync/backup solution that’s free (in both senses), secure, fast, simple, and robust.</p>
<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:ssh">
      <p>If you do decide to expose SSH, either map your server’s port 22 to a different port number on your router or edit your server’s SSH config to use a port other than 22. This simple security-through-obscurity measure defeats the 99% of login bots that target the default SSH port. <a href="https://chaidarun.com/dropbox-syncthing#fnref:ssh" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>
]]></description>
      </item>
      
    
      
      <item>
        <title>Get a Guitalele Already</title>
        <link>https://chaidarun.com/guitalele</link>
        <pubDate>Wed, 24 May 2017 00:00:00 GMT</pubDate>
        <guid isPermaLink="true">https://chaidarun.com/guitalele</guid>
        
        <description><![CDATA[<p>The <a href="https://en.wikipedia.org/wiki/Guitalele">guitalele</a> is a miniature guitar built like a ukulele, and it should be your next—or even first—musical instrument.</p>

<div class="youtube-wrap">
  <iframe src="https://www.youtube.com/embed/SsBU2m9WSM4"></iframe>
</div>

<p>For comparison with any instruments you might already play, here are my flamebaity ratings of several instruments’ qualities:</p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th>Fun</th>
      <th>Versatility</th>
      <th>Portability</th>
      <th>Affordability</th>
      <th>Learnability</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Acoustic guitar</td>
      <td>★★★★</td>
      <td>★★★★★</td>
      <td>★★★</td>
      <td>★★★</td>
      <td>★★★</td>
    </tr>
    <tr>
      <td>Bass guitar</td>
      <td>★★</td>
      <td>★</td>
      <td>★★★</td>
      <td>★★★</td>
      <td>★★★★</td>
    </tr>
    <tr>
      <td>Clarinet</td>
      <td>★★</td>
      <td>★★</td>
      <td>★★★★</td>
      <td>★★</td>
      <td>★★★</td>
    </tr>
    <tr>
      <td>Electric guitar</td>
      <td>★★★★</td>
      <td>★★★</td>
      <td>★★★</td>
      <td>★★★</td>
      <td>★★★</td>
    </tr>
    <tr>
      <td>Guitalele</td>
      <td>★★★★★</td>
      <td>★★★★</td>
      <td>★★★★</td>
      <td>★★★★</td>
      <td>★★★</td>
    </tr>
    <tr>
      <td>Harmonica</td>
      <td>★★</td>
      <td>★★</td>
      <td>★★★★★</td>
      <td>★★★★★</td>
      <td>★★★★★</td>
    </tr>
    <tr>
      <td>Keyboard</td>
      <td>★★★</td>
      <td>★★★★★</td>
      <td>★★</td>
      <td>★★★</td>
      <td>★★★</td>
    </tr>
    <tr>
      <td>Piano</td>
      <td>★★★</td>
      <td>★★★★★</td>
      <td>★</td>
      <td>★★</td>
      <td>★★★</td>
    </tr>
    <tr>
      <td>Recorder</td>
      <td>★</td>
      <td>★★</td>
      <td>★★★★★</td>
      <td>★★★★★</td>
      <td>★★★★★</td>
    </tr>
    <tr>
      <td>Saxophone</td>
      <td>★★★★</td>
      <td>★★★</td>
      <td>★★★</td>
      <td>★★</td>
      <td>★★★★</td>
    </tr>
    <tr>
      <td>Sousaphone</td>
      <td>★★★★★</td>
      <td>★</td>
      <td>★★</td>
      <td>★</td>
      <td>★★★★</td>
    </tr>
    <tr>
      <td>Tuba</td>
      <td>★★★</td>
      <td>★</td>
      <td>★★</td>
      <td>★</td>
      <td>★★★★</td>
    </tr>
  </tbody>
</table>

<p>The guitalele does earn the most stars here, but that’s a pretty crude metric. To elaborate, you should get a guitalele already because…</p>

<h2 id="its-fun">It’s fun</h2>

<p>Some instruments like violin are culturally very serious and competitive. Others like <a href="https://chaidarun.com/img/sousaphone.jpg">sousaphone</a> are utterly ridiculous and more about showmanship than musicianship. The guitalele inherits a casual, friendly attitude from its ukulele roots.</p>

<p>Its six strings are tuned ADGCEA, which is uncoincidentally equivalent to capoing a regular guitar at the 5th fret. If you can play guitar, you already know how to play guitalele! The familiar fingering and small size make it even more conducive to passing around the campfire than a guitar is.</p>

<p>For newcomers to stringed instruments, the guitalele has another easily overlooked benefit: its low-tension strings won’t hurt your fingertips.</p>

<h2 id="its-versatile">It’s versatile</h2>

<p>One big reason why guitar and piano are so popular is that they can produce <a href="https://en.wikipedia.org/wiki/Polyphony">multiple notes</a> at the same time. Unlike wind instruments, they also allow you to sing along and—in the case of guitar—use percussive techniques like tapping and slapping. This all adds up to the ability to play virtually any song on a guitalele without the need for accompaniment.</p>

<h2 id="its-portable">It’s portable</h2>

<p>As my go-to travel instrument, my guitalele has joined me on trips to Mexico, Hawaii, Costa Rica, and Thailand. Ukulele lookalikes are especially appropriate in tropical locations :)</p>

<p>A guitalele can fit easily in an overhead bin and, in a pinch, underneath the seat in front of you. Flight attendants usually don’t mind either way. Tenor ukulele cases happen to fit perfectly and are a good idea if you travel often.</p>

<p>My one small gripe about guitaleles is that they’re only slightly louder than ukuleles and can be hard to hear in noisy environments. That’s not an entirely bad thing, though! I can practice during layovers without bothering anyone, whereas I still have yet to find a place soundproofed enough for sax.</p>

<h2 id="its-cheap">It’s cheap</h2>

<p>$100 is way down on the low end as far as musical instruments go, making it a responsible investment for musical newcomers. Only toy instruments like recorders and diatonic harmonicas are much cheaper.</p>

<p>My guitalele has far and away the <a href="https://chaidarun.com/ten-years-of-logging-my-life#observations">lowest cost per playing hour</a> of any instrument I’ve owned, and yet it’s still in great condition after three years.</p>

<blockquote>
  <p><span class="badge" title="2025-09-25">Update</span> Eleven years now!</p>
</blockquote>

<h2 id="its-easy">It’s easy</h2>

<p>If you want to start playing music but don’t have 10,000 hours to spend practicing, you really only need to learn <a href="https://chaidarun.com/how-to-play-guitar-by-ear">four chords</a> in order to play most pop songs. Unless you have huge hands, you’ll also probably find the widest frets on the guitalele more comfortable to hold down than on a regular guitar.</p>

<p>Once you get tired of strumming the basic chords, you can start the long journey of learning more colorful guitar techniques like bends, harmonics, and tremolo picking.</p>

<p>Another advantage over wind instruments in particular is that you can just pick up a guitalele and put it down without the hassle of assembling, greasing, wiping, and draining.</p>

<h2 id="ok-wheres-the-affiliate-link">OK, where’s the affiliate link…</h2>

<p>I have no ties to Yamaha and wasn’t paid to write this! Having finally found an instrument that’s both extremely fun and extremely practical, I hope this review can help end that search for anyone else in the same situation.</p>
]]></description>
      </item>
      
    
      
      <item>
        <title>Arch Linux Notes</title>
        <link>https://chaidarun.com/arch-notes</link>
        <pubDate>Wed, 29 Mar 2017 00:00:00 GMT</pubDate>
        <guid isPermaLink="true">https://chaidarun.com/arch-notes</guid>
        
        <description><![CDATA[<p>This page is a living document intended to save time for my future self in case the same issues ever crop up again. It’s based on my experience with running Arch on a <a href="https://archlinuxarm.org/platforms/armv7/broadcom/raspberry-pi-2">Raspberry Pi 2</a>, a Lenovo Flex 4, a ThinkPad P50, a ThinkPad P51, and a GMKtec NucBox M2 Pro S.</p>

<p>Arch is surprisingly stable if you remember the single most important post-install step: subscribe to the official <a href="https://www.archlinux.org/feeds/news/">news feed</a> for breaking changes!</p>

<p><img src="https://chaidarun.com/img/arch.png" alt="Arch screenshot" /></p>

<h3 id="os">OS</h3>

<ul>
  <li><a href="https://chaidarun.com/arch-notes#installing-arch-via-archinstall-wizard">Installing Arch via <code class="language-plaintext highlighter-rouge">archinstall</code> wizard</a></li>
  <li><a href="https://chaidarun.com/arch-notes#refreshing-the-mirror-list">Refreshing the mirror list</a></li>
  <li><a href="https://chaidarun.com/arch-notes#disabling--debug-packages">Disabling <code class="language-plaintext highlighter-rouge">-debug</code> packages</a></li>
  <li><a href="https://chaidarun.com/arch-notes#recovering-from-a-bad-upgrade">Recovering from a bad upgrade</a></li>
  <li><a href="https://chaidarun.com/arch-notes#installing-from-pkgbuild">Installing from PKGBUILD</a></li>
  <li><a href="https://chaidarun.com/arch-notes#using-an-external-hard-drive">Using an external hard drive</a></li>
  <li><a href="https://chaidarun.com/arch-notes#encrypting-an-external-hard-drive">Encrypting an external hard drive</a></li>
  <li><a href="https://chaidarun.com/arch-notes#freeing-up-disk-space">Freeing up disk space</a></li>
  <li><a href="https://chaidarun.com/arch-notes#increasing-the-file-watch-limit">Increasing the file watch limit</a></li>
  <li><a href="https://chaidarun.com/arch-notes#booting-uefi-with-an-existing-efi-partition">Booting UEFI with an existing EFI partition</a></li>
  <li><a href="https://chaidarun.com/arch-notes#ditching-grub-only-for-uefi-systems">Ditching GRUB (only for UEFI systems)</a></li>
  <li><a href="https://chaidarun.com/arch-notes#suspending-after-inactivity">Suspending after inactivity</a></li>
  <li><a href="https://chaidarun.com/arch-notes#switching-to-linux-lts">Switching to Linux LTS</a></li>
  <li><a href="https://chaidarun.com/arch-notes#booting-into-usb-on-gmktec-nucbox">Booting into USB on GMKtec NucBox</a></li>
</ul>

<h3 id="network">Network</h3>

<ul>
  <li><a href="https://chaidarun.com/arch-notes#manually-connecting-to-a-wpa-network">Manually connecting to a WPA network</a></li>
  <li><a href="https://chaidarun.com/arch-notes#ping-works-but-curl-doesnt"><code class="language-plaintext highlighter-rouge">ping</code> works but <code class="language-plaintext highlighter-rouge">curl</code> doesn’t</a></li>
  <li><a href="https://chaidarun.com/arch-notes#ntp-active-but-not-syncing">NTP active but not syncing</a></li>
  <li><a href="https://chaidarun.com/arch-notes#fixing-iptables-unknown-options">Fixing iptables unknown options</a></li>
  <li><a href="https://chaidarun.com/arch-notes#port-53-already-in-use">Port 53 already in use</a></li>
  <li><a href="https://chaidarun.com/arch-notes#fixing-slow-pip-downloads">Fixing slow pip downloads</a></li>
  <li><a href="https://chaidarun.com/arch-notes#connecting-to-an-l2tp-ipsec-vpn">Connecting to an L2TP/IPsec VPN</a></li>
  <li><a href="https://chaidarun.com/arch-notes#getting-intel-wireless-8260-card-to-work">Getting Intel Wireless 8260 card to work</a></li>
</ul>

<h3 id="display">Display</h3>

<ul>
  <li><a href="https://chaidarun.com/arch-notes#fixing-the-default-latex-font">Fixing the default LaTeX font</a></li>
  <li><a href="https://chaidarun.com/arch-notes#supporting-true-color-in-xfce4-terminal">Supporting true color in xfce4-terminal</a></li>
  <li><a href="https://chaidarun.com/arch-notes#multi-monitor-on-thinkpad-p51">Multi-monitor on ThinkPad P51</a></li>
  <li><a href="https://chaidarun.com/arch-notes#huge-fonts-with-nvidia-driver">Huge fonts with NVIDIA driver</a></li>
  <li><a href="https://chaidarun.com/arch-notes#ignoring-gtk-theme-in-firefox">Ignoring GTK theme in Firefox</a></li>
  <li><a href="https://chaidarun.com/arch-notes#adding-thai-font-support">Adding Thai font support</a></li>
</ul>

<h3 id="miscellaneous">Miscellaneous</h3>

<ul>
  <li><a href="https://chaidarun.com/arch-notes#pairing-bluetooth-headphones">Pairing Bluetooth headphones</a></li>
  <li><a href="https://chaidarun.com/arch-notes#fixing-audio-mute">Fixing audio mute</a></li>
  <li><a href="https://chaidarun.com/arch-notes#pacman-color-option-unrecognized">Pacman color option unrecognized</a></li>
  <li><a href="https://chaidarun.com/arch-notes#fixing-flatpak-steam">Fixing Flatpak Steam</a></li>
  <li><a href="https://chaidarun.com/arch-notes#fixing-android-studio">Fixing Android Studio</a></li>
  <li><a href="https://chaidarun.com/arch-notes#my-setup">My setup</a></li>
</ul>

<h2 id="installing-arch-via-archinstall-wizard">Installing Arch via <code class="language-plaintext highlighter-rouge">archinstall</code> wizard</h2>

<p>One weird trick Arch devs don’t want you to know: Arch comes with an <a href="https://archinstall.archlinux.page/installing/guided.html">installation wizard</a>. It’s barely documented (by Arch wiki standards) and never even mentioned in the official installation guide.</p>

<p>Fair enough, you should probably have some idea of what you’re doing before taking shortcuts. I’ve installed Arch enough times by now that I know what partitions are and exactly how I want them set up, but I’m not interested in figuring out such rarely used commands for the dozenth time.</p>

<p>Definitely don’t be <em>too</em> lazy by blindly accepting the defaults. There are a few important non-default things to set up during <code class="language-plaintext highlighter-rouge">archinstall</code> that are more painful to try doing later:</p>

<ul>
  <li>Create a root password and non-root user</li>
  <li>Create partitions encrypted via LUKS</li>
  <li>Copy your USB installer’s WiFi connection settings</li>
</ul>

<h2 id="refreshing-the-mirror-list">Refreshing the mirror list</h2>

<p>By default, your Arch installation will never update its own list of mirrors (software package download sources). This is bad because these volunteer-run mirrors come and go over the years, and the fastest one today will not remain so forever. <a href="https://wiki.archlinux.org/title/Reflector">Reflector</a> helps you periodically generate a fresh list of mirrors sorted by speed:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>reflector <span class="nt">--latest</span> 10 <span class="nt">--protocol</span> https <span class="nt">--save</span> /etc/pacman.d/mirrorlist <span class="nt">--sort</span> rate
</code></pre></div></div>

<h2 id="disabling--debug-packages">Disabling <code class="language-plaintext highlighter-rouge">-debug</code> packages</h2>

<p>In early 2024, I noticed that installing <code class="language-plaintext highlighter-rouge">foobar</code> would also end up installing <code class="language-plaintext highlighter-rouge">foobar-debug</code> by default. You can disable that new behavior by <a href="https://bbs.archlinux.org/viewtopic.php?pid=2150180#p2150180">editing</a> <code class="language-plaintext highlighter-rouge">/etc/makepkg.conf</code> to specify <code class="language-plaintext highlighter-rouge">!debug</code> instead of <code class="language-plaintext highlighter-rouge">debug</code>.</p>

<h2 id="recovering-from-a-bad-upgrade">Recovering from a bad upgrade</h2>

<p>I once ran a <code class="language-plaintext highlighter-rouge">pacman -Syu</code> that spat out a bunch of errors, probably due to an unfortunate interaction between package versions available at the time. After lazily crossing my fingers and restarting the computer, I got a boot error (of course):</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Failed to execute /init (error -13)
Starting init: /sbin/init exists but couldn't execute it (error -13)
Starting init: /bin/init exists but couldn't execute it (error -13)
Starting init: /bin/sh exists but couldn't execute it (error -13)
Kernel panic - not syncing: No working init found. Try passing init= option to kernel. See Linux Documentation/init.txt for guidance.
</code></pre></div></div>

<p>Some weeks later I crossed my fingers and ran the upgrade command again, which fixed everything. How do you run commands on a system that you can’t even boot into? I followed <a href="https://bbs.archlinux.org/viewtopic.php?pid=1528537">this advice</a> to use <code class="language-plaintext highlighter-rouge">arch-chroot</code>. Cue painfully detailed guide to <code class="language-plaintext highlighter-rouge">arch-chroot</code>:</p>

<ol>
  <li>
    <p>Before turning on the computer, plug in a USB stick with Arch <a href="https://wiki.archlinux.org/index.php/USB_flash_installation_media">on it</a>. Also plug in an ethernet cable if your planned fix requires a connection.</p>
  </li>
  <li>
    <p>Turn on the computer and go into BIOS by hitting some manufacturer-specific key combination after the screen turns on (e.g. <code class="language-plaintext highlighter-rouge">Fn+F2</code> on my Lenovo laptop). Find the boot priority list and reorder it so that the USB drive has the highest priority. Save, exit, and boot into USB when asked.</p>
  </li>
  <li>
    <p>Now you have a command prompt. This is where you’ll be using <code class="language-plaintext highlighter-rouge">arch-chroot</code>. Pleeease don’t blindly run this snippet as a script!</p>

    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># First, list all partitions and take note of the one that seems like your computer's root filesystem, e.g. /dev/sda8</span>
fdisk <span class="nt">-l</span>

<span class="c"># Mount that drive</span>
mount /dev/sda8 /mnt

<span class="c"># Enter your computer's root filesystem as root</span>
arch-chroot /mnt

<span class="c"># Do whatever's necessary to fix the original problem (in my case, another upgrade attempt)</span>
pacman <span class="nt">-Syu</span>

<span class="c"># Leave the chroot environment</span>
<span class="nb">exit</span>

<span class="c"># Unmount the filesystem</span>
umount /mnt

<span class="c"># Done!</span>
reboot
</code></pre></div>    </div>
  </li>
  <li>
    <p>As the computer reboots, go back into BIOS and move GRUB back to highest boot priority. Boot into your hopefully working system and remove the USB drive.</p>
  </li>
</ol>

<h2 id="installing-from-pkgbuild">Installing from PKGBUILD</h2>

<p>Problem: A <code class="language-plaintext highlighter-rouge">libreswan</code> update broke compatibility with <code class="language-plaintext highlighter-rouge">networkmanager-l2tp</code>. Downgrading <code class="language-plaintext highlighter-rouge">libreswan</code> (AUR) via <code class="language-plaintext highlighter-rouge">downgrade</code> wasn’t an option since I aggressively clear my pacman cache, and after a week I got tired of waiting for the <code class="language-plaintext highlighter-rouge">networkmanager-l2tp</code> <a href="https://github.com/nm-l2tp/NetworkManager-l2tp/commit/3c6ccfe331e65c7af8be4df78cac67c030e96958">fix</a> to land in Arch’s official repo.</p>

<p>Solution: Clone the <code class="language-plaintext highlighter-rouge">libreswan</code> repo to <code class="language-plaintext highlighter-rouge">/tmp</code>, <code class="language-plaintext highlighter-rouge">cd</code> into it, <code class="language-plaintext highlighter-rouge">git reset --hard</code> to the last compatible version, and run <code class="language-plaintext highlighter-rouge">makepkg -si</code> to build and install.</p>

<h2 id="using-an-external-hard-drive">Using an external hard drive</h2>

<p>External HDDs not marketed specifically for Mac are typically formatted as NTFS, the file system used by Windows. It’s best to keep NTFS if you ever plan to access your HDD from Windows, in which case you’ll need to do a little extra setup for Linux:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># First, plug the HDD into your computer and verify that it can be detected</span>
lsusb

<span class="c"># Check that the kernel logs contain fairly detailed info about the HDD. If all you see is a few generic lines about a new USB device being detected, try restarting the computer</span>
dmesg | <span class="nb">tail</span> <span class="nt">-n</span> 20

<span class="c"># List all partitions and find the one that seems like your HDD, e.g. /dev/sdb1</span>
<span class="c"># (Note that NTFS drives might show up as type "fuseblk")</span>
<span class="nb">sudo </span>fdisk <span class="nt">-l</span>

<span class="c"># Install ntfs-3g, which adds NTFS support to `mount`</span>
<span class="nb">sudo </span>pacman <span class="nt">-S</span> ntfs-3g

<span class="c"># Create the mount point at /mnt/whatever-name-you-want</span>
<span class="nb">sudo mkdir</span> /mnt/seagate

<span class="c"># Mount the partition you found from `fdisk -l`</span>
<span class="nb">sudo </span>mount <span class="nt">-o</span> rw,user,async <span class="nt">-t</span> ntfs-3g /dev/sdb1 /mnt/seagate

<span class="c"># Unmount when done (before you unplug the HDD)</span>
<span class="nb">sudo </span>umount /mnt/seagate
</code></pre></div></div>

<p>Make sure to provide <code class="language-plaintext highlighter-rouge">async</code> as a mount option instead of <code class="language-plaintext highlighter-rouge">sync</code>! The latter absolutely kills write performance on NTFS; we’re talking less than 100 kB/s.</p>

<h2 id="encrypting-an-external-hard-drive">Encrypting an external hard drive</h2>

<p>Or if you’re sure you’ll only ever want to use your HDD with Linux, you can get rid of NTFS and reformat the drive with full-disk encryption via LUKS:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Determine your HDD's device name, e.g. sda1</span>
lsblk

<span class="c"># Unmount HDD if mounted</span>
<span class="nb">sudo </span>umount /dev/sda1

<span class="c"># Optional: zero out the HDD for peace of mind</span>
<span class="nb">sudo dd </span><span class="k">if</span><span class="o">=</span>/dev/zero <span class="nv">of</span><span class="o">=</span>/dev/sda1 <span class="nv">bs</span><span class="o">=</span>4M <span class="nv">status</span><span class="o">=</span>progress

<span class="c"># Format HDD (choose a strong password and don't lose it)</span>
<span class="nb">sudo </span>cryptsetup luksFormat /dev/sda1

<span class="c"># Open container and invent a mapper name for it, e.g. seagate</span>
<span class="nb">sudo </span>cryptsetup luksOpen /dev/sda1 seagate

<span class="c"># Create filesystem</span>
<span class="nb">sudo </span>mkfs.ext4 /dev/mapper/seagate

<span class="c"># Mount filesystem at empty directory of your choosing</span>
<span class="nb">sudo mkdir</span> <span class="nt">-p</span> /mnt/seagate
<span class="nb">sudo </span>mount /dev/mapper/seagate /mnt/seagate

<span class="c"># Give yourself ownership of the filesystem (root by default)</span>
<span class="nb">sudo chown</span> <span class="nt">-R</span> art:art /mnt/seagate

<span class="c"># To unmount, first unmount the mapper and then close the container</span>
<span class="nb">sudo </span>umount /dev/mapper/seagate
<span class="nb">sudo </span>cryptsetup luksClose seagate
</code></pre></div></div>

<h2 id="freeing-up-disk-space">Freeing up disk space</h2>

<p>When uninstalling packages, always use <code class="language-plaintext highlighter-rouge">pacman -Rs</code> to include would-be orphans.</p>

<p>Pacman doesn’t delete old package versions, so you’ll need to <a href="https://wiki.archlinux.org/index.php/Pacman#Cleaning_the_package_cache">do so yourself</a> after package upgrades:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>paccache <span class="nt">-r</span>
<span class="o">==&gt;</span> finished: 523 packages removed <span class="o">(</span>disk space saved: 1.75 GiB<span class="o">)</span>
</code></pre></div></div>

<p><a href="http://kmkeen.com/pacgraph/">Pacgraph</a> shows your largest installed packages, which you can then remove if no longer needed.</p>

<p>The systemd journal can grow up to 4 GiB. If you don’t need all those logs, you can <a href="https://wiki.archlinux.org/index.php/Systemd#Journal_size_limit">cap it to a lower value</a>.</p>

<p>I had Docker for a while and later decided to uninstall it. Deleting <code class="language-plaintext highlighter-rouge">/var/lib/docker</code> freed up 8.1 GB.</p>

<h2 id="increasing-the-file-watch-limit">Increasing the file watch limit</h2>

<p>Many applications that watch your filesystem for changes can hit the OS’s (usually rather small) default limit on the number of files that can be simultaneously watched. I’ve personally run into this issue with Android Studio, Webpack, Watchman, and Syncthing.</p>

<p>Consider this the missing step in the Arch setup guide: drastically <a href="https://unix.stackexchange.com/a/13757">bumping up</a> the inotify watch limit.</p>

<blockquote>
  <p><span class="badge" title="2025-11-12">Update</span> Arch now seems to set a high limit by default, 524288 on a new install.</p>
</blockquote>

<h2 id="booting-uefi-with-an-existing-efi-partition">Booting UEFI with an existing EFI partition</h2>

<p>GRUB was presenting me with its own slow-ass <a href="https://www.linux.com/learn/how-rescue-non-booting-grub-2-linux">shell</a> instead of an OS selection menu. The <a href="https://bbs.archlinux.org/viewtopic.php?pid=1348012#p1348012">problem</a> was that the live USB had installed some rather important files into the root filesystem’s <code class="language-plaintext highlighter-rouge">/boot</code> folder instead of the EFI partition.</p>

<p>I had mistakenly been under the impression that mounting the existing EFI partition (used by Windows) to the root filesystem’s <code class="language-plaintext highlighter-rouge">/boot</code> was unnecessary because both already existed and had stuff in them. <a href="https://bbs.archlinux.org/viewtopic.php?pid=1641965#p1641965">Reinstalling</a> with the partition mounted fixed things.</p>

<h2 id="ditching-grub-only-for-uefi-systems">Ditching GRUB (only for UEFI systems)</h2>

<p>GRUB is the kitchen sink bootloader. Systemd comes with its own UEFI bootloader that’s much simpler and works perfectly fine if all you need is an OS selection menu. As explained in the <a href="https://wiki.archlinux.org/index.php/systemd-boot">guide</a>, just enable <code class="language-plaintext highlighter-rouge">systemd-boot</code> and create the two files <code class="language-plaintext highlighter-rouge">arch.conf</code> and <code class="language-plaintext highlighter-rouge">loader.conf</code>.</p>

<h2 id="suspending-after-inactivity">Suspending after inactivity</h2>

<p>In <code class="language-plaintext highlighter-rouge">xfce4-power-manager-settings</code> I specified that my laptop should go to sleep after an hour of inactivity, but that setting never seemed to work. The fix is to just edit one line in one file, as described <a href="https://askubuntu.com/a/674720">here</a>.</p>

<h2 id="switching-to-linux-lts">Switching to Linux LTS</h2>

<p>This is normally unnecessary but did fix a problem I had on my Thinkpad P51: after upgrading my system in September 2024 for the first time in several months, resume from suspend would reliably greet me with a screen full of <a href="https://en.mihaly4.ru/arch-linux-nvidia-suspend-hibernation">errors</a> like “Fixing recursive fault but reboot is needed” and “BUG: scheduling while atomic: irq/148-nvidia…”</p>

<p>I switched to the more stable LTS version of Linux by backing up <code class="language-plaintext highlighter-rouge">/boot/initramfs-linux-fallback.img</code> <code class="language-plaintext highlighter-rouge">/boot/initramfs-linux.img</code> <code class="language-plaintext highlighter-rouge">/boot/vmlinuz-linux</code> to somewhere in my home directory, deleting those files to make space in <code class="language-plaintext highlighter-rouge">/boot</code>, installing <code class="language-plaintext highlighter-rouge">linux-lts</code> and <code class="language-plaintext highlighter-rouge">nvidia-lts</code> via pacman, editing <code class="language-plaintext highlighter-rouge">/boot/loader/entries/arch.conf</code> (see <a href="https://chaidarun.com/arch-notes#ditching-grub-only-for-uefi-systems">above</a>) to reference the newly created <code class="language-plaintext highlighter-rouge">-lts</code> files inside <code class="language-plaintext highlighter-rouge">/boot</code>, and restarting the computer.</p>

<h2 id="booting-into-usb-on-gmktec-nucbox">Booting into USB on GMKtec NucBox</h2>

<p>I flashed Arch onto a USB drive and set it to highest boot priority in BIOS, but that setting kept getting ignored. Finally I found a <a href="https://www.reddit.com/r/techsupport/comments/12xd7nf/comment/jhjl0un/">solution</a> deep in the bowels of Reddit: flash Arch onto <em>two</em> USB drives and plug them both in. Weird AF indeed.</p>

<!-- Note to self: this issue may have arisen just because I installed Clipman and enabled synced selections at some point... -->
<!--
## Unifying the two clipboards

In addition to the regular clipboard that Windows and Mac users are familiar with, Linux also has a selection clipboard that automatically copies text whenever you highlight it. It's extremely annoying to `Ctrl+C` a URL, click on your browser's location bar, and press `Ctrl+V` only to end up re-pasting the existing URL because your browser had highlighted it when you clicked on the location bar.

I installed Clipman, went into its settings, and disabled "Sync selections".
 -->

<h2 id="manually-connecting-to-a-wpa-network">Manually connecting to a WPA network</h2>

<p>TLDR of the Arch <a href="https://wiki.archlinux.org/index.php/Wireless_network_configuration">guide</a> (run as root):</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ip <span class="nb">link set </span>wlp4s0 up <span class="c"># WiFi interface name `wlp4s0` obtained from `ip a`</span>
wpa_supplicant <span class="nt">-D</span> nl80211,wext <span class="nt">-i</span> wlp4s0 <span class="nt">-c</span> &lt;<span class="o">(</span>wpa_passphrase <span class="s2">"My WiFi SSID"</span> <span class="s2">"p4ssw0rd"</span><span class="o">)</span>
<span class="c"># (Switch to another TTY at this point)</span>
dhcpcd
ping 8.8.8.8
</code></pre></div></div>

<p>My home WiFi and/or my Raspberry Pi’s WiFi setup are pretty flaky, so I run cron as root to force a reconnect every day:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0 9 * * * killall dhcpcd wpa_supplicant; sleep 5; wpa_supplicant -D nl80211,wext -i wlan0 -c &lt;(wpa_passphrase "My WiFi SSID" "p4ssw0rd") &amp; sleep 20; dhcpcd &amp;
</code></pre></div></div>

<h2 id="ping-works-but-curl-doesnt"><code class="language-plaintext highlighter-rouge">ping</code> works but <code class="language-plaintext highlighter-rouge">curl</code> doesn’t</h2>

<p>Pinging <code class="language-plaintext highlighter-rouge">8.8.8.8</code> worked, but pinging or curling <code class="language-plaintext highlighter-rouge">google.com</code> didn’t. I opened my <code class="language-plaintext highlighter-rouge">/etc/resolv.conf</code> and saw this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Generated by resolvconf
search tail39f21.ts.net
nameserver 100.100.100.100
</code></pre></div></div>

<p>Looks like Tailscale <a href="https://tailscale.com/kb/1235/resolv-conf">overwrote</a> this file. I found another helpfully named file <code class="language-plaintext highlighter-rouge">/etc/resolv.pre-tailscale-backup.conf</code> with these contents:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Generated by NetworkManager
nameserver 1.1.1.1
nameserver 8.8.8.8
nameserver 4.2.2.2
</code></pre></div></div>

<p>Adding those entries back to <code class="language-plaintext highlighter-rouge">/etc/resolv.conf</code> fixed my DNS… temporarily. Within a few seconds, the file reverted to its previous state.</p>

<p>The permanent fix is to uninstall <code class="language-plaintext highlighter-rouge">resolvconf</code> (which I had apparently installed as a dependency of <code class="language-plaintext highlighter-rouge">netctl</code>), <a href="https://wiki.archlinux.org/title/Systemd-resolved#Configuration">start and enable</a> <code class="language-plaintext highlighter-rouge">systemd-resolved</code> (which was even installed already but disabled?), <a href="https://wiki.archlinux.org/title/Systemd-resolved#DNS">symlink</a> <code class="language-plaintext highlighter-rouge">/etc/resolv.conf</code>, and <a href="https://tailscale.com/kb/1188/linux-dns">restart everything</a>. When this happened on my Raspberry Pi, I also had to restart <code class="language-plaintext highlighter-rouge">systemd-networkd</code>. Now DNS works and my <code class="language-plaintext highlighter-rouge">/etc/resolv.conf</code> looks like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nameserver 127.0.0.53
options edns0 trust-ad
search [REDACTED].ts.net
</code></pre></div></div>

<h2 id="ntp-active-but-not-syncing">NTP active but not syncing</h2>

<p>My <a href="https://en.wikipedia.org/wiki/Uninterruptible_power_supply">UPS</a> battery died and I finally had to shut down my Raspberry Pi after several years of continuous uptime. When I turned it back on, I noticed that the time as shown by <code class="language-plaintext highlighter-rouge">date</code> was several years off. I manually corrected it:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo timedatectl set-time '2024-10-23 04:41:10'
</code></pre></div></div>

<p>Why was the time wrong in the first place, though? <code class="language-plaintext highlighter-rouge">timedatectl</code> showed that <a href="https://en.wikipedia.org/wiki/Network_Time_Protocol">NTP</a> syncing was active but not affecting my system clock:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>System clock synchronized: no
              NTP service: active
</code></pre></div></div>

<p>My <code class="language-plaintext highlighter-rouge">/etc/systemd/network</code> contained a file called <code class="language-plaintext highlighter-rouge">eth0.network</code> but no file for WiFi. <a href="https://bbs.archlinux.org/viewtopic.php?pid=2057633#p2057633">Adding one</a> fixed the problem.</p>

<h2 id="fixing-iptables-unknown-options">Fixing iptables unknown options</h2>

<p>The default version of <code class="language-plaintext highlighter-rouge">iptables</code> drops support for a command-line option that Docker uses:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker: Error response from daemon: driver failed programming external connectivity on endpoint tender_volhard (954d664336eb5ea7b2c7f808889b3033977b45f53f99ba38bbc66bfcf14a61ef):  (iptables failed: iptables --wait -t nat -A DOCKER -p tcp -d 0/0 --dport 80 -j DNAT --to-destination 172.17.0.2:80 ! -i docker0: iptables v1.8.2 (legacy): unknown option "--dport"
Try `iptables -h' or 'iptables --help' for more information.
</code></pre></div></div>

<p><a href="https://github.com/moby/moby/issues/38759#issuecomment-473909447">Switching</a> to <code class="language-plaintext highlighter-rouge">iptables-nft</code> restores the legacy <code class="language-plaintext highlighter-rouge">--dport</code> option. Note that whenever you update the Linux kernel, the option may become unavailable again until the next reboot.</p>

<h2 id="port-53-already-in-use">Port 53 already in use</h2>

<p>When I tried to set up <a href="https://pi-hole.net/">Pi-hole</a> in Docker, I got this error:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Error response from daemon: failed to set up container networking: driver failed programming external connectivity on endpoint pihole (851ce571120db7262a96ab24f4c019005a37094543b008cd1ec90baa35b392cf): failed to bind host port for 0.0.0.0:53:172.19.0.2:53/tcp: address already in use
</code></pre></div></div>

<p>The <a href="https://discourse.pi-hole.net/t/update-what-to-do-if-port-53-is-already-in-use/52033">solution</a> is to set <code class="language-plaintext highlighter-rouge">DNSStubListener=no</code> in <code class="language-plaintext highlighter-rouge">/etc/systemd/resolved.conf</code> and then <code class="language-plaintext highlighter-rouge">sudo systemctl restart systemd-resolved</code>.</p>

<h2 id="fixing-slow-pip-downloads">Fixing slow pip downloads</h2>

<p>One day my <code class="language-plaintext highlighter-rouge">pip install</code> suddenly became comically slow, seemingly on the order of 10 kB/s. A <code class="language-plaintext highlighter-rouge">pip -vvv</code> revealed that it was hanging on “Starting new HTTPS connection (1) pypi.org”, which led me to <a href="https://www.reddit.com/r/bashonubuntuonwindows/comments/8rplxw/python_pip_takes_forever_on_wsl/e0twr6z/?utm_source=reddit&amp;utm_medium=web2x&amp;context=3">this post</a> that correctly identified my issue: pip tried and failed to connect using multiple IPv6 addresses until it finally gave up and fell back to IPv4.</p>

<p>My workaround was to simply <a href="https://wiki.archlinux.org/index.php/IPv6#Disable_functionality">disable IPv6</a> in kernel params 🤷</p>

<h2 id="connecting-to-an-l2tpipsec-vpn">Connecting to an L2TP/IPsec VPN</h2>

<p>Just to be safe, uninstall all of the following packages: openswan, strongswan, networkmanager-openswan, networkmanager-strongswan, and networkmanager-libreswan. I couldn’t get any of these to work. Openswan seems capable but there’s no way I’m going to run through <a href="https://wiki.archlinux.org/index.php/Openswan_L2TP/IPsec_VPN_client_setup">this gauntlet</a> for a single VPN connection if I can avoid it.</p>

<p>Install <a href="https://www.archlinux.org/packages/extra/x86_64/networkmanager/">networkmanager</a>, <a href="https://aur.archlinux.org/packages/libreswan/">libreswan</a>, and <a href="https://aur.archlinux.org/packages/networkmanager-l2tp/">networkmanager-l2tp</a>. (It’s important to install networkmanager-l2tp last!) Then add the VPN entry as usual by right-clicking the NetworkManager applet or running <code class="language-plaintext highlighter-rouge">nm-connection-editor</code>.</p>

<p>When setting up the VPN entry, go into “IPsec Settings” and check “Enable IPsec tunnel to L2TP host”. You may also need to uncheck “Perfect Forward Secrecy”.</p>

<blockquote>
  <p><span class="badge" title="2017-07-08">Update</span> Due to a Linux kernel <a href="https://bbs.archlinux.org/viewtopic.php?pid=1713763#p1713763">regression</a>, you supposedly now must also install <code class="language-plaintext highlighter-rouge">linux-lts</code> and then run <code class="language-plaintext highlighter-rouge">sudo grub-mkconfig</code>. I still haven’t gotten it working, though.</p>
</blockquote>

<blockquote>
  <p><span class="badge" title="2018-12-26">Update</span> I’ve given up on libreswan and networkmanager. Here’s a <a href="https://chaidarun.com/l2tp-ipsec">guide</a> for openswan.</p>
</blockquote>

<h2 id="getting-intel-wireless-8260-card-to-work">Getting Intel Wireless 8260 card to work</h2>

<p>Trying to <a href="https://wiki.archlinux.org/index.php/Wireless_network_configuration">activate</a> my WiFi card with <code class="language-plaintext highlighter-rouge">ip link set wlp4s0 up</code> failed with a vague <code class="language-plaintext highlighter-rouge">RTNETLINK answers: Input/output error</code> message. Turns out that version 22 of the Linux kernel’s firmware for my particular WiFi card was <a href="https://bbs.archlinux.org/viewtopic.php?pid=1590387#p1590387">problematic</a>. You can see what firmware version you’re on by running <code class="language-plaintext highlighter-rouge">dmesg | grep 'iwlwifi.*loaded'</code>.</p>

<p>The solution was to force Linux to use the previous version of the firmware by <a href="https://ubuntuforums.org/showthread.php?t=2342945&amp;p=13568896#post13568896">disabling</a> the latest version. As root:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Stop kernel module "iwlwifi", which will need to be restarted. (Not sure what iwlmvm is, but `rmmod iwlwifi` complains that it's in the way)</span>
rmmod iwlmvm
rmmod iwlwifi

<span class="c"># Rename the firmware file so that Linux won't find it</span>
<span class="nb">cd</span> /lib/firmware
<span class="nb">mv </span>iwlwifi-8000C-22.ucode iwlwifi-8000C-22.bak

<span class="c"># Re-enable modules</span>
modprobe iwlwifi
modprobe iwlmvm
</code></pre></div></div>

<p>Since I was setting up Arch at my office without the luxury of ethernet, I actually ended up having to go through this process twice: once on the live USB and again on my laptop’s instance of Arch.</p>

<h2 id="fixing-the-default-latex-font">Fixing the default LaTeX font</h2>

<p>Rendering a LaTeX file to PDF works fine after installing <code class="language-plaintext highlighter-rouge">texlive-core</code>, but what’s up with the fugly text? Zooming in reveals that the bitmap version of Computer Modern is being used. We need to specify an infinitely scalable vector font instead.</p>

<p>The first step of the <a href="https://bbs.archlinux.org/viewtopic.php?pid=523453#p523453">fix</a> is to enable Latin Modern, the widely accepted successor to Computer Modern:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>updmap <span class="nt">--enable</span> <span class="nv">Map</span><span class="o">=</span>lm.map
</code></pre></div></div>

<p>Then add this to the preamble of your LaTeX document:</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\usepackage</span><span class="p">{</span>lmodern<span class="p">}</span>
</code></pre></div></div>

<p>Generate the PDF again, and font rendering should be fixed.</p>

<h2 id="supporting-true-color-in-xfce4-terminal">Supporting true color in xfce4-terminal</h2>

<p>Set <code class="language-plaintext highlighter-rouge">TERM=xterm-256color</code> in your <code class="language-plaintext highlighter-rouge">.zshrc</code> / <code class="language-plaintext highlighter-rouge">.bashrc</code>.</p>

<h2 id="multi-monitor-on-thinkpad-p51">Multi-monitor on ThinkPad P51</h2>

<p>Using the default <code class="language-plaintext highlighter-rouge">nouveau</code> graphics driver results in <code class="language-plaintext highlighter-rouge">xrandr</code> freezing with an external monitor plugged in. I still haven’t gotten the DisplayPort ports to work, but here’s my solution for VGA/DVI:</p>

<ol>
  <li>Install <code class="language-plaintext highlighter-rouge">nvidia</code> package</li>
  <li>Uninstall <code class="language-plaintext highlighter-rouge">xf86-video-nouveau</code> if installed</li>
  <li>Reboot computer. In BIOS, switch from “Hybrid Graphics” to “Discrete Graphics”</li>
</ol>

<p>However, fonts might look huge in some apps after switching to <code class="language-plaintext highlighter-rouge">nvidia</code>…</p>

<h2 id="huge-fonts-with-nvidia-driver">Huge fonts with NVIDIA driver</h2>

<p>The proprietary <code class="language-plaintext highlighter-rouge">nvidia</code> driver misdetects my laptop screen’s DPI for some reason. This can be fixed by adding the command below to <code class="language-plaintext highlighter-rouge">~/.xinitrc</code> and then rebooting.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Replace `DP-2` with whatever `xrandr` says your laptop screen is called</span>
xrandr <span class="nt">--output</span> DP-2 <span class="nt">--dpi</span> 96
</code></pre></div></div>

<p>A possibly related issue is that X fails to identify the laptop screen as the primary screen (even when no external monitors are connected), causing i3status to hide its notification area. This can be fixed by appending <code class="language-plaintext highlighter-rouge">--primary</code> to the command above.</p>

<h2 id="ignoring-gtk-theme-in-firefox">Ignoring GTK theme in Firefox</h2>

<p>In <code class="language-plaintext highlighter-rouge">xfce4-appearance-settings</code> I’ve selected the Adwaita-dark GTK theme. It looks decent everywhere except in Firefox, which will render dark scrollbars and form controls on otherwise light pages.</p>

<p>To force Firefox to use the default (light) Adwaita theme, I’ve created an executable <code class="language-plaintext highlighter-rouge">/usr/bin/local/firefox</code> script with these contents:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/env bash</span>
<span class="nv">GTK_THEME</span><span class="o">=</span>Adwaita /usr/bin/firefox
</code></pre></div></div>

<p>Make sure <code class="language-plaintext highlighter-rouge">/usr/bin/local</code> appears before <code class="language-plaintext highlighter-rouge">/usr/bin</code> in your PATH.</p>

<h2 id="adding-thai-font-support">Adding Thai font support</h2>

<p>Install <code class="language-plaintext highlighter-rouge">fonts-tlwg</code> from the AUR. It looks perfectly fine and just works. I first tried <code class="language-plaintext highlighter-rouge">ttf-ms-win10</code> but gave up on getting all of my Windows fonts to the same versions expected by the PKGBUILD.</p>

<h2 id="pairing-bluetooth-headphones">Pairing Bluetooth headphones</h2>

<p>Steps distilled from the <a href="https://wiki.archlinux.org/title/Bluetooth">Arch wiki</a> and <a href="https://askubuntu.com/a/1120106">this answer</a>:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pacman <span class="nt">-S</span> bluez bluez-utils blueman pulseaudio-bluetooth
modprobe btusb
systemctl <span class="nb">enable </span>bluetooth.service
pulseaudio <span class="nt">-k</span>
blueman-applet
</code></pre></div></div>

<h2 id="fixing-audio-mute">Fixing audio mute</h2>

<p>First of all, make sure you have the <code class="language-plaintext highlighter-rouge">alsa-utils</code> package installed. It provides two useful programs to keep open while debugging sound issues: <code class="language-plaintext highlighter-rouge">speaker-test -t wav -c 2</code> plays a looping audio sample, and <code class="language-plaintext highlighter-rouge">alsamixer</code> shows the current volume and mute status of all audio channels.</p>

<p>Most people online suggest muting via the command <code class="language-plaintext highlighter-rouge">amixer set Master toggle</code>. This works but has an unfortunate quirk on some systems: running it a second time doesn’t actually unmute!</p>

<p>Muting Master mutes all channels, but unmuting Master unmutes only the Master channel. That’s a problem if you have other audio channels that depend on Master, e.g. Speaker and Headphone. The <code class="language-plaintext highlighter-rouge">pulseaudio</code> package provides <code class="language-plaintext highlighter-rouge">pactl</code>, an alternative to <code class="language-plaintext highlighter-rouge">amixer</code> that doesn’t suffer from the same bug. Run <code class="language-plaintext highlighter-rouge">pactl set-sink-mute 0 toggle</code> to toggle the mute status of all channels in unison.</p>

<p>In my i3 config, I have that command bound to my keyboard’s mute button like so:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bindsym XF86AudioMute <span class="nb">exec</span> <span class="nt">--no-startup-id</span> pactl set-sink-mute 0 toggle
</code></pre></div></div>

<h2 id="pacman-color-option-unrecognized">Pacman color option unrecognized</h2>

<p>A <a href="https://lists.archlinux.org/pipermail/pacman-dev/2018-June/022561.html">pacman bug</a> causes this error when installing AUR packages with pacaur:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/usr/bin/pacman: unrecognized option <span class="s1">'--color never'</span>
</code></pre></div></div>

<p>To <a href="https://www.reddit.com/r/archlinux/comments/8o5ol0/error_using_pacman_usrbinpacman_unrecognized/e0dlfaf">fix</a>, uncomment <code class="language-plaintext highlighter-rouge">Color</code> in <code class="language-plaintext highlighter-rouge">/etc/pacman.conf</code>.</p>

<h2 id="fixing-flatpak-steam">Fixing Flatpak Steam</h2>

<p>I installed Steam via Flatpak as <a href="https://wiki.archlinux.org/index.php/steam#Alternative_Flatpak_installation">documented</a> in the Arch wiki, which initially worked fine. However, I got this error the second time I tried running Steam:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>flatpak run com.valvesoftware.Steam
<span class="k">**</span>
flatpak:ERROR:libglnx/glnx-shutil.c:155:mkdir_p_at_internal: assertion failed: <span class="o">(!</span>did_recurse<span class="o">)</span>
Bail out! flatpak:ERROR:libglnx/glnx-shutil.c:155:mkdir_p_at_internal: assertion failed: <span class="o">(!</span>did_recurse<span class="o">)</span>
zsh: abort <span class="o">(</span>core dumped<span class="o">)</span>  flatpak run com.valvesoftware.Steam
</code></pre></div></div>

<p>It looked like some symlink targets were missing…</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-AGl</span> ~/.var/app/com.valvesoftware.Steam
total 8
lrwxrwxrwx 1 art    6 Jul 28 02:38 cache -&gt; .cache
lrwxrwxrwx 1 art    7 Jul 28 02:38 config -&gt; .config
drwxr-xr-x 2 art 4096 Jul 28 02:38 config.old
lrwxrwxrwx 1 art   12 Jul 28 02:38 data -&gt; .local/share
drwxr-xr-x 2 art 4096 Jul 28 02:38 .ld.so
</code></pre></div></div>

<p>Pointing them to their counterparts in my home directory <a href="https://github.com/flatpak/flatpak/issues/1998#issuecomment-415386819">solved the issue</a>:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">ln</span> <span class="nt">-sf</span> ~/.cache ~/.var/app/com.valvesoftware.Steam/cache

<span class="nv">$ </span><span class="nb">ln</span> <span class="nt">-sf</span> ~/.config ~/.var/app/com.valvesoftware.Steam/config

<span class="nv">$ </span><span class="nb">ln</span> <span class="nt">-sf</span> ~/.local/share ~/.var/app/com.valvesoftware.Steam/data

<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-AGl</span> ~/.var/app/com.valvesoftware.Steam
total 8
lrwxrwxrwx 1 art   16 Jul 29 02:02 cache -&gt; /home/art/.cache
lrwxrwxrwx 1 art   17 Jul 29 02:02 config -&gt; /home/art/.config
drwxr-xr-x 2 art 4096 Jul 28 02:38 config.old
lrwxrwxrwx 1 art   22 Jul 29 02:02 data -&gt; /home/art/.local/share
drwxr-xr-x 2 art 4096 Jul 28 02:38 .ld.so
</code></pre></div></div>

<h2 id="fixing-android-studio">Fixing Android Studio</h2>

<p>I was trying to set up React Native, which involves setting up Android Studio. Everything went well up until <code class="language-plaintext highlighter-rouge">react-native run-android</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java.io.IOException: Cannot run program "/home/art/Android/Sdk/build-tools/23.0.1/aapt": error=2, No such file or directory
</code></pre></div></div>

<p>The solution is to enable the <a href="https://wiki.archlinux.org/index.php/multilib">multilib repository</a> and then install <a href="https://medium.com/@bpdp/undocumented-manual-of-react-native-for-64-bit-linux-5a7992ae3008">some packages</a>:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pacman <span class="nt">-S</span> lib32-gcc-libs lib32-glibc lib32-libstdc++5 lib32-ncurses lib32-zlib
</code></pre></div></div>

<p>If your <code class="language-plaintext highlighter-rouge">JAVA_HOME</code> environment variable is unset, you may also need to set it to the grandparent directory of the file found by <code class="language-plaintext highlighter-rouge">locate tools.jar</code>. For example:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">JAVA_HOME</span><span class="o">=</span>/opt/android-studio/jre
</code></pre></div></div>

<p>If you get errors like the one below when running Android Studio 3’s emulator, <a href="https://bbs.archlinux.org/viewtopic.php?pid=1747748#p1747748">this</a> and/or <a href="https://stackoverflow.com/a/42686791">this</a> should fix it.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Emulator: libGL error: unable to load driver: i965_dri.so
</code></pre></div></div>

<h2 id="my-setup">My setup</h2>

<p>On all Arch installations:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pacman <span class="nt">-S</span> bc fd-rs fzf git htop ncdu ntfs-3g python-pre-commit rclone reflector ripgrep rsync <span class="nb">sudo </span>syncthing tmux words zsh zsh-syntax-highlighting
</code></pre></div></div>

<p>On graphical Arch installations:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pacman <span class="nt">-S</span> alacritty dmenu docker easystroke evince feh firefox gimp i3-wm i3blocks i3blocks-contrib-git i3lock i3status imagemagick jq keepassxc network-manager-applet numlockx pacgraph scrot shellcheck-bin sublime-text-dev thunar xfce4-goodies xfce4-power-manager
</code></pre></div></div>

<p><a href="https://github.com/artnc/dotfiles">My .zshrc and other dotfiles</a></p>
]]></description>
      </item>
      
    
      
      <item>
        <title>Elixir for Node.js Developers</title>
        <link>https://chaidarun.com/elixir-nodejs</link>
        <pubDate>Mon, 26 Dec 2016 00:00:00 GMT</pubDate>
        <guid isPermaLink="true">https://chaidarun.com/elixir-nodejs</guid>
        
        <description><![CDATA[<p>Bilingual dictionaries are some of the most valuable tools for learning natural languages like French. The idea also applies perfectly well to programming languages, and so here’s the guide I wished I had before embarking on my trip to Elixir land. Corrections from those more fluent in Elixir are welcome!</p>

<h2 id="the-elixir-ecosystem">The Elixir ecosystem</h2>

<p>Let’s first take a look at the software that comes with Elixir. I find tooling the biggest obstacle to learning any new language; the language itself is usually more stable and straightforward.</p>

<h3 id="beam">BEAM</h3>

<p>BEAM is also known as the Erlang Virtual Machine (EVM). It’s the platform that Elixir runs on, similar to how Chrome’s V8 engine is what powers Node.js. A better comparison would be to Java’s JVM, which now supports a variety of languages other than Java.</p>

<h3 id="otp">OTP</h3>

<p>I initially thought OTP (“Open Telecom Platform”) was just an incredibly fancy name for Erlang’s standard library. Now I think of OTP as the subset of Erlang’s stdlib that facilitates the <a href="http://www.brianstorti.com/the-actor-model/">actor model</a> of concurrency. People sometimes refer to Erlang as “Erlang/OTP” because the actor model is such a big deal—it’s what BEAM was built for.</p>

<h3 id="mix">Mix</h3>

<p><a href="http://elixir-lang.org/getting-started/mix-otp/introduction-to-mix.html">Mix</a> is Elixir’s build tool / task runner. It’s analogous to Jake, Gulp, and much of the <code class="language-plaintext highlighter-rouge">npm</code> client (which seems to think the “p” in its name means “project” instead of “package”).</p>

<p>Mix uses the dev <a href="http://elixir-lang.org/getting-started/mix-otp/introduction-to-mix.html#environments">environment</a> by default but can be overridden with an environment variable: <code class="language-plaintext highlighter-rouge">MIX_ENV=prod</code>. This is similar to how React expects you to set <code class="language-plaintext highlighter-rouge">NODE_ENV=production</code> for release builds.</p>

<p>When setting up a new Node.js project, you typically run <code class="language-plaintext highlighter-rouge">npm init</code> and then add <code class="language-plaintext highlighter-rouge">node_modules</code> to your <code class="language-plaintext highlighter-rouge">.gitignore</code>. The Elixir equivalent is <code class="language-plaintext highlighter-rouge">mix new project_name</code>. We’ll soon see a few more of Mix’s many available commands.</p>

<h3 id="hex">Hex</h3>

<p><a href="https://hex.pm/">Hex</a> is Elixir’s package manager, analogous to the npm registry and the parts of the <code class="language-plaintext highlighter-rouge">npm</code> client that actually deal with package management. One big difference is that you don’t get a separate “hex” command when you install Elixir. You instead use Hex via Mix commands like <code class="language-plaintext highlighter-rouge">mix deps.get</code> (analogous to <code class="language-plaintext highlighter-rouge">npm install</code>).</p>

<p>Elixir’s equivalents of <code class="language-plaintext highlighter-rouge">package.json</code> and <code class="language-plaintext highlighter-rouge">npm-shrinkwrap.json</code> are <code class="language-plaintext highlighter-rouge">mix.exs</code> and <code class="language-plaintext highlighter-rouge">mix.lock</code>, respectively. Running <code class="language-plaintext highlighter-rouge">mix deps.get</code> will install all packages declared in those files. There currently aren’t any Mix commands that work like <code class="language-plaintext highlighter-rouge">npm install --save</code>, so to add or remove individual packages you’ll have to edit <code class="language-plaintext highlighter-rouge">mix.exs</code> manually and then run <code class="language-plaintext highlighter-rouge">mix deps.get</code> again. On the upside, Mix automatically updates <code class="language-plaintext highlighter-rouge">mix.lock</code> for you.</p>

<h3 id="iex">IEx</h3>

<p>Okay, enough about npm already. The Elixir counterparts to Node.js’s <code class="language-plaintext highlighter-rouge">node</code> command are <code class="language-plaintext highlighter-rouge">iex</code> and <code class="language-plaintext highlighter-rouge">elixir</code>. Running <code class="language-plaintext highlighter-rouge">iex</code> will open an interactive Elixir prompt (or <a href="https://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop">REPL</a>), while running <code class="language-plaintext highlighter-rouge">iex -S mix</code> will open the prompt in the context of the current directory’s compiled Mix project. You can alternatively execute the compiled project via <code class="language-plaintext highlighter-rouge">mix run</code> if you don’t need the prompt.</p>

<p>Wait, you need to compile Elixir? Although you do need to compile Mix projects via <code class="language-plaintext highlighter-rouge">mix compile</code>, you can also run a standalone Elixir script with the command <code class="language-plaintext highlighter-rouge">elixir foobar.exs</code> (note the <code class="language-plaintext highlighter-rouge">.exs</code> extension, as opposed to <code class="language-plaintext highlighter-rouge">.ex</code>). Mix itself is implemented as an Elixir script!</p>

<h3 id="exunit">ExUnit</h3>

<p>Elixir has an official unit testing framework that integrates with Mix via <code class="language-plaintext highlighter-rouge">mix test</code>. Having one true framework is pretty great if for no other reason than avoiding the dependency hell of Mocha, Chai, Karma, Sinon, etc.</p>

<h3 id="dialyzer">Dialyzer</h3>

<p>Despite being a dynamically typed language, Erlang comes with a static analysis tool called <code class="language-plaintext highlighter-rouge">dialyzer</code>. It can automatically detect certain type errors even in the absence of type declarations, kind of like TypeScript and Flow. If you do prefer declaring types yourself, both Erlang and Elixir offer an <a href="http://elixir-lang.org/getting-started/typespecs-and-behaviours.html">annotation syntax</a> that Dialyzer understands.</p>

<p><a href="https://github.com/jeremyjh/dialyxir">Dialyxir</a> makes Dialyzer much easier to use with Elixir.</p>

<h3 id="phoenix">Phoenix</h3>

<p><a href="http://www.phoenixframework.org/">Phoenix</a> has a lot in common with Express.js and Ruby on Rails: they’re the go-to web frameworks, they’ve made household names out of their authors, and they don’t actually ship with the language itself. I’m mentioning Phoenix only because it’s so popular and what you’ll probably be using if you’re coming from Node.js.</p>

<h2 id="the-elixir-language">The Elixir language</h2>

<p>The <a href="http://elixir-lang.org/getting-started/basic-types.html">official guide</a> does an excellent job on its own, so I’ll just add some JavaScript perspective to a few basic Elixir concepts that aren’t found in ES5.</p>

<h3 id="atoms">Atoms</h3>

<p>Atoms resemble ES6 symbols and serve much of the same purpose as opaque enums. They’re arbitrarily named, intrinsically meaningless identifiers whose most useful property is global uniqueness. In JavaScript you might have a function that returns <code class="language-plaintext highlighter-rouge">true</code> or <code class="language-plaintext highlighter-rouge">false</code> to indicate success; the Elixir equivalent might instead return <code class="language-plaintext highlighter-rouge">:ok</code> or <code class="language-plaintext highlighter-rouge">:error</code>.</p>

<p>As another example, consider Webpack’s <a href="https://webpack.github.io/docs/configuration.html#output-librarytarget">output.libraryTarget</a> config option. Its possible values are restricted to a small set of strings: <code class="language-plaintext highlighter-rouge">"var"</code>, <code class="language-plaintext highlighter-rouge">"amd"</code>, etc. An idiomatic Elixir API would use lightweight atoms like <code class="language-plaintext highlighter-rouge">:var</code> and <code class="language-plaintext highlighter-rouge">:amd</code> instead of full-fledged UTF8 strings.</p>

<h3 id="ampersand-operator">Ampersand operator</h3>

<p>The official guide introduces the capture operator <code class="language-plaintext highlighter-rouge">&amp;</code> in <a href="http://elixir-lang.org/getting-started/modules.html#funtuallyction-capturing">chapter 8</a> with a link to details in the <a href="https://hexdocs.pm/elixir/Kernel.SpecialForms.html#&amp;/1">language reference</a>. I think <code class="language-plaintext highlighter-rouge">&amp;</code> deserves extra attention due to how unfamiliar yet common it is. Elixir newcomers may not realize that it has three distinct meanings depending on context:</p>

<ol>
  <li>
    <p><code class="language-plaintext highlighter-rouge">&amp;</code> obtains references to named functions, allowing them to be passed around as variables and called as anonymous functions (a.k.a. lambdas). In JavaScript, you can simply refer to a named function like <code class="language-plaintext highlighter-rouge">Math.floor</code> by its name:</p>

    <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="mf">1.62</span><span class="p">,</span> <span class="mf">2.72</span><span class="p">].</span><span class="nf">map</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">);</span> <span class="c1">// [1.0, 2.0]</span>
<span class="kd">var</span> <span class="nx">myLambda</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">;</span>
<span class="nf">myLambda</span><span class="p">(</span><span class="mf">3.14</span><span class="p">);</span> <span class="c1">// 3.0</span>
</code></pre></div>    </div>

    <p>In Elixir, you also need <code class="language-plaintext highlighter-rouge">&amp;</code> and the function’s <a href="https://en.wikipedia.org/wiki/Arity">arity</a>:</p>

    <div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Enum</span><span class="o">.</span><span class="n">map</span><span class="p">([</span><span class="mf">1.62</span><span class="p">,</span> <span class="mf">2.72</span><span class="p">],</span> <span class="o">&amp;</span><span class="no">Float</span><span class="o">.</span><span class="n">floor</span><span class="o">/</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># [1.0, 2.0]</span>
<span class="n">my_lambda</span> <span class="o">=</span> <span class="o">&amp;</span><span class="no">Float</span><span class="o">.</span><span class="n">floor</span><span class="o">/</span><span class="mi">1</span>
<span class="c1"># Lambdas must be called with a "."</span>
<span class="n">my_lambda</span><span class="o">.</span><span class="p">(</span><span class="mf">3.14</span><span class="p">)</span> <span class="c1"># 3.0</span>
</code></pre></div>    </div>

    <p>Why the additional syntax? Elixir functions can be defined multiple times for different arities, so you need to specify which version you want. Since parentheses are optional in Elixir when empty, you also need <code class="language-plaintext highlighter-rouge">&amp;</code> to prevent the compiler from interpreting <code class="language-plaintext highlighter-rouge">Float.floor/1</code> as “the result of <code class="language-plaintext highlighter-rouge">Float.floor()</code> divided by 1”.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">&amp;</code> is shorthand notation for declaring simple lambdas that take at least one argument. These are all equivalent:</p>

    <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ES5</span>
<span class="kd">var</span> <span class="nx">sum</span> <span class="o">=</span> <span class="nf">function </span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// ES6</span>
<span class="kd">const</span> <span class="nx">sum</span> <span class="o">=</span> <span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">;</span>
</code></pre></div>    </div>

    <div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Elixir</span>
<span class="n">sum</span> <span class="o">=</span> <span class="k">fn</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="k">end</span>
<span class="n">sum</span> <span class="o">=</span> <span class="o">&amp;</span><span class="p">(</span><span class="nv">&amp;1</span> <span class="o">+</span> <span class="nv">&amp;2</span><span class="p">)</span>
</code></pre></div>    </div>

    <p>The outer <code class="language-plaintext highlighter-rouge">&amp;</code> behaves like the <code class="language-plaintext highlighter-rouge">fn</code> keyword. The two inner <code class="language-plaintext highlighter-rouge">&amp;</code>’s bring us to #3…</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">&amp;</code> denotes arguments to shorthand lambdas. <code class="language-plaintext highlighter-rouge">&amp;1</code> represents the first argument, <code class="language-plaintext highlighter-rouge">&amp;2</code> the second, and so on. Here are some direct translations of <code class="language-plaintext highlighter-rouge">sum = &amp;(&amp;1 + &amp;2)</code> into JavaScript:</p>

    <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ES5</span>
<span class="kd">var</span> <span class="nx">sum</span> <span class="o">=</span> <span class="nf">function </span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
<span class="p">};</span>

<span class="c1">// ES6</span>
<span class="kd">const</span> <span class="nx">sum</span> <span class="o">=</span> <span class="p">(...</span><span class="nx">args</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
</code></pre></div>    </div>
  </li>
</ol>

<p>At this point you might be wondering how the compiler (or anyone else reading your code, for that matter) will manage to keep all of these <code class="language-plaintext highlighter-rouge">&amp;</code>’s straight if you try nesting them. Easy answer: you’ll get a <code class="language-plaintext highlighter-rouge">CompileError</code> saying “nested captures via &amp; are not allowed”.</p>

<h3 id="pipe-operator">Pipe operator</h3>

<p>Underscore and Lodash have a <code class="language-plaintext highlighter-rouge">_.chain</code> <a href="http://underscorejs.org/#chaining">function</a> that lets you express data transformations in chronological order of application. It looks really nice but ends up being clunky to use in practice. The same functionality is built into Elixir as the pipe operator <code class="language-plaintext highlighter-rouge">|&gt;</code>. A JavaScript example adapted from the Underscore docs:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">lyrics</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span> <span class="na">line</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="na">words</span><span class="p">:</span> <span class="dl">"</span><span class="s2">I'm a lumberjack and I'm okay</span><span class="dl">"</span> <span class="p">},</span>
  <span class="p">{</span> <span class="na">line</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="na">words</span><span class="p">:</span> <span class="dl">"</span><span class="s2">I sleep all night and I work all day</span><span class="dl">"</span> <span class="p">},</span>
  <span class="p">{</span> <span class="na">line</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="na">words</span><span class="p">:</span> <span class="dl">"</span><span class="s2">He's a lumberjack and he's okay</span><span class="dl">"</span> <span class="p">},</span>
  <span class="p">{</span> <span class="na">line</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="na">words</span><span class="p">:</span> <span class="dl">"</span><span class="s2">He sleeps all night and he works all day</span><span class="dl">"</span> <span class="p">},</span>
<span class="p">];</span>

<span class="kd">const</span> <span class="nx">histogram</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nf">chain</span><span class="p">(</span><span class="nx">lyrics</span><span class="p">)</span>
  <span class="p">.</span><span class="nf">pluck</span><span class="p">(</span><span class="dl">"</span><span class="s2">words</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nf">map</span><span class="p">(</span><span class="nx">words</span> <span class="o">=&gt;</span> <span class="nx">words</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="dl">"</span><span class="s2"> </span><span class="dl">"</span><span class="p">))</span>
  <span class="p">.</span><span class="nf">flatten</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
  <span class="p">.</span><span class="nf">reduce</span><span class="p">((</span><span class="nx">acc</span><span class="p">,</span> <span class="nx">word</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">acc</span><span class="p">[</span><span class="nx">word</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nx">acc</span><span class="p">[</span><span class="nx">word</span><span class="p">]</span> <span class="o">||</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">acc</span><span class="p">;</span>
  <span class="p">},</span> <span class="p">{})</span>
  <span class="p">.</span><span class="nf">value</span><span class="p">();</span>

<span class="c1">// histogram is { lumberjack: 2, all: 4, night: 2 ... }</span>
</code></pre></div></div>

<p>Translated into Elixir:</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">histogram</span> <span class="o">=</span>
  <span class="n">lyrics</span>
  <span class="o">|&gt;</span> <span class="no">Stream</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="o">&amp;</span><span class="p">(</span><span class="nv">&amp;1</span><span class="o">.</span><span class="n">words</span><span class="p">))</span>
  <span class="o">|&gt;</span> <span class="no">Stream</span><span class="o">.</span><span class="n">flat_map</span><span class="p">(</span><span class="o">&amp;</span><span class="no">String</span><span class="o">.</span><span class="n">split</span><span class="o">/</span><span class="mi">1</span><span class="p">)</span>
  <span class="o">|&gt;</span> <span class="no">Enum</span><span class="o">.</span><span class="n">reduce</span><span class="p">(%{},</span> <span class="k">fn</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">acc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="no">Map</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="n">word</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="p">(</span><span class="nv">&amp;1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="k">end</span><span class="p">)</span>

<span class="c1"># histogram is %{"lumberjack" =&gt; 2, "all" =&gt; 4, "night" =&gt; 2 ... }</span>
</code></pre></div></div>

<p>Just like in Underscore and Lodash, Elixir functions specify the data that they work on as their first argument by convention. Chained function calls can then omit that first argument because it gets populated with the result of the previous step in the pipeline.</p>

<p>Blessed with native support via <code class="language-plaintext highlighter-rouge">|&gt;</code>, chaining works with all functions that take at least one argument. But there’s another reason it’s ubiquitous in Elixir: the language’s lack of objects. Since instance methods like JavaScript’s <code class="language-plaintext highlighter-rouge">String.prototype.toUpperCase</code> don’t exist, all such features are implemented as “static” methods in Elixir:</p>

<div class="language-elixir highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Prints "HELLO" and returns :ok</span>
<span class="no">IO</span><span class="o">.</span><span class="n">puts</span><span class="p">(</span><span class="no">String</span><span class="o">.</span><span class="n">upcase</span><span class="p">(</span><span class="no">String</span><span class="o">.</span><span class="n">trim</span><span class="p">(</span><span class="s2">" hello"</span><span class="p">)))</span>

<span class="c1"># Same, but laid out more naturally</span>
<span class="s2">" hello"</span> <span class="o">|&gt;</span> <span class="no">String</span><span class="o">.</span><span class="n">trim</span> <span class="o">|&gt;</span> <span class="no">String</span><span class="o">.</span><span class="n">upcase</span> <span class="o">|&gt;</span> <span class="no">IO</span><span class="o">.</span><span class="n">puts</span>
</code></pre></div></div>

<h2 id="final-thoughts">Final thoughts</h2>

<p>Although it’s hard to say whether Elixir lives up to its massive hype, I’ve generally liked what I’ve seen so far. The flavor of functional programming is more pragmatic than dogmatic, the concurrency model is as elegant as promised, and the included development tools are easily the best of any language I’ve used.</p>

<p>I’m still a bit skeptical about dynamic typing, but maybe “let it crash” just hasn’t sunk in yet. I’m also really not a huge fan of all the Rails-esque boilerplate that Phoenix generates. The current lack of mature framework options has more to do with how young the language is, though, and it’s not too hard to pare down Phoenix anyway.</p>

<p>Consider it a glowing endorsement of both Elixir and Phoenix that these minor details are my only complaints :)</p>
]]></description>
      </item>
      
    
      
      <item>
        <title>How to Make Webpack Caching Actually Work</title>
        <link>https://chaidarun.com/webpack-caching</link>
        <pubDate>Fri, 07 Oct 2016 00:00:00 GMT</pubDate>
        <guid isPermaLink="true">https://chaidarun.com/webpack-caching</guid>
        
        <description><![CDATA[<p>Although <a href="https://webpack.github.io/">Webpack</a> is a popular tool that’s generally pretty decent at gluing together the mess of “modern” web development, fixing its browser caching mechanism has become a rite of passage fraught with uncertainty and frustration. This post combines insights from the infamous 100+ comment <a href="https://github.com/webpack/webpack/issues/1315">GitHub issue</a> with my own experience of taming Webpack at <a href="https://www.duolingo.com/">Duolingo</a>.</p>

<h2 id="the-goal">The goal</h2>

<p>JavaScript files generated by Webpack (a.k.a. “bundles”) can be configured to include a hash of their contents in their filenames, e.g. <code class="language-plaintext highlighter-rouge">app-89fcb80e.js</code>. This forces the browser to download an updated bundle instead of going to cache whenever we modify our source code.</p>

<p>Isn’t it wasteful, though, to make the browser download all of our JS again even if we only make a small code change? That’s why two bundles are typically used: a <em>vendor bundle</em> that contains all library code (which rarely changes) and an <em>app bundle</em> that contains code we write ourselves.</p>

<p>Webpack’s official <a href="https://webpack.github.io/docs/list-of-plugins.html#commonschunkplugin">CommonsChunkPlugin</a> makes it easy to select what should go into the vendor bundle. Generating the necessary content hashes should be just as simple, right? Webpack’s <a href="https://webpack.github.io/docs/long-term-caching.html">long-term caching guide</a> seems straightforward enough.</p>

<h2 id="its-a-trap">It’s a trap</h2>

<p>In order to preserve module scope when combining modules (i.e. source files) into a handful of output bundles, Webpack wraps each module’s source code inside a function. Wrapped modules reference each other by integer IDs that Webpack automatically generates. For example, Webpack might assign an ID of 23 to React and then convert all of our codebase’s <code class="language-plaintext highlighter-rouge">require('react')</code> statements into <code class="language-plaintext highlighter-rouge">__webpack_require__(23)</code>. Unfortunately these IDs vary from compilation to compilation, resulting in nondeterministic bundles—and in turn, causing unnecessary hash churn in our bundles’ filenames.</p>

<p>The Webpack docs recommend <a href="https://webpack.github.io/docs/list-of-plugins.html#occurrenceorderplugin">OccurrenceOrderPlugin</a>, an official plugin that promises deterministic module IDs by sorting modules in descending order of usage frequency before assigning sequential IDs. A nice side effect of this is that commonly imported modules like Underscore get short IDs, reducing output bundle size.</p>

<p>To test this out, we try compiling our JS a few times in a row. The output bundle hashes are the same every time. Next we try modifying an app module. Only the app bundle’s hash changes; the vendor bundle’s hash remains unchanged. We seem to have fixed caching now, but not so fast!</p>

<p>The problem is that adding a new vendor import inside our app source will often change the vendor modules’ relative frequencies of appearance, leading to shuffled module IDs inside the vendor bundle and more accidental cache invalidation.</p>

<h2 id="the-solution">The solution</h2>

<p><a href="https://webpack.github.io/docs/changelog.html#1-10">NamedModulesPlugin</a> is another official (but undocumented) plugin that <em>actually</em> produces deterministic module IDs by telling Webpack to use modules’ filepaths as IDs instead of integers. The example above then becomes:</p>

<!-- prettier-ignore -->
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">__webpack_require__</span><span class="p">(</span><span class="dl">"</span><span class="s2">./node_modules/react/index.js</span><span class="dl">"</span><span class="p">)</span>
</code></pre></div></div>

<p>Do we finally have reliable bundle hashing now? Nope, one last thing. Webpack throws a small bit of its own code (e.g. the definition for that <code class="language-plaintext highlighter-rouge">__webpack_require__</code> function) into the mix. By default, this runtime code is included in the vendor bundle. That’s fine, except for one problem: the Webpack runtime includes a manifest containing the filenames of all generated bundles. Changing the app source will affect the app bundle hash, the Webpack manifest, the Webpack runtime, and finally (you guessed it) the vendor bundle hash.</p>

<p>The solution is to extract the Webpack runtime into its own bundle that we either send as a third JS file or <a href="https://github.com/ampedandwired/html-webpack-plugin">inline</a> directly into HTML. We can extract out a manifest bundle by adding “manifest” to CommonsChunkPlugin:</p>

<!-- prettier-ignore -->
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">new</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">optimize</span><span class="p">.</span><span class="nc">CommonsChunkPlugin</span><span class="p">({</span> <span class="na">names</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">vendor</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">manifest</span><span class="dl">"</span><span class="p">]</span> <span class="p">})</span>
</code></pre></div></div>

<p>At long last, we’re done.</p>

<h2 id="takeaway">Takeaway</h2>

<p>Use NamedModulesPlugin instead of OccurrenceOrderPlugin, and add “manifest” as a CommonsChunkPlugin name.</p>
]]></description>
      </item>
      
    
  </channel>
</rss>
